

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>LEGO Wireless Protocol 3.0.00 Doc v3.0.00 r17 documentation</title>
  

  
  
  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="/lego-ble-wireless-protocol-docs/_static/css/theme.css" type="text/css" />
  

  
    <link rel="stylesheet" href="/lego-ble-wireless-protocol-docs/_static/theme_overrides.css" type="text/css" />
  

  
        <link rel="index" title="Index"
              href="genindex.html"/>
        <link rel="search" title="Search" href="search.html"/>
    <link rel="top" title="None" href="index.html#document-index"/> 

  
  <script src="_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="index.html#document-index" class="icon icon-home"> LEGO Wireless Protocol 3.0.00
          

          
          </a>

          
            
            
              <div class="version">
                Doc v3.0.00 r17
              </div>
            
          

          

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
            
              <!-- Local TOC -->
              <div class="local-toc"><p class="caption"><span class="caption-text">Contents:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="index.html#document-1-Introduction">1. Introduction</a><ul>
<li class="toctree-l2"><a class="reference internal" href="index.html#versions">1.1. Versions</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#glossary">1.2. Glossary</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="index.html#document-2-Advertising">2. Advertising</a><ul>
<li class="toctree-l2"><a class="reference internal" href="index.html#system-type-and-device-number">2.1. System Type and Device Number</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#device-capabilities-hub-kind">2.2. Device Capabilities (Hub Kind)</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#last-network-id">2.3. Last Network ID</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#status">2.4. Status</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#future-option-byte-s">2.5. Future Option Byte(s)</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="index.html#document-3-GATT">3. LEGO Specific GATT Service</a><ul>
<li class="toctree-l2"><a class="reference internal" href="index.html#common-message-header">3.1. Common Message Header</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#message-length-encoding">3.2. Message Length Encoding</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#message-types">3.3. Message Types</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#transmission-flow-control-preliminary-proposal">3.4. Transmission Flow Control (Preliminary PROPOSAL!)</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#hub-properties">3.5. Hub Properties</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#hub-actions">3.6. Hub Actions</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#hub-alerts">3.7. Hub Alerts</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#hub-attached-i-o">3.8. Hub Attached I/O</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#generic-error-messages">3.9. Generic Error Messages</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#h-w-network-commands">3.10. H/W NetWork Commands</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#f-w-update-go-into-boot-mode">3.11. F/W Update - Go Into Boot Mode</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#f-w-update-lock-memory">3.12. F/W Update Lock memory</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#f-w-update-lock-status-request">3.13. F/W Update Lock Status Request</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#f-w-lock-status">3.14. F/W Lock Status</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#port-information-request">3.15. Port Information Request</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#port-mode-information-request">3.16. Port Mode Information Request</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#port-input-format-setup-single">3.17. Port Input Format Setup (Single)</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#port-input-format-setup-combinedmode">3.18. Port Input Format Setup (CombinedMode)</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#port-information">3.19. Port Information</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#port-mode-information">3.20. Port Mode Information</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#port-value-single">3.21. Port Value (Single)</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#port-value-combinedmode">3.22. Port Value (CombinedMode)</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#port-input-format-single">3.23. Port Input Format (Single)</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#port-input-format-combinedmode">3.24. Port Input Format (CombinedMode)</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#virtual-port-setup">3.25. Virtual Port Setup</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#port-output-command">3.26. Port Output Command</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#output-command-0x81-motor-sub-commands-0x01-0x3f">3.27. Output Command 0x81 - Motor Sub Commands [0x01-0x3F]</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#writedirect">3.28. WriteDirect</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#writedirectmodedata">3.29. WriteDirectModeData</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#checksum-calculation">3.30. Checksum Calculation</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#tacho-math">3.31. Tacho Math</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#port-output-command-feedback">3.32. Port Output Command Feedback</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="index.html#document-4-Buffering">4. Buffering State Machine</a><ul>
<li class="toctree-l2"><a class="reference internal" href="index.html#state-machine-specification">4.1. State machine specification</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#sdk-side-state-machine">4.2. SDK-side state machine</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="index.html#document-5-Boot_loader">5. LEGO Bluetooth Hub Boot Loader Service</a><ul>
<li class="toctree-l2"><a class="reference internal" href="index.html#lego-hub-boot-loader-service">5.1. LEGO Hub Boot Loader Service</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#flash-loader-functions-0x01">5.2. Flash Loader Functions [0x01]</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#flash-loader-error-messages-0x05">5.3. Flash Loader Error Messages [0x05]</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="index.html#document-6-Appendix">6. Appendix</a><ul>
<li class="toctree-l2"><a class="reference internal" href="index.html#encoding-of-writedirectmodedata-0x81-0x51">6.1. Encoding of WriteDirectModeData [0x81, 0x51]</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#encoding-of-writedirect-0x81-0x50">6.2. Encoding of WriteDirect [0x81, 0x50]</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#sequence-diagrams">6.3. Sequence Diagrams</a></li>
</ul>
</li>
</ul>
</div>
            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html#document-index">LEGO Wireless Protocol 3.0.00</a>
        
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html#document-index">Docs</a> &raquo;</li>
        
      <li>LEGO Wireless Protocol 3.0.00 Doc v3.0.00 r17 documentation</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="welcome-to-lego-wireless-protocol-3-0-00-documentation">
<h1>Welcome to LEGO Wireless Protocol 3.0.00 documentation!<a class="headerlink" href="#welcome-to-lego-wireless-protocol-3-0-00-documentation" title="Permalink to this headline">¶</a></h1>
<div class="toctree-wrapper compound">
<span id="document-1-Introduction"></span><div class="section" id="introduction">
<h2>1. Introduction<a class="headerlink" href="#introduction" title="Permalink to this headline">¶</a></h2>
<p>The LEGO Bluetooth 3.X Hub Profile consists of a single Bluetooth LE GATT
service. The service allows users to read info about the LEGO Hub (name,
battery level, etc.) and to interact with any sensors and motors connected
to it.</p>
<p>For more details on Bluetooth LE GATT, visit &lt;<a class="reference external" href="https://www.bluetooth.org">https://www.bluetooth.org</a>&gt;.</p>
<div class="section" id="versions">
<h3>1.1. Versions<a class="headerlink" href="#versions" title="Permalink to this headline">¶</a></h3>
<p>Bluetooth Hub Profile (this document): XX</p>
<p>Implemented in LEGO Hub Firmware: XX</p>
<p>Implemented in LEGO Hub SDK: XX</p>
</div>
<div class="section" id="glossary">
<h3>1.2. Glossary<a class="headerlink" href="#glossary" title="Permalink to this headline">¶</a></h3>
<table border="1" class="docutils">
<colgroup>
<col width="22%" />
<col width="78%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Term</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>Brake</td>
<td>When the motor is shorted through the motordriver.</td>
</tr>
<tr class="row-odd"><td>Central</td>
<td>A LEGO BLE H/W only Network will always have 1 Central
and a number of Peripherals. If a Smart Device (e.g. an
iPad) is used, this will always have the Central role.</td>
</tr>
<tr class="row-even"><td>Client</td>
<td>NOT USED! No real client/server connection.</td>
</tr>
<tr class="row-odd"><td>Coast</td>
<td>Another word for a free running motor (float)</td>
</tr>
<tr class="row-even"><td>Combined Mode</td>
<td>Indicates whether the Modes of a given Port can be used
as a group to get mutliple values at once</td>
</tr>
<tr class="row-odd"><td>CombinedSensor</td>
<td>A sensor able to have more Mode/Dataset combinations.
e.g. the LPF2 Vision Sensor</td>
</tr>
<tr class="row-even"><td>Dataset</td>
<td>Dataset represents a portion of sensor output in a given
mode. e.g. RGB sensor has 3 Datasets - one each for RGB</td>
</tr>
<tr class="row-odd"><td>Device</td>
<td>NOT USED! Ambiguous meaning</td>
</tr>
<tr class="row-even"><td>Drift</td>
<td>Another word for a free running motor (float)</td>
</tr>
<tr class="row-odd"><td>Drive</td>
<td>Another word for 2 syncronized/regulated motors</td>
</tr>
<tr class="row-even"><td>Drive Base</td>
<td>An intelligent Brick with 2 built in synchronized motors</td>
</tr>
<tr class="row-odd"><td>Float</td>
<td>Another word for an inactive port. I.e. NO power power
supplied to a motor (high impedance).</td>
</tr>
<tr class="row-even"><td>Hold</td>
<td>When the motor is stopped (no rotation/movement), but the
driver continues to keep the current position by actively</td>
</tr>
<tr class="row-odd"><td>Hub</td>
<td>A LEGO Bluetooth LE compatible Hub</td>
</tr>
<tr class="row-even"><td>LPF2 Device</td>
<td>Physical or Virtual sensor/actuator connected to a Hub</td>
</tr>
<tr class="row-odd"><td>Master</td>
<td>NOT USED! Can be mixed up with the Central/ Peripheral
role, so NOT used. Misused even in some H/W datasheets</td>
</tr>
<tr class="row-even"><td>Max-Power</td>
<td>Max-Power describes the upper power limit for speed
commands. Max-Power sets the maximum power that the
regulation is allowed to use while trying to maintain a
certain speed.</td>
</tr>
<tr class="row-odd"><td>Mode</td>
<td>A Mode is a Port feature, allowing the Port to operate in
different ways.</td>
</tr>
<tr class="row-even"><td>Peripheral</td>
<td>LEGO hub connected to a Central Role hub or Smart Device</td>
</tr>
<tr class="row-odd"><td>Power</td>
<td>Is the word used when applying power to an output port
(e.g. a motor). Power is different from Speed, in that it
is unregulated, and thereby only sets the PWM Duty Cycle
for the output. All LPF2 motors and hubs support power
commands.</td>
</tr>
<tr class="row-even"><td>Server</td>
<td>NOT USED! No real client/server connection.</td>
</tr>
<tr class="row-odd"><td>Slave</td>
<td>NOT USED! Can be mixed up with the Central/ Peripheral
role, so NOT used.Misused even in some H/W datasheets.</td>
</tr>
<tr class="row-even"><td>Speed</td>
<td>Is the word used when applying speed to an output
(normally a tacho-motor). Speed is regulated, which means
that the hub will control the power to the motor and
hence it can maintain a given speed.</td>
</tr>
<tr class="row-odd"><td>Steering</td>
<td>Another word for regulated/synchronized motors.</td>
</tr>
<tr class="row-even"><td>Synchronization</td>
<td>The act of joining two Ports into a Virtual Port.
e.g. The 2 internal motors of a drivebase.</td>
</tr>
<tr class="row-odd"><td>Virtual Port</td>
<td>Port resulting from synchronizing two Ports</td>
</tr>
<tr class="row-even"><td>Virtual Sensor</td>
<td>A sensor delivering the (logical) average of two sensor.
e.g A virtual sensor representing the average tacho
counts from 2 synchronized motors (acting as a
drivebase).</td>
</tr>
</tbody>
</table>
</div>
</div>
<span id="document-2-Advertising"></span><div class="section" id="advertising">
<h2>2. Advertising<a class="headerlink" href="#advertising" title="Permalink to this headline">¶</a></h2>
<p>When in Advertising mode, a LEGO BLE compatible device fills in the message
with its friendly name (as described in Properties) along with up to n
sequential bytes of Manufacturer Data.</p>
<p>The Manufacturer Data is filled in according to the table below:</p>
<blockquote>
<div><table border="1" class="docutils">
<colgroup>
<col width="27%" />
<col width="37%" />
<col width="9%" />
<col width="10%" />
<col width="9%" />
<col width="9%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head" colspan="6">Manufacturer Data</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><strong>Name</strong></td>
<td><strong>Description</strong></td>
<td><strong>Offset</strong></td>
<td><strong>Format</strong></td>
<td><strong>Min</strong></td>
<td><strong>Max</strong></td>
</tr>
<tr class="row-odd"><td>Length</td>
<td>Length of data</td>
<td>0</td>
<td>UINT8</td>
<td>0x09</td>
<td>0x09</td>
</tr>
<tr class="row-even"><td>Data Type Name</td>
<td>Manufacturer specific data to follow</td>
<td>1</td>
<td>UINT8</td>
<td>0xFF</td>
<td>0xFF</td>
</tr>
<tr class="row-odd"><td>Manufacturer ID</td>
<td>Manufacturer identifier</td>
<td>2</td>
<td>UINT16</td>
<td>0x0397</td>
<td>0x0397</td>
</tr>
<tr class="row-even"><td>Button State</td>
<td>Reflects the state of the device button</td>
<td>4</td>
<td>UINT8</td>
<td>0</td>
<td>1</td>
</tr>
<tr class="row-odd"><td>System Type and Device Number</td>
<td>Identifies the system type of the Hub</td>
<td>5</td>
<td>UINT8</td>
<td>0x00</td>
<td>0xFF</td>
</tr>
<tr class="row-even"><td>Device Capabilities</td>
<td>Describes the capabilities of the device</td>
<td>6</td>
<td>UINT8</td>
<td>0x01</td>
<td>0xFF</td>
</tr>
<tr class="row-odd"><td>Last network</td>
<td>Network ID of the last network</td>
<td>7</td>
<td>UINT8</td>
<td>0</td>
<td>255</td>
</tr>
<tr class="row-even"><td>Status</td>
<td>Actual status</td>
<td>8</td>
<td>UINT8</td>
<td>0</td>
<td>255</td>
</tr>
<tr class="row-odd"><td>Option</td>
<td>Future use</td>
<td>9</td>
<td>UINT8</td>
<td>0</td>
<td>255</td>
</tr>
</tbody>
</table>
</div></blockquote>
<div class="section" id="system-type-and-device-number">
<span id="sys-typ"></span><h3>2.1. System Type and Device Number<a class="headerlink" href="#system-type-and-device-number" title="Permalink to this headline">¶</a></h3>
<p>Encoded as 2 bit-fields in one byte <code class="docutils literal"><span class="pre">SSS</span> <span class="pre">DDDDD</span></code></p>
<p>The System Type contained in the leftmost bits is interpreted as:</p>
<blockquote>
<div><table border="1" class="docutils">
<colgroup>
<col width="27%" />
<col width="73%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head"><code class="docutils literal"><span class="pre">SSS</span></code></th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>000</td>
<td>LEGO Wedo 2.0</td>
</tr>
<tr class="row-odd"><td>001</td>
<td>LEGO Duplo</td>
</tr>
<tr class="row-even"><td>010</td>
<td>LEGO System</td>
</tr>
<tr class="row-odd"><td>011</td>
<td>LEGO System</td>
</tr>
</tbody>
</table>
</div></blockquote>
<p>The Device Number in the rightmost bits represents the unique identifier
for a product within a System Type. The currently available LEGO BLE
compatible devices are:</p>
<blockquote>
<div><table border="1" class="docutils">
<colgroup>
<col width="22%" />
<col width="31%" />
<col width="47%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head"><code class="docutils literal"><span class="pre">SSS</span></code></th>
<th class="head"><code class="docutils literal"><span class="pre">DDDDD</span></code></th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>000</td>
<td>00000</td>
<td>WeDo Hub</td>
</tr>
<tr class="row-odd"><td>001</td>
<td>00000</td>
<td>Duplo Train</td>
</tr>
<tr class="row-even"><td>010</td>
<td>00000</td>
<td>Boost Hub</td>
</tr>
<tr class="row-odd"><td>010</td>
<td>00001</td>
<td>2 Port Hub</td>
</tr>
<tr class="row-even"><td>010</td>
<td>00010</td>
<td>2 Port Handset</td>
</tr>
</tbody>
</table>
</div></blockquote>
</div>
<div class="section" id="device-capabilities-hub-kind">
<span id="hub-knd"></span><h3>2.2. Device Capabilities (Hub Kind)<a class="headerlink" href="#device-capabilities-hub-kind" title="Permalink to this headline">¶</a></h3>
<p>Encoded as a bit-field <code class="docutils literal"><span class="pre">CCCC</span> <span class="pre">CCCC</span></code></p>
<p>A LEGO BLE compatible device has capabilities, but not all devices have the
same capabilities.</p>
<blockquote>
<div><table border="1" class="docutils">
<colgroup>
<col width="32%" />
<col width="68%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head"><code class="docutils literal"><span class="pre">CCCC</span> <span class="pre">CCCC</span></code></th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>0000 0001</td>
<td>Supports Central Role</td>
</tr>
<tr class="row-odd"><td>0000 0010</td>
<td>Supports Peripheral Role</td>
</tr>
<tr class="row-even"><td>0000 0100</td>
<td>Supports LPF2 devices (H/W connectors)</td>
</tr>
<tr class="row-odd"><td>0000 1000</td>
<td>Act as a Remote Controller (R/C)</td>
</tr>
<tr class="row-even"><td>0001 0000</td>
<td>TBD</td>
</tr>
<tr class="row-odd"><td>0010 0000</td>
<td>TBD</td>
</tr>
<tr class="row-even"><td>0100 0000</td>
<td>TBD</td>
</tr>
<tr class="row-odd"><td>1000 0000</td>
<td>TBD</td>
</tr>
</tbody>
</table>
</div></blockquote>
</div>
<div class="section" id="last-network-id">
<span id="lst-net"></span><h3>2.3. Last Network ID<a class="headerlink" href="#last-network-id" title="Permalink to this headline">¶</a></h3>
<p>The Last Network ID is used in the LEGO BLE device pairing process.</p>
<blockquote>
<div><table border="1" class="docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>000:</td>
<td>NONE (unknown)</td>
</tr>
<tr class="row-even"><td>001..250:</td>
<td>The ID’s used for “Last Connection” Network ID’s. Used in H/W network “auto connect”</td>
</tr>
<tr class="row-odd"><td>251:</td>
<td>DEFAULT 1, Locked</td>
</tr>
<tr class="row-even"><td>252:</td>
<td>DEFAULT 2, NOT Locked</td>
</tr>
<tr class="row-odd"><td>253:</td>
<td>DEFAULT 3, RSSI Dependent</td>
</tr>
<tr class="row-even"><td>254:</td>
<td>DEFAULT 4, DISABLE H/W Network</td>
</tr>
<tr class="row-odd"><td>255:</td>
<td>DON’T CARE - NOT Implemented</td>
</tr>
</tbody>
</table>
</div></blockquote>
</div>
<div class="section" id="status">
<h3>2.4. Status<a class="headerlink" href="#status" title="Permalink to this headline">¶</a></h3>
<p>Encoded as a bit-field <code class="docutils literal"><span class="pre">SSSS</span> <span class="pre">SSSS</span></code></p>
<table border="1" class="docutils">
<colgroup>
<col width="32%" />
<col width="68%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head"><code class="docutils literal"><span class="pre">SSSS</span> <span class="pre">SSSS</span></code></th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>0000 0001</td>
<td>“I can be Peripheral”</td>
</tr>
<tr class="row-odd"><td>0000 0010</td>
<td>“I can be Central”</td>
</tr>
<tr class="row-even"><td>0000 0100</td>
<td>TBD</td>
</tr>
<tr class="row-odd"><td>0000 1000</td>
<td>TBD</td>
</tr>
<tr class="row-even"><td>0001 0000</td>
<td>TBD</td>
</tr>
<tr class="row-odd"><td>0010 0000</td>
<td>“Request Window” A stretching of the
Button Pressed (Adding 1 sec. after
release) [part of connection process].
See <a class="reference internal" href="#req-window"><span class="std std-ref">Request Window</span></a></td>
</tr>
<tr class="row-even"><td>0100 0000</td>
<td>“Request Connect”. Hardcoded request
(i.e. CONSTANT flag)</td>
</tr>
<tr class="row-odd"><td>1000 0000</td>
<td>TBD</td>
</tr>
</tbody>
</table>
<div class="section" id="request-window">
<span id="req-window"></span><h4>2.4.1. Request Window<a class="headerlink" href="#request-window" title="Permalink to this headline">¶</a></h4>
<p>The “Connect from poweron” will be delayed, as long as the user hold down the connection button. On the central, the button
pressed from powerup is also used for detecting “Go into bootloader mode” or “The clear last connection table”. This is why
the connection request on the central is measured/sampled from the button release. The pulse-stretching bit will be held set
for 1000 mS. after the release of the Connection Button.
For more information about userinterface see the LPF2 Platforms document.</p>
</div>
</div>
<div class="section" id="future-option-byte-s">
<h3>2.5. Future Option Byte(s)<a class="headerlink" href="#future-option-byte-s" title="Permalink to this headline">¶</a></h3>
<blockquote>
<div><table border="1" class="docutils">
<colgroup>
<col width="17%" />
<col width="83%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>000..255:</td>
<td>TBD</td>
</tr>
</tbody>
</table>
</div></blockquote>
</div>
</div>
<span id="document-3-GATT"></span><div class="section" id="lego-specific-gatt-service">
<h2>3. LEGO Specific GATT Service<a class="headerlink" href="#lego-specific-gatt-service" title="Permalink to this headline">¶</a></h2>
<p>The LEGO Bluetooth 3.X Hub Profile contains the following service:</p>
<table border="1" class="docutils">
<colgroup>
<col width="47%" />
<col width="53%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Service</th>
<th class="head">UUID</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>LEGO Hub Service</td>
<td>0000<strong>1623</strong> -1212-EFDE-1623-785FEABCD123</td>
</tr>
</tbody>
</table>
<p>Due to potential limitations in future BLE chipsets, the LEGO Service only contains one single characteristic:</p>
<table border="1" class="docutils">
<colgroup>
<col width="47%" />
<col width="53%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Characteristic</th>
<th class="head">UUID</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>LEGO Hub Characteristic</td>
<td>0000<strong>1624</strong> -1212-EFDE-1623-785FEABCD123</td>
</tr>
</tbody>
</table>
<table border="1" class="docutils">
<colgroup>
<col width="47%" />
<col width="53%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head" colspan="2">The &lt;1624&gt; LEGO Hub Characteristic Supported Properties</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><strong>Property</strong></td>
<td><strong>Description</strong></td>
</tr>
<tr class="row-odd"><td>Write without response <sup>[1]</sup></td>
<td>Allows users to use the Write Command ATT
operation on this characteristic.</td>
</tr>
<tr class="row-even"><td>Notify</td>
<td>Allows the user to use the Handle Value
Notification ATT operation on this
characteristic.</td>
</tr>
</tbody>
</table>
<p><sup>[1]</sup>See <a class="reference internal" href="#tx-flow-ctrl"><span class="std std-ref">Transmission Flow Control (Preliminary PROPOSAL!)</span></a> - UNTIL IMPLEMENTED, the write <strong>will be</strong> Write With Response (Apple IOS stuff).</p>
<p>Note, that throughout the remainder of this documentation, these UUIDs will be referenced by their short form (the part marked in bold).</p>
<p>Thus, since all attributes and properties are accessed through a single characteristic, the notion of updates is introduced to clearly distinguish these from standard characteristic notifications.
Furthermore, with only a single characteristic available, communicating with the Hub as of Hub Profile 3.X and onwards is not done the usual way, when it comes to the use of services and characteristics. Normally, each attribute/property has its own characteristic, but with the limitation of only a single characteristic, these attributes/properties are now identified through a Message Type field included in a Common Header described below:</p>
<div class="section" id="common-message-header">
<span id="common-header-description"></span><h3>3.1. Common Message Header<a class="headerlink" href="#common-message-header" title="Permalink to this headline">¶</a></h3>
<table border="1" class="docutils">
<colgroup>
<col width="22%" />
<col width="78%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head" colspan="2">LEGO Hub Characteristic (UUID: 1624) - Common Header</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><p class="first"><strong>Communication:</strong></p>
<p><strong>Size:</strong></p>
<p><strong>Description:</strong></p>
<p><strong>Length:</strong></p>
<p class="last"><strong>Hub ID:</strong></p>
</td>
<td><p class="first">Downstream + Upstream</p>
<p>3 Bytes</p>
<p>Common Header for all messages in the LEGO Hub Characteristic.</p>
<p>Introduced to be independent of the MTU in the transport layer.</p>
<p>Handle to a Hub node in a H/W network - stand-alone networks without a Smart Device.</p>
<p class="last">Header format - see below.</p>
</td>
</tr>
</tbody>
</table>
<table border="1" class="docutils">
<colgroup>
<col width="23%" />
<col width="42%" />
<col width="21%" />
<col width="7%" />
<col width="7%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head" colspan="5">Header Format:</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><strong>Name:</strong></td>
<td><strong>Description:</strong></td>
<td><strong>Format:</strong></td>
<td><strong>Min:</strong></td>
<td><strong>Max:</strong></td>
</tr>
<tr class="row-odd"><td>Length</td>
<td>Length of entire message in bytes
(escaped and 2 bytes for long messages)
For further information about encoding -
see <a class="reference internal" href="#len-encoding"><span class="std std-ref">Message Length Encoding</span></a></td>
<td>Uint8 (Uint7)
/Uint16</td>
<td>N/A</td>
<td>N/A</td>
</tr>
<tr class="row-even"><td><p class="first">Hub ID</p>
<p>NOT USE at the moment!</p>
<p class="last">Always set to 0x00 (zero)</p>
</td>
<td>Hub identifier is needed when a Hub is
connected as a bridge to a network formerly
build without a SMART DEVICE.
E.g. HUB A is connected to HUB B and HUB
C is added. After a while the SMART
DEVICE is connected to the network. HUB A
is now acting as a Central for B and C while
acting as a Peripheral to the SMART DEVICE.
Data from B and C will be routed through HUB A.</td>
<td>Uint8</td>
<td>0</td>
<td>255</td>
</tr>
<tr class="row-odd"><td>Message Type</td>
<td>Identifies the kind of message transmitted.
For message types - see <a class="reference internal" href="#message-typ"><span class="std std-ref">Message Types</span></a></td>
<td>Uint8</td>
<td>0</td>
<td>0xXX</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="message-length-encoding">
<span id="len-encoding"></span><h3>3.2. Message Length Encoding<a class="headerlink" href="#message-length-encoding" title="Permalink to this headline">¶</a></h3>
<p>Messages having a length of 1 to 127 bytes is represented in 1 byte. For messages above 127, the 1 byte encoding is
escaped and 2 bytes is used - i.e. if bit 7 in the very first byte is set, the following byte (2’nd) should also be
used for en-/decoding the length. Hence the LSB (1st byte) can only be used as 7 bit. Lengths greater than 127 are
therefore represented as:</p>
<table border="1" class="docutils">
<colgroup>
<col width="50%" />
<col width="50%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head" colspan="2">Message Length Encoding</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><strong>LSB:</strong></td>
<td><strong>MSB:</strong></td>
</tr>
<tr class="row-odd"><td>1000 0000</td>
<td>0000 0001 = 128</td>
</tr>
<tr class="row-even"><td>1000 0001</td>
<td>0000 0001 = 129</td>
</tr>
<tr class="row-odd"><td>1000 0010</td>
<td>0000 0001 = 130</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="message-types">
<span id="message-typ"></span><h3>3.3. Message Types<a class="headerlink" href="#message-types" title="Permalink to this headline">¶</a></h3>
<p>The table below summarizes the various Message Types introduced. These will be described in detail in the following sections.</p>
<table border="1" class="docutils">
<colgroup>
<col width="30%" />
<col width="6%" />
<col width="7%" />
<col width="8%" />
<col width="49%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head" colspan="5">Message Type Definitions - HUB related</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td colspan="5">Message Type definitions available for the LEGO Hub Characteristic (0x1624)</td>
</tr>
<tr class="row-odd"><td><strong>Name</strong></td>
<td><strong>Value</strong></td>
<td><strong>Comm.</strong></td>
<td><strong>Reply to</strong></td>
<td><strong>Notes</strong></td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#hub-properties"><span class="std std-ref">Hub Properties</span></a></td>
<td>0x01</td>
<td>Down + Up</td>
<td>0x01</td>
<td>Set or retrieve standard Hub Property information</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#hub-actions"><span class="std std-ref">Hub Actions</span></a></td>
<td>0x02</td>
<td>Down + Up</td>
<td>0x02</td>
<td>Perform actions on connected hub</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#hub-alerts"><span class="std std-ref">Hub Alerts</span></a></td>
<td>0x03</td>
<td>Down + Up</td>
<td>0x03</td>
<td>Subscribe or retrieve Hub alerts</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#hub-attached-i-o"><span class="std std-ref">Hub Attached I/O</span></a></td>
<td>0x04</td>
<td>Up</td>
<td>N/A</td>
<td>Transmitted upon Hub detection of attached I/O</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#generic-error-messages"><span class="std std-ref">Generic Error Messages</span></a></td>
<td>0x05</td>
<td>Up</td>
<td>N/A</td>
<td>Generic Error Messages from the Hub</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#h-w-network-commands"><span class="std std-ref">H/W NetWork Commands</span></a></td>
<td>0x08</td>
<td>Down + Up</td>
<td>0x08</td>
<td>Commands used for H/W Networks</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#f-w-update-go-into-boot-mode"><span class="std std-ref">F/W Update - Go Into Boot Mode</span></a></td>
<td>0x10</td>
<td>Down</td>
<td>N/A</td>
<td>Set the Hub in a special Boot Loader mode</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#f-w-update-lock-memory"><span class="std std-ref">F/W Update Lock memory</span></a></td>
<td>0x11</td>
<td>Down</td>
<td>N/A</td>
<td>Locks the memory</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#f-w-lock-status-request"><span class="std std-ref">F/W Update Lock Status Request</span></a></td>
<td>0x12</td>
<td>Down</td>
<td>N/A</td>
<td>Request the Memory Locking State</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#f-w-lock-status"><span class="std std-ref">F/W Lock Status</span></a></td>
<td>0x13</td>
<td>Up</td>
<td>0x12</td>
<td>Answer to the F/W Lock Status Request</td>
</tr>
</tbody>
</table>
<table border="1" class="docutils">
<colgroup>
<col width="30%" />
<col width="6%" />
<col width="7%" />
<col width="8%" />
<col width="49%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head" colspan="5">Message Type Definitions - PORT(s) related</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td colspan="5">Message Type definitions available for the LEGO Hub Characteristic (0x1624)</td>
</tr>
<tr class="row-odd"><td><strong>Name</strong></td>
<td><strong>Value</strong></td>
<td><strong>Comm.</strong></td>
<td><strong>Reply to</strong></td>
<td><strong>Notes</strong></td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#port-information-request"><span class="std std-ref">Port Information Request</span></a></td>
<td>0x21</td>
<td>Down</td>
<td>N/A</td>
<td>Request Port information</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#port-mode-information-request"><span class="std std-ref">Port Mode Information Request</span></a></td>
<td>0x22</td>
<td>Down</td>
<td>N/A</td>
<td>Request Port Mode information</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#port-input-format-setup-single"><span class="std std-ref">Port Input Format Setup (Single)</span></a></td>
<td>0x41</td>
<td>Down</td>
<td>N/A</td>
<td>Setup input format for single mode</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#port-input-format-setup-combinedmode"><span class="std std-ref">Port Input Format Setup (CombinedMode)</span></a></td>
<td>0x42</td>
<td>Down</td>
<td>&#160;</td>
<td>Setup input format for multiple modes (CombinedMode)</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#port-information"><span class="std std-ref">Port Information</span></a></td>
<td>0x43</td>
<td>Up</td>
<td>0x21</td>
<td>N/A</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#port-mode-information"><span class="std std-ref">Port Mode Information</span></a></td>
<td>0x44</td>
<td>Up</td>
<td>0x22</td>
<td>N/A</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#port-value-single"><span class="std std-ref">Port Value (Single)</span></a></td>
<td>0x45</td>
<td>Up</td>
<td>0x21</td>
<td>Value update related to single Port Mode</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#port-value-combinedmode"><span class="std std-ref">Port Value (CombinedMode)</span></a></td>
<td>0x46</td>
<td>Up</td>
<td>0x21</td>
<td>Value update related to multiple Port Modes in combination (CombinedMode)</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#port-input-format-single"><span class="std std-ref">Port Input Format (Single)</span></a></td>
<td>0x47</td>
<td>Up</td>
<td>0x41</td>
<td>N/A</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#port-input-format-combinedmode"><span class="std std-ref">Port Input Format (CombinedMode)</span></a></td>
<td>0x48</td>
<td>Up</td>
<td>0x42</td>
<td>N/A</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#virtual-port-setup"><span class="std std-ref">Virtual Port Setup</span></a></td>
<td>0x61</td>
<td>Down</td>
<td>N/A</td>
<td>Used to control synchronization between synchronizable ports.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#port-output-command"><span class="std std-ref">Port Output Command</span></a></td>
<td>0x81</td>
<td>Down</td>
<td>N/A</td>
<td>Used to execute Port Output commands</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#port-output-command-feedback"><span class="std std-ref">Port Output Command Feedback</span></a></td>
<td>0x82</td>
<td>Up</td>
<td>0x81</td>
<td>Provides feedback on completed Port Output commands</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="transmission-flow-control-preliminary-proposal">
<span id="tx-flow-ctrl"></span><h3>3.4. Transmission Flow Control (Preliminary PROPOSAL!)<a class="headerlink" href="#transmission-flow-control-preliminary-proposal" title="Permalink to this headline">¶</a></h3>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p>In order to allow a safe and lossless transmission over Bluetooth Low Energy (IOS) we have to add some delivery check. We still want fast response for small control messages.
Using a sequence number will let us known if messages are missing, but having the same knowledge at both sender and receiver will slow down the overall throughput.
Using a prioritized ack-/nack protocol could be a compromise. The priority counter could be as simple as only 1 bit.</p>
<p><strong>Sequence and priority counter:</strong>
PPPS SSSS - P = Priority counter bits (0-7) S = Sequence counter (0-31-0)</p>
<table border="1" class="last docutils">
<colgroup>
<col width="6%" />
<col width="10%" />
<col width="18%" />
<col width="65%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td colspan="2">Sender:</td>
<td>Receiver:</td>
<td>Ack/Nack counter:</td>
</tr>
<tr class="row-even"><td>010</td>
<td>00001</td>
<td>01000001</td>
<td>01000001</td>
</tr>
<tr class="row-odd"><td>001</td>
<td>00010</td>
<td>00100010</td>
<td>00100010</td>
</tr>
<tr class="row-even"><td>000</td>
<td>00011</td>
<td>00000011</td>
<td>000 =&gt; Send ACK 00011</td>
</tr>
<tr class="row-odd"><td colspan="4">&#160;</td>
</tr>
<tr class="row-even"><td>000</td>
<td>11000</td>
<td>00011000</td>
<td>000 =&gt; Send ACK 11000  // FAST</td>
</tr>
<tr class="row-odd"><td colspan="4">&#160;</td>
</tr>
<tr class="row-even"><td>011</td>
<td>11011</td>
<td>01111011</td>
<td>01111011</td>
</tr>
<tr class="row-odd"><td>010</td>
<td>11100</td>
<td>01011100</td>
<td>01011100</td>
</tr>
<tr class="row-even"><td>001</td>
<td>11101</td>
<td><cite>???????</cite></td>
<td>01011100 // Still</td>
</tr>
<tr class="row-odd"><td>000</td>
<td>11110</td>
<td>00011110</td>
<td>01011100 =&gt; Send NACK 11100</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="section" id="hub-properties">
<span id="id1"></span><h3>3.5. Hub Properties<a class="headerlink" href="#hub-properties" title="Permalink to this headline">¶</a></h3>
<table border="1" class="docutils">
<colgroup>
<col width="22%" />
<col width="78%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head" colspan="2">Message Type - Hub Properties [0x01]</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><p class="first"><strong>Communication:</strong></p>
<p><strong>Size:</strong></p>
<p class="last"><strong>Description:</strong></p>
</td>
<td><p class="first">Downstream + Upstream</p>
<p>5 Bytes + Payload</p>
<p>This message allows access and control of the various different properties of the Hub.
The message introduces the notion of Updates. This term coins the various different data
which the Hub is capable of delivering. Note, that all the data updates are controlled by
the Notify property of the LEGO Hub Characteristic.</p>
<p>If notifications are disabled, not a single update will be delivered.</p>
<p class="last">Since not all operations apply for all properties of the hub, the following table seeks
to identify valid combinations as well as indicating which data is part of the downstream
message, and vice versa.</p>
</td>
</tr>
</tbody>
</table>
<div class="section" id="hub-property-and-operation">
<h4>3.5.1. Hub Property and Operation<a class="headerlink" href="#hub-property-and-operation" title="Permalink to this headline">¶</a></h4>
<table border="1" class="docutils">
<colgroup>
<col width="29%" />
<col width="12%" />
<col width="12%" />
<col width="12%" />
<col width="12%" />
<col width="12%" />
<col width="12%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head"><strong>Property</strong></th>
<th class="head" colspan="6"><strong>Operation</strong></th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>&#160;</td>
<td>Set</td>
<td>Enable Update</td>
<td>Disable Update</td>
<td>Reset</td>
<td>Req. Update</td>
<td>Update</td>
</tr>
<tr class="row-odd"><td>Adv. Name</td>
<td>X</td>
<td>X</td>
<td>X</td>
<td>X<sup>[2]</sup> </td>
<td>X</td>
<td>X</td>
</tr>
<tr class="row-even"><td>Button</td>
<td>&#160;</td>
<td>X</td>
<td>X</td>
<td>&#160;</td>
<td>X</td>
<td>X</td>
</tr>
<tr class="row-odd"><td>FW Version</td>
<td>&#160;</td>
<td>&#160;</td>
<td>&#160;</td>
<td>&#160;</td>
<td>X</td>
<td>X</td>
</tr>
<tr class="row-even"><td>HW Version</td>
<td>&#160;</td>
<td>&#160;</td>
<td>&#160;</td>
<td>&#160;</td>
<td>X</td>
<td>X</td>
</tr>
<tr class="row-odd"><td>RSSI</td>
<td>&#160;</td>
<td>X</td>
<td>X</td>
<td>&#160;</td>
<td>X</td>
<td>X</td>
</tr>
<tr class="row-even"><td>Battery Voltage</td>
<td>&#160;</td>
<td>X</td>
<td>X</td>
<td>&#160;</td>
<td>X</td>
<td>X</td>
</tr>
<tr class="row-odd"><td>Battery Type</td>
<td>&#160;</td>
<td>&#160;</td>
<td>&#160;</td>
<td>&#160;</td>
<td>X</td>
<td>X</td>
</tr>
<tr class="row-even"><td>Manufacturer Name</td>
<td>&#160;</td>
<td>&#160;</td>
<td>&#160;</td>
<td>&#160;</td>
<td>X</td>
<td>X</td>
</tr>
<tr class="row-odd"><td>Radio Firmware Version</td>
<td>&#160;</td>
<td>&#160;</td>
<td>&#160;</td>
<td>&#160;</td>
<td>X</td>
<td>X</td>
</tr>
<tr class="row-even"><td>LWP <sup>[3]</sup> Protocol Version</td>
<td>&#160;</td>
<td>&#160;</td>
<td>&#160;</td>
<td>&#160;</td>
<td>X</td>
<td>X</td>
</tr>
<tr class="row-odd"><td>System Type ID</td>
<td>&#160;</td>
<td>&#160;</td>
<td>&#160;</td>
<td>&#160;</td>
<td>X</td>
<td>X</td>
</tr>
<tr class="row-even"><td>H/W NetWork ID x</td>
<td>X</td>
<td>&#160;</td>
<td>&#160;</td>
<td>X</td>
<td>X</td>
<td>X</td>
</tr>
<tr class="row-odd"><td>Primary MAC address</td>
<td>&#160;</td>
<td>&#160;</td>
<td>&#160;</td>
<td>&#160;</td>
<td>X</td>
<td>X</td>
</tr>
<tr class="row-even"><td>Secondary MAC address</td>
<td>&#160;</td>
<td>&#160;</td>
<td>&#160;</td>
<td>&#160;</td>
<td>X</td>
<td>X</td>
</tr>
<tr class="row-odd"><td>H/W Network Family</td>
<td>X</td>
<td>&#160;</td>
<td>&#160;</td>
<td>&#160;</td>
<td>X</td>
<td>X</td>
</tr>
</tbody>
</table>
<p><sup>[2]</sup>  Resetting the Adv. Name will automatically insert the DEFAULT NAME</p>
<p><sup>[3]</sup>  LWP = LEGO Wireless Protocol</p>
</div>
<div class="section" id="hub-property-message-format">
<h4>3.5.2. Hub Property Message Format<a class="headerlink" href="#hub-property-message-format" title="Permalink to this headline">¶</a></h4>
<table border="1" class="docutils">
<colgroup>
<col width="8%" />
<col width="62%" />
<col width="12%" />
<col width="4%" />
<col width="0%" />
<col width="5%" />
<col width="8%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head" colspan="7">Message Format</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><strong>Name</strong></td>
<td><strong>Description</strong></td>
<td><strong>Format</strong></td>
<td colspan="3"><strong>Min</strong></td>
<td><strong>Max</strong></td>
</tr>
<tr class="row-odd"><td>Common Header</td>
<td>See <a class="reference internal" href="#common-header-description"><span class="std std-ref">Common Message Header</span></a> for header format</td>
<td>N/A</td>
<td colspan="3">N/A</td>
<td>N/A</td>
</tr>
<tr class="row-even"><td>Property</td>
<td>Identifies the <a class="reference internal" href="#hub-prop-op"><span class="std std-ref">Hub Property Operation</span></a> subject to the performed operation:</td>
<td>Uint8</td>
<td colspan="3">0x01</td>
<td>0x0F</td>
</tr>
<tr class="row-odd"><td>Operation</td>
<td>Identifies the type of <a class="reference internal" href="#hub-prop-op"><span class="std std-ref">Hub Property Operation</span></a> performed:</td>
<td>Uint8</td>
<td colspan="3">0x01</td>
<td>0x06</td>
</tr>
<tr class="row-even"><td>Payload</td>
<td>The <a class="reference internal" href="#payload"><span class="std std-ref">Hub Property Payload</span></a>. Note, Common Header Length field governs the length of the payload.</td>
<td>Uint8[?]</td>
<td colspan="3">N/A</td>
<td>N/A</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="hub-property-reference">
<span id="hub-prop-ref"></span><h4>3.5.3. Hub Property Reference<a class="headerlink" href="#hub-property-reference" title="Permalink to this headline">¶</a></h4>
<table border="1" class="docutils">
<colgroup>
<col width="33%" />
<col width="67%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Property Reference
[UInt8]</th>
<th class="head">Property Name</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>0x01</td>
<td>Advertising Name</td>
</tr>
<tr class="row-odd"><td>0x02</td>
<td>Button</td>
</tr>
<tr class="row-even"><td>0x03</td>
<td>FW Version</td>
</tr>
<tr class="row-odd"><td>0x04</td>
<td>HW Version</td>
</tr>
<tr class="row-even"><td>0x05</td>
<td>RSSI</td>
</tr>
<tr class="row-odd"><td>0x06</td>
<td>Battery Voltage</td>
</tr>
<tr class="row-even"><td>0x07</td>
<td>Battery Type</td>
</tr>
<tr class="row-odd"><td>0x08</td>
<td>Manufacturer Name</td>
</tr>
<tr class="row-even"><td>0x09</td>
<td>Radio Firmware Version</td>
</tr>
<tr class="row-odd"><td>0x0A</td>
<td>LEGO Wireless Protocol Version</td>
</tr>
<tr class="row-even"><td>0x0B</td>
<td>System Type ID</td>
</tr>
<tr class="row-odd"><td>0x0C</td>
<td>H/W Network ID</td>
</tr>
<tr class="row-even"><td>0x0D</td>
<td>Primary MAC Address</td>
</tr>
<tr class="row-odd"><td>0x0E</td>
<td>Secondary MAC Address</td>
</tr>
<tr class="row-even"><td>0x0F</td>
<td>Hardware Network Family</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="hub-property-operation">
<span id="hub-prop-op"></span><h4>3.5.4. Hub Property Operation<a class="headerlink" href="#hub-property-operation" title="Permalink to this headline">¶</a></h4>
<table border="1" class="docutils">
<colgroup>
<col width="33%" />
<col width="67%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head" colspan="2">Property Operation</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>0x01</td>
<td>Set (Downstream)</td>
</tr>
<tr class="row-odd"><td>0x02</td>
<td>Enable Updates (Downstream)</td>
</tr>
<tr class="row-even"><td>0x03</td>
<td>Disable Updates (Downstream)</td>
</tr>
<tr class="row-odd"><td>0x04</td>
<td>Reset (Downstream)</td>
</tr>
<tr class="row-even"><td>0x05</td>
<td>Request Update (Downstream)</td>
</tr>
<tr class="row-odd"><td>0x06</td>
<td>Update (Upstream)</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="hub-property-payload">
<span id="payload"></span><h4>3.5.5. Hub Property Payload<a class="headerlink" href="#hub-property-payload" title="Permalink to this headline">¶</a></h4>
<table border="1" class="docutils">
<colgroup>
<col width="14%" />
<col width="15%" />
<col width="26%" />
<col width="15%" />
<col width="14%" />
<col width="15%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head" colspan="6">Property Payload</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><strong>Property ref:</strong></td>
<td><strong>Direction
Up-/Downstream:</strong></td>
<td><strong>Description</strong></td>
<td><strong>Format</strong></td>
<td><strong>Min</strong></td>
<td><strong>Max</strong></td>
</tr>
<tr class="row-odd"><td>0x01</td>
<td>Upstream/Downstream</td>
<td>Advertising Name<sup>[A]</sup> </td>
<td>UInt8[MAX_NAME_SIZE]</td>
<td>1 char</td>
<td>MAX_NAME_SIZE
<sup>[B]</sup> </td>
</tr>
<tr class="row-even"><td>0x02</td>
<td>Upstream</td>
<td>Button State
TRUE/FALSE [0x01/0x00]</td>
<td>UInt8</td>
<td>0x00</td>
<td>0x01</td>
</tr>
<tr class="row-odd"><td>0x03</td>
<td>Upstream</td>
<td>FW Version
encodes as: <a class="reference internal" href="#ver-no"><span class="std std-ref">Version Number Encoding</span></a></td>
<td>Int32<sup>[C]</sup> </td>
<td>N/A</td>
<td>N/A</td>
</tr>
<tr class="row-even"><td>0x04</td>
<td>Upstream</td>
<td>HW Version
encodes as: <a class="reference internal" href="#ver-no"><span class="std std-ref">Version Number Encoding</span></a></td>
<td>Int32<sup>[C]</sup> </td>
<td>N/A</td>
<td>N/A</td>
</tr>
<tr class="row-odd"><td>0x05</td>
<td>Upstream</td>
<td>RSSI<sup>[D]</sup> </td>
<td>Int8</td>
<td>-127</td>
<td>0</td>
</tr>
<tr class="row-even"><td>0x06</td>
<td>Upstream</td>
<td>Battery Voltage [%]</td>
<td>UInt8</td>
<td>0x00</td>
<td>0x64</td>
</tr>
<tr class="row-odd"><td>0x07</td>
<td>Upstream</td>
<td>Battery Type: [Normal/Rechargable]</td>
<td>UInt8</td>
<td>0x00
Normal Battery type</td>
<td>0x01
Rechargeable block</td>
</tr>
<tr class="row-even"><td>0x08</td>
<td>Upstream</td>
<td>Manufacturer Name
LEGO System A/S</td>
<td>Uint8[]
“LEGO System A/S”</td>
<td>UInt8[15]</td>
<td>UInt8[15]</td>
</tr>
<tr class="row-odd"><td>0x09</td>
<td>Upstream</td>
<td>Radio Firmware Version as a string.
E.g. “7.1e”</td>
<td>Uint8[]</td>
<td>UInt8[15]</td>
<td>UInt8[15]</td>
</tr>
<tr class="row-even"><td>0x0A</td>
<td>Upstream</td>
<td>LWP Protocol Version
Encoded as <a class="reference internal" href="#lwp-ver-no"><span class="std std-ref">LWP Version Number Encoding</span></a></td>
<td>UInt16</td>
<td>0x0100</td>
<td>0x9999</td>
</tr>
<tr class="row-odd"><td>0x0B</td>
<td>Upstream</td>
<td>System Type ID<sup>[E]</sup> See <a class="reference internal" href="index.html#sys-typ"><span class="std std-ref">System Type and Device Number</span></a> for info.</td>
<td>UInt8</td>
<td>N/A</td>
<td>N/A</td>
</tr>
<tr class="row-even"><td>0x0C</td>
<td>Upstream</td>
<td>H/W NetWork ID<sup>[F]</sup> See <a class="reference internal" href="index.html#lst-net"><span class="std std-ref">Last Network ID</span></a> for info.</td>
<td>UInt8</td>
<td>0x01</td>
<td>0xFA
(250)</td>
</tr>
<tr class="row-odd"><td>0x0D</td>
<td>Upstream</td>
<td>Primary MAC address<sup>[G]</sup> This is the MAC address used when
the normal application runs on the
BLE device.</td>
<td>6 Bytes</td>
<td>N/A</td>
<td>N/A</td>
</tr>
<tr class="row-even"><td>0x0E</td>
<td>Upstream</td>
<td>Secondary MAC address<sup>[G]</sup> The MAC address used for the Boot
Loader task.</td>
<td>&#160;</td>
<td>N/A</td>
<td>N/A</td>
</tr>
<tr class="row-odd"><td>0x0F</td>
<td>Upstream</td>
<td>H/W Network Family [0-8].
Used in conjunction with H/W Net-
work ID to configure H/W stand-
alone networks.
E.g. In an education setup.</td>
<td>UInt8</td>
<td>0x00</td>
<td>0x08</td>
</tr>
</tbody>
</table>
<p><sup>[A]</sup> This is also the name which is placed in the Advertising Response packet.</p>
<p><sup>[B]</sup> MAX_NAME_SIZE = 14 Chars (Packet limitations)</p>
<p><sup>[C]</sup> Sint32 is a leftover from earlier version numbering schemes.</p>
<p><sup>[D]</sup> RSSI (Received Signal Strength Indicator) is the RF-level measured at receiving device. This level depends of distance,
transmitted power and obstacles in the “line of sight”. Not a “real” calibrated dBm, but a less negative number still equals a higher
and better signal level.</p>
<p><sup>[E]</sup> System Type ID is also advertised by both the normal application and the Boot Loader. Used when the HUB or other BLE
device doesn’t have an image - i.e. this property can’t be accessed. See <a class="reference internal" href="index.html#sys-typ"><span class="std std-ref">System Type and Device Number</span></a> for encoding.</p>
<p><sup>[F]</sup> When unconnected this is the number transmitted as Last Network in the Advertising Packet.</p>
<p><sup>[G]</sup> Some operating systems uses the MAC address for persistent reference and hence different Services can not be interleaved
randomly. By using a different MAC address as well as a different UUID for the services, these operating systems will see two different services
while advertising goes on (different MAC addresses). The MAC addresses is represented as a multibyte array - BIG Endianness.</p>
</div>
<div class="section" id="version-number-encoding">
<span id="ver-no"></span><h4>3.5.6. Version Number Encoding<a class="headerlink" href="#version-number-encoding" title="Permalink to this headline">¶</a></h4>
<p>All version numbers are encoded into a 32 bit Signed Integer [Little Endianness]:
<code class="docutils literal"><span class="pre">0MMM</span> <span class="pre">mmmm</span></code> <code class="docutils literal"><span class="pre">BBBB</span> <span class="pre">BBBB</span></code> <code class="docutils literal"><span class="pre">bbbb</span> <span class="pre">bbbb</span></code> <code class="docutils literal"><span class="pre">bbbb</span> <span class="pre">bbbb</span></code></p>
<table border="1" class="docutils">
<colgroup>
<col width="16%" />
<col width="36%" />
<col width="25%" />
<col width="11%" />
<col width="11%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head" colspan="5">Version Number Encoding</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><code class="docutils literal"><span class="pre">####</span></code></td>
<td>Description</td>
<td><strong>Format (position)</strong></td>
<td><strong>Min</strong></td>
<td><strong>Max</strong></td>
</tr>
<tr class="row-odd"><td><code class="docutils literal"><span class="pre">0MMM</span></code></td>
<td>Major version - upper 4(3) bits of byte 3</td>
<td>0**MMM** ????</td>
<td>0x0?</td>
<td>0x7?</td>
</tr>
<tr class="row-even"><td><code class="docutils literal"><span class="pre">mmmm</span></code></td>
<td>Minor version - lower 4 bits of byte 3</td>
<td>???? mmmm</td>
<td>0x?0</td>
<td>0x?9</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal"><span class="pre">BBBB</span> <span class="pre">BBBB</span></code></td>
<td>Bug fixing number</td>
<td>Byte 2</td>
<td>0x00 [BCD]</td>
<td>0x99 [BCD]</td>
</tr>
<tr class="row-even"><td><code class="docutils literal"><span class="pre">bbbb</span> <span class="pre">bbbb</span> <span class="pre">bbbb</span> <span class="pre">bbbb</span></code></td>
<td>Build Number</td>
<td>Byte 1 and Byte 0 (unsigned SHORT)</td>
<td>0x0000 [BCD]</td>
<td>0x9999 [BCD]</td>
</tr>
</tbody>
</table>
<p>As an example <strong>1.7.37</strong>.1510 is encoded as shown below:
(Numbers normally presented at user-level is shown in <strong>bold</strong>)</p>
<blockquote>
<div><p>These are encoded in the 4 bytes as:</p>
<table border="1" class="docutils">
<colgroup>
<col width="36%" />
<col width="64%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>Byte 3 (MSB):</td>
<td><strong>0x17</strong> (Presented at user-level)</td>
</tr>
<tr class="row-even"><td>Byte 2:</td>
<td><strong>0x37</strong> (Presented at user-level)</td>
</tr>
<tr class="row-odd"><td>Byte 1:</td>
<td>0x15</td>
</tr>
<tr class="row-even"><td>Byte 0 (LSB):</td>
<td>0x10</td>
</tr>
</tbody>
</table>
</div></blockquote>
</div>
<div class="section" id="lwp-version-number-encoding">
<span id="lwp-ver-no"></span><h4>3.5.7. LWP Version Number Encoding<a class="headerlink" href="#lwp-version-number-encoding" title="Permalink to this headline">¶</a></h4>
<p>The LWP Protocol Version is encoded in a single UInt16 as BCD.
<code class="docutils literal"><span class="pre">MMMM</span> <span class="pre">MMMM</span></code> <code class="docutils literal"><span class="pre">mmmm</span> <span class="pre">mmmm</span></code></p>
<table border="1" class="docutils">
<colgroup>
<col width="16%" />
<col width="36%" />
<col width="25%" />
<col width="11%" />
<col width="11%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head" colspan="5">LWP Version Number Encoding (LEGO Wireless Protocol)</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><code class="docutils literal"><span class="pre">####</span> <span class="pre">####</span></code></td>
<td>Description</td>
<td><strong>Format (position)</strong></td>
<td><strong>Min</strong></td>
<td><strong>Max</strong></td>
</tr>
<tr class="row-odd"><td><code class="docutils literal"><span class="pre">MMMM</span> <span class="pre">MMMMM</span></code></td>
<td>Major version - upper 8 bits</td>
<td>Byte 1</td>
<td>0x01</td>
<td>0x99</td>
</tr>
<tr class="row-even"><td><code class="docutils literal"><span class="pre">mmmm</span> <span class="pre">mmmm</span></code></td>
<td>Minor version - lower 8 bits</td>
<td>Byte 0</td>
<td>0x00</td>
<td>0x99</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="section" id="hub-actions">
<span id="id2"></span><h3>3.6. Hub Actions<a class="headerlink" href="#hub-actions" title="Permalink to this headline">¶</a></h3>
<table border="1" class="docutils">
<colgroup>
<col width="22%" />
<col width="78%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head" colspan="2">Message Type - Hub Actions [0x02]</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><p class="first"><strong>Communication:</strong></p>
<p><strong>Size:</strong></p>
<p class="last"><strong>Description:</strong></p>
</td>
<td><p class="first">Downstream + Upstream</p>
<p>4 Bytes</p>
<p class="last">This message allows for performing control actions on the connected Hub. Some of
the controlling downstream actions, will trigger upstream updates from the hub.</p>
</td>
</tr>
</tbody>
</table>
<div class="section" id="hub-action-message-format">
<h4>3.6.1. Hub Action Message Format<a class="headerlink" href="#hub-action-message-format" title="Permalink to this headline">¶</a></h4>
<table border="1" class="docutils">
<colgroup>
<col width="15%" />
<col width="6%" />
<col width="50%" />
<col width="11%" />
<col width="10%" />
<col width="7%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head" colspan="6"><strong>Hub Action Message Format</strong></th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><strong>Name</strong></td>
<td colspan="2"><strong>Description</strong></td>
<td><strong>Format</strong></td>
<td><strong>Min</strong></td>
<td><strong>Max</strong></td>
</tr>
<tr class="row-odd"><td>Common Header</td>
<td colspan="2">See <a class="reference internal" href="#common-header-description"><span class="std std-ref">Common Message Header</span></a></td>
<td>N/A</td>
<td>N/A</td>
<td>N/A</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#act-typ"><span class="std std-ref">Action Types</span></a></td>
<td colspan="2">Identifies the property subject to the performed operation:</td>
<td>Uint8</td>
<td>0x01</td>
<td>0x32</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="action-types">
<span id="act-typ"></span><h4>3.6.2. Action Types<a class="headerlink" href="#action-types" title="Permalink to this headline">¶</a></h4>
<table border="1" class="docutils">
<colgroup>
<col width="17%" />
<col width="83%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head" colspan="2">Downstream (reserved 0-0x2F)</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><strong>Action Type</strong></td>
<td><strong>Description</strong></td>
</tr>
<tr class="row-odd"><td>0x01</td>
<td>Switch Off Hub</td>
</tr>
<tr class="row-even"><td>0x02</td>
<td>Disconnect</td>
</tr>
<tr class="row-odd"><td>0x03</td>
<td>VCC Port Control On</td>
</tr>
<tr class="row-even"><td>0x04</td>
<td>VCC Port Control Off</td>
</tr>
<tr class="row-odd"><td>0x05</td>
<td>Activate BUSY Indication (Shown byRGB. Actual RGB settings preserved).</td>
</tr>
<tr class="row-even"><td>0x06</td>
<td>Reset BUSY Indication (RGB shows the previously preserve RGB settings).</td>
</tr>
<tr class="row-odd"><td>…</td>
<td>&#160;</td>
</tr>
<tr class="row-even"><td>…</td>
<td>&#160;</td>
</tr>
<tr class="row-odd"><td>0X2F</td>
<td>Shutdown the Hub without any up-stream information send.
Used for fast power down in production.
Suggested for <strong>PRODUCTION USE ONLY!</strong></td>
</tr>
</tbody>
</table>
<table border="1" class="docutils">
<colgroup>
<col width="17%" />
<col width="83%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head" colspan="2">Upstream (reserved 0x30-0x64)</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><strong>Action Type</strong></td>
<td><strong>Description</strong></td>
</tr>
<tr class="row-odd"><td>0x30</td>
<td>Hub Will Switch Off</td>
</tr>
<tr class="row-even"><td>0x31</td>
<td>Hub Will Disconnect</td>
</tr>
<tr class="row-odd"><td>0x32</td>
<td>Hub Will Go Into Boot Mode</td>
</tr>
<tr class="row-even"><td>…</td>
<td>&#160;</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="section" id="hub-alerts">
<span id="id3"></span><h3>3.7. Hub Alerts<a class="headerlink" href="#hub-alerts" title="Permalink to this headline">¶</a></h3>
<table border="1" class="docutils">
<colgroup>
<col width="30%" />
<col width="14%" />
<col width="56%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head" colspan="3">Message Type - Hub Alerts [0x03]</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td rowspan="4"><p class="first"><strong>Communication:</strong></p>
<p><strong>Size:</strong></p>
<p class="last"><strong>Description:</strong></p>
</td>
<td colspan="2">Upstream and Downstream</td>
</tr>
<tr class="row-odd"><td>Upstream</td>
<td>5 bytes</td>
</tr>
<tr class="row-even"><td>Downstream</td>
<td>6 Bytes including the “Boolean” <a class="reference internal" href="#al-pay"><span class="std std-ref">Alert Payload</span></a></td>
</tr>
<tr class="row-odd"><td colspan="2">This message allow for subscribing to Hub alerts as well
requesting current state of these.</td>
</tr>
</tbody>
</table>
<div class="section" id="hub-alert-message-format">
<h4>3.7.1. Hub Alert Message Format<a class="headerlink" href="#hub-alert-message-format" title="Permalink to this headline">¶</a></h4>
<table border="1" class="docutils">
<colgroup>
<col width="16%" />
<col width="47%" />
<col width="15%" />
<col width="12%" />
<col width="9%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head" colspan="5"><strong>Hub Alert Message Format</strong></th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><strong>Name</strong></td>
<td><strong>Description</strong></td>
<td><strong>Format</strong></td>
<td><strong>Min</strong></td>
<td><strong>Max</strong></td>
</tr>
<tr class="row-odd"><td>Common Header</td>
<td>See <a class="reference internal" href="#common-header-description"><span class="std std-ref">Common Message Header</span></a></td>
<td>N/A</td>
<td>N/A</td>
<td>N/A</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#al-typ"><span class="std std-ref">Alert type</span></a></td>
<td>Identifies the property subject to the performed operation:</td>
<td>Uint8</td>
<td>0x01</td>
<td>0x04</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#al-op"><span class="std std-ref">Alert Operation</span></a></td>
<td>The operation to perform on the specified property</td>
<td>Uint8</td>
<td>0x01</td>
<td>0x04</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="alert-type">
<span id="al-typ"></span><h4>3.7.2. Alert type<a class="headerlink" href="#alert-type" title="Permalink to this headline">¶</a></h4>
<table border="1" class="docutils">
<colgroup>
<col width="33%" />
<col width="67%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head" colspan="2">Hub Alert Types</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><strong>Alert Type</strong></td>
<td><strong>Description</strong></td>
</tr>
<tr class="row-odd"><td>0x01</td>
<td>Low Voltage</td>
</tr>
<tr class="row-even"><td>0x02</td>
<td>High Current</td>
</tr>
<tr class="row-odd"><td>0x03</td>
<td>Low Signal Strength</td>
</tr>
<tr class="row-even"><td>0x04</td>
<td>Over Power Condition</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="alert-operation">
<span id="al-op"></span><h4>3.7.3. Alert Operation<a class="headerlink" href="#alert-operation" title="Permalink to this headline">¶</a></h4>
<table border="1" class="docutils">
<colgroup>
<col width="33%" />
<col width="67%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head" colspan="2">Hub Alert Operations</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><strong>Alert Operation</strong></td>
<td><strong>Description</strong></td>
</tr>
<tr class="row-odd"><td>0x01</td>
<td>Enable Updates (Downstream)</td>
</tr>
<tr class="row-even"><td>0x02</td>
<td>Disable Updates (Downstream)</td>
</tr>
<tr class="row-odd"><td>0x03</td>
<td>Request Updates (Downstream)</td>
</tr>
<tr class="row-even"><td>0x04</td>
<td>Update (Upstream)</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="alert-payload">
<span id="al-pay"></span><h4>3.7.4. Alert Payload<a class="headerlink" href="#alert-payload" title="Permalink to this headline">¶</a></h4>
<table border="1" class="docutils">
<colgroup>
<col width="33%" />
<col width="67%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head" colspan="2"><strong>Hub Alert Message Payload in upstream direction</strong></th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><strong>Alert Payload</strong></td>
<td><strong>Description</strong></td>
</tr>
<tr class="row-odd"><td>0x00</td>
<td>Status OK</td>
</tr>
<tr class="row-even"><td>0xFF</td>
<td>Alert!</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="section" id="hub-attached-i-o">
<span id="id4"></span><h3>3.8. Hub Attached I/O<a class="headerlink" href="#hub-attached-i-o" title="Permalink to this headline">¶</a></h3>
<table border="1" class="docutils">
<colgroup>
<col width="23%" />
<col width="10%" />
<col width="67%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head" colspan="3">Message Type - Hub Attached I/O [0x04]</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><strong>Communication:</strong></td>
<td colspan="2">Upstream</td>
</tr>
<tr class="row-odd"><td rowspan="3"><strong>Size:</strong></td>
<td>5 Bytes</td>
<td>(Detached I/O)</td>
</tr>
<tr class="row-even"><td>15 Bytes</td>
<td>(Attached I/O)</td>
</tr>
<tr class="row-odd"><td>9 Bytes</td>
<td>(Attached Virtual I/O)</td>
</tr>
<tr class="row-even"><td><strong>Description:</strong></td>
<td colspan="2"><p class="first">This message allow for subscribing to Hub alerts as well as requesting current state of
these.</p>
<p class="last"><strong>REMARK:</strong>
Current running implementations (primo 2018) will only send this message for Virtual
Ports at the very first Attached IO message. If Virtual Port Setup [0x61] is called later
the move-bases and HUBs will incorrectly send an error upstream. Should just reply with
the already (implicit) set port IDs.</p>
</td>
</tr>
</tbody>
</table>
<div class="section" id="hub-attached-i-o-message-format">
<h4>3.8.1. Hub Attached I/O Message Format<a class="headerlink" href="#hub-attached-i-o-message-format" title="Permalink to this headline">¶</a></h4>
<table border="1" class="docutils">
<colgroup>
<col width="9%" />
<col width="61%" />
<col width="12%" />
<col width="10%" />
<col width="8%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head" colspan="5">Hub Attached I/O - Message Format</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><strong>Name</strong></td>
<td><strong>Description</strong></td>
<td><strong>Format</strong></td>
<td><strong>Min</strong></td>
<td><strong>Max</strong></td>
</tr>
<tr class="row-odd"><td>Common Header</td>
<td>See <a class="reference internal" href="#common-header-description"><span class="std std-ref">Common Message Header</span></a></td>
<td>N/A</td>
<td>N/A</td>
<td>N/A</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#p-id"><span class="std std-ref">Port ID</span></a></td>
<td>The Port ID associated with the Attached I/O assigned by the Hub</td>
<td>UInt8</td>
<td>0</td>
<td><a class="reference internal" href="#p-id"><span class="std std-ref">Port ID</span></a></td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#io-evt"><span class="std std-ref">Event</span></a></td>
<td>IO de- and attachment events</td>
<td>UInt8</td>
<td>0x00</td>
<td>0x02</td>
</tr>
<tr class="row-even"><td colspan="5"><strong>Below IO Type ID only for the Attached I/O and Attached Virtual I/O</strong></td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#io-typ"><span class="std std-ref">IO Type ID</span></a></td>
<td>Unique type identification of the attached I/O device.</td>
<td>UInt16</td>
<td>0x0000</td>
<td>0xFFFF</td>
</tr>
<tr class="row-even"><td colspan="5"><strong>Below only set if Event = Attached I/O</strong></td>
</tr>
<tr class="row-odd"><td>Hardware
Revision</td>
<td>The hardware revision of the I/O
Four bytes: {major, minor, bugfix, buildno} See <a class="reference internal" href="#ver-no"><span class="std std-ref">Version Number Encoding</span></a>:</td>
<td>Int32</td>
<td>N/A</td>
<td>N/A</td>
</tr>
<tr class="row-even"><td>Software
Revision</td>
<td>The software revision of the I/O
Four bytes: {major, minor, bugfix, buildno} See <a class="reference internal" href="#ver-no"><span class="std std-ref">Version Number Encoding</span></a>:</td>
<td>Int32</td>
<td>N/A</td>
<td>N/A</td>
</tr>
<tr class="row-odd"><td colspan="5"><strong>Below only set if Event = Attached Virtual I/O</strong></td>
</tr>
<tr class="row-even"><td>Port ID A</td>
<td>The first <a class="reference internal" href="#p-id"><span class="std std-ref">Port ID</span></a> forming the Virtual I/O</td>
<td>Uint8</td>
<td>N/A</td>
<td>N/A</td>
</tr>
<tr class="row-odd"><td>Port ID B</td>
<td>The second <a class="reference internal" href="#p-id"><span class="std std-ref">Port ID</span></a> forming the Virtual I/O</td>
<td>Uint8</td>
<td>N/A</td>
<td>N/A</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="port-id">
<span id="p-id"></span><h4>3.8.2. Port ID<a class="headerlink" href="#port-id" title="Permalink to this headline">¶</a></h4>
<table border="1" class="docutils">
<colgroup>
<col width="30%" />
<col width="70%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head" colspan="2">Port ID</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><strong>ID range</strong></td>
<td><strong>Description</strong></td>
</tr>
<tr class="row-odd"><td>000 - 049</td>
<td>Hub connector (0, 1, 2 .. 49)<sup>[##]</sup> </td>
</tr>
<tr class="row-even"><td>050 - 100</td>
<td>Internal</td>
</tr>
<tr class="row-odd"><td>101 - 255</td>
<td>Reserved</td>
</tr>
</tbody>
</table>
<p><sup>[##]</sup> Port IDs 0x00 - 0x0F used by HardWare Functional Mapping.</p>
</div>
<div class="section" id="event">
<span id="io-evt"></span><h4>3.8.3. Event<a class="headerlink" href="#event" title="Permalink to this headline">¶</a></h4>
<table border="1" class="docutils">
<colgroup>
<col width="33%" />
<col width="67%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head" colspan="2">I/O Event</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><strong>Event</strong></td>
<td><strong>Description</strong></td>
</tr>
<tr class="row-odd"><td>0x00</td>
<td>Detached I/O</td>
</tr>
<tr class="row-even"><td>0x01</td>
<td>Attached I/O</td>
</tr>
<tr class="row-odd"><td>0x02</td>
<td>Attached Virtual I/O</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="io-type-id">
<span id="io-typ"></span><h4>3.8.4. IO Type ID<a class="headerlink" href="#io-type-id" title="Permalink to this headline">¶</a></h4>
<table border="1" class="docutils">
<colgroup>
<col width="33%" />
<col width="67%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head" colspan="2">IO Type IDs</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td colspan="2">Below mentioned IDs are the ones known at release of this
document. Hence these IDs are only mentioned as a user-
friendly reference.
List <strong>NOT</strong> guaranteed up to date!</td>
</tr>
<tr class="row-odd"><td><strong>Type ID</strong></td>
<td><strong>Description</strong></td>
</tr>
<tr class="row-even"><td>0x0001</td>
<td>Motor</td>
</tr>
<tr class="row-odd"><td>0x0002</td>
<td>System Train Motor</td>
</tr>
<tr class="row-even"><td>0x0005</td>
<td>Button</td>
</tr>
<tr class="row-odd"><td>0x0014</td>
<td>Voltage</td>
</tr>
<tr class="row-even"><td>0x0015</td>
<td>Current</td>
</tr>
<tr class="row-odd"><td>0x0016</td>
<td>Piezo Tone (Sound)</td>
</tr>
<tr class="row-even"><td>0x0017</td>
<td>RGB Light</td>
</tr>
<tr class="row-odd"><td>0x0022</td>
<td>External Tilt Sensor</td>
</tr>
<tr class="row-even"><td>0x0023</td>
<td>Motion Sensor</td>
</tr>
<tr class="row-odd"><td>0x0025</td>
<td>Vision Sensor</td>
</tr>
<tr class="row-even"><td>0x0026</td>
<td>External Motor with Tacho</td>
</tr>
<tr class="row-odd"><td>0x0027</td>
<td>Internal Motor with Tacho</td>
</tr>
<tr class="row-even"><td>0x0028</td>
<td>Internal Tilt</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="section" id="generic-error-messages">
<span id="id5"></span><h3>3.9. Generic Error Messages<a class="headerlink" href="#generic-error-messages" title="Permalink to this headline">¶</a></h3>
<table border="1" class="docutils">
<colgroup>
<col width="22%" />
<col width="78%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head" colspan="2">Message Type - Error Messages [0x05]</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><p class="first"><strong>Communication:</strong></p>
<p><strong>Size:</strong></p>
<p class="last"><strong>Description:</strong></p>
</td>
<td><p class="first">Upstream</p>
<p>5 Bytes</p>
<p>Generic Errors (also informative feedback e.g. ACK) messages. Definitions of the error
types are listed at <a class="reference internal" href="#err-def"><span class="std std-ref">Error Codes</span></a>. Errors messages includes the command ID which intro-
duced the error or the ACK (message).</p>
<p>The Overcurrent (0x07) is send when an already stalled output is issued another active
output command. I.e. telling the user that the command will not be executed due to the
Overcurrent of the stalled output port.</p>
<p class="last">The <strong>Internal ERROR</strong> should never occur - only triggered if internal functionality
fails. Wrong command and/or wrong parameters are signaled as 0x05 and 0x06</p>
</td>
</tr>
</tbody>
</table>
<div class="section" id="error-message-format">
<h4>3.9.1. Error Message Format<a class="headerlink" href="#error-message-format" title="Permalink to this headline">¶</a></h4>
<table border="1" class="docutils">
<colgroup>
<col width="9%" />
<col width="61%" />
<col width="12%" />
<col width="10%" />
<col width="8%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td colspan="5"><strong>Error Message Format</strong></td>
</tr>
<tr class="row-even"><td><strong>Name</strong></td>
<td><strong>Description</strong></td>
<td><strong>Format</strong></td>
<td><strong>Min</strong></td>
<td><strong>Max</strong></td>
</tr>
<tr class="row-odd"><td>Common Header</td>
<td>See <a class="reference internal" href="#common-header-description"><span class="std std-ref">Common Message Header</span></a></td>
<td>N/A</td>
<td>N/A</td>
<td>N/A</td>
</tr>
<tr class="row-even"><td>Command type</td>
<td>The Command which has introduced this message. See the definitions in this document
if Error is 0x05 the Message Type will of course be an invalid Message token.</td>
<td>UInt8</td>
<td>0x01</td>
<td>0xFF</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#err-def"><span class="std std-ref">Error Codes</span></a></td>
<td>The error introduce by the above mentioned command</td>
<td>UInt8</td>
<td>0x01</td>
<td>0x08</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="error-codes">
<span id="err-def"></span><h4>3.9.2. Error Codes<a class="headerlink" href="#error-codes" title="Permalink to this headline">¶</a></h4>
<table border="1" class="docutils">
<colgroup>
<col width="33%" />
<col width="67%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head" colspan="2">Error codes</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><strong>Error code</strong></td>
<td><strong>Error Description</strong></td>
</tr>
<tr class="row-odd"><td>0x01</td>
<td>ACK</td>
</tr>
<tr class="row-even"><td>0x02</td>
<td>MACK</td>
</tr>
<tr class="row-odd"><td>0x03</td>
<td>Buffer Overflow</td>
</tr>
<tr class="row-even"><td>0x04</td>
<td>Timeout</td>
</tr>
<tr class="row-odd"><td>0x05</td>
<td>Command NOT recognized</td>
</tr>
<tr class="row-even"><td>0x06</td>
<td>Invalid use (e.g. parameter error(s)</td>
</tr>
<tr class="row-odd"><td>0x07</td>
<td>Overcurrent</td>
</tr>
<tr class="row-even"><td>0x08</td>
<td>Internal ERROR</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="section" id="h-w-network-commands">
<span id="id6"></span><h3>3.10. H/W NetWork Commands<a class="headerlink" href="#h-w-network-commands" title="Permalink to this headline">¶</a></h3>
<table border="1" class="docutils">
<colgroup>
<col width="22%" />
<col width="35%" />
<col width="43%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head" colspan="3">Message Type - H/W Network Commands [0x08]</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><strong>Communication:</strong></td>
<td colspan="2">Upstream and Downstream</td>
</tr>
<tr class="row-odd"><td rowspan="13"><strong>Size:</strong></td>
<td>Connect Request (upstream)</td>
<td>5 Bytes</td>
</tr>
<tr class="row-even"><td>Family Request (upstream)</td>
<td>4 Bytes</td>
</tr>
<tr class="row-odd"><td>Family Set (downstream)</td>
<td>5 Bytes</td>
</tr>
<tr class="row-even"><td>Join Denied (downstream)</td>
<td>4 Bytes</td>
</tr>
<tr class="row-odd"><td>Get Family (downstream)</td>
<td>4 Bytes</td>
</tr>
<tr class="row-even"><td>Family (upstream)</td>
<td>5 Bytes</td>
</tr>
<tr class="row-odd"><td>Get SubFamily (downstream)</td>
<td>4 Bytes</td>
</tr>
<tr class="row-even"><td>SubFamily (upstream)</td>
<td>5 bytes</td>
</tr>
<tr class="row-odd"><td>SubFamily Set New (downstream)</td>
<td>5 bytes</td>
</tr>
<tr class="row-even"><td>Get Extended Family (downstream)</td>
<td>4 bytes</td>
</tr>
<tr class="row-odd"><td>Extended Family (upstream)</td>
<td>5 bytes</td>
</tr>
<tr class="row-even"><td>Extended Family Set New (downstream)</td>
<td>5 bytes</td>
</tr>
<tr class="row-odd"><td>Reset Long Press Timing (downstream)</td>
<td>4 bytes</td>
</tr>
<tr class="row-even"><td rowspan="14"><strong>Description:</strong></td>
<td colspan="2">These commands are ONLY used for HardWare NetWork connectivity. I.e. Network without a
Smart Device (e.g. IPad, IPhone etc.). The commands are used for setting up, routing
connection commands and disconnecting devices from a H/W only network.</td>
</tr>
<tr class="row-odd"><td>Connection Request: [UpStream]</td>
<td>This message is used to route/gate a connection
request from a peripheral device up to the con-
trolling Central device. The user should be able
to press the button on any devices in the current
connected network for requesting a connection.
Both the Pressed and the Release is send.</td>
</tr>
<tr class="row-even"><td>Family Request: [UpStream]</td>
<td>When send upstream (from any device in the H/W
network) this message is a request for a new
Family and SubFamily, if possible.</td>
</tr>
<tr class="row-odd"><td>Family Set New: [DownStream]</td>
<td>This command is send from the controlling Central
device and has the new Family added as payload.</td>
</tr>
<tr class="row-even"><td>Join Denied: [DownStream]</td>
<td>This command is send to a peripheral trying to
connect to a network where the maximum of nodes is
reached (i.e. NO further connections available).</td>
</tr>
<tr class="row-odd"><td>Get Family: [DownStream]</td>
<td>Requesting the previous used Family for a specific
(the addressed) device, just entered a network -
NO family decided yet.</td>
</tr>
<tr class="row-even"><td>Family: [UpStream]</td>
<td>This is the answer returned for above command
(Get Family 0x06). Used by the Central Role device
to decide the Family at auto connection.</td>
</tr>
<tr class="row-odd"><td>Get SubFamily: [DownStream]</td>
<td>Requesting the previous used SubFamily (Function)
on a specific (addressed) device. E.g. a 2 port
R/C to a 4 port hub. I.e. addressing a specific
port (A+B or C+D)</td>
</tr>
<tr class="row-even"><td>SubFamily: [UpStream]</td>
<td>This is the answer returned for above command (Get
SubFamily 0x08). Used by the Central Role device
to decide the SubFamily at auto connection.</td>
</tr>
<tr class="row-odd"><td>SubFamily Set New: [DownStream]</td>
<td>This command is send from the controlling Central
device and has the new SubFamily added as payload.</td>
</tr>
<tr class="row-even"><td>Get Extended Family: [DownStream]</td>
<td>Requesting the previous used Family and SubFamily
for a specific (the addressed) device. The user
can get both the Family and the SubFamily in one
tx/rx. Further both are only using 3 bits for the
addressing leaving one bit each for future use
and/or escape.</td>
</tr>
<tr class="row-odd"><td>Extended Family: [UpStream]</td>
<td>This is the answer returned for above command
(Get Extended Family 0x0A).</td>
</tr>
<tr class="row-even"><td>Extended Family Set New: [DownStream]</td>
<td>The user can set both the Family and the SubFamily
in one tx/rx. Further both are only using 3 bits
for the addressing leaving one bit each for future
use and/or escape (extended use).</td>
</tr>
<tr class="row-odd"><td>Reset Long Press Timing: [Down Stream]</td>
<td>The timing of the user CONNECTION PRESS may be
stretched (timer reset) when connecting in a
Bluetooth active environment. I.e. the LONG PRESS
normally is used for powering down a device, but
also used for gating keypresses to the Central in
a connection sequence (allowing a longer connec-
tion time without povering down.</td>
</tr>
</tbody>
</table>
<div class="section" id="h-w-network-message-format">
<span id="hw-fmt"></span><h4>3.10.1. H/W NetWork Message Format<a class="headerlink" href="#h-w-network-message-format" title="Permalink to this headline">¶</a></h4>
<table border="1" class="docutils">
<colgroup>
<col width="18%" />
<col width="47%" />
<col width="14%" />
<col width="12%" />
<col width="9%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head" colspan="5">H/W NetWork Message Format</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><strong>Name</strong></td>
<td><strong>Description</strong></td>
<td><strong>Format</strong></td>
<td><strong>Min</strong></td>
<td><strong>Max</strong></td>
</tr>
<tr class="row-odd"><td>Common Header</td>
<td>See <a class="reference internal" href="#common-header-description"><span class="std std-ref">Common Message Header</span></a></td>
<td>N/A</td>
<td>N/A</td>
<td>N/A</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#hw-cmd"><span class="std std-ref">H/W NetWork Command Type</span></a></td>
<td>Hardware Network command token</td>
<td>UInt8</td>
<td>0x02</td>
<td>0x0E</td>
</tr>
<tr class="row-odd"><td colspan="5"><strong>H/W NetWork Command Type = 0x02 Connection Request [Upstream]</strong></td>
</tr>
<tr class="row-even"><td>Connection Request Payload</td>
<td><div class="first last line-block">
<div class="line">Button State:</div>
<div class="line">Pressed  = 0x01</div>
<div class="line">Released = 0x00</div>
</div>
</td>
<td>UInt8</td>
<td>0x00</td>
<td>0x01</td>
</tr>
<tr class="row-odd"><td colspan="5"><strong>H/W NetWork Command Type = 0x04 Family Set New [Downstream]</strong></td>
</tr>
<tr class="row-even"><td>New <a class="reference internal" href="#hw-fam"><span class="std std-ref">H/W NetWork Family</span></a> payload</td>
<td>The New <a class="reference internal" href="#hw-fam"><span class="std std-ref">H/W NetWork Family</span></a> from controlling Central Device</td>
<td>Uint8</td>
<td>0x01</td>
<td>0x08</td>
</tr>
<tr class="row-odd"><td colspan="5"><strong>H/W NetWork Command Type = 0x07 “Family” [Upstream]</strong></td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#hw-fam"><span class="std std-ref">H/W NetWork Family</span></a> payload</td>
<td>Family 0-8 (0), encoding see <a class="reference internal" href="#hw-fam"><span class="std std-ref">H/W NetWork Family</span></a></td>
<td>Uint8</td>
<td>0x01</td>
<td>0x08</td>
</tr>
<tr class="row-odd"><td colspan="5"><strong>H/W NetWork Command Type = 0x09 SubFamily [Upstream]</strong></td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#hw-sub"><span class="std std-ref">H/W NetWork Sub-Family</span></a> payload</td>
<td>SubFamily 1-7, encoding see <a class="reference internal" href="#hw-sub"><span class="std std-ref">H/W NetWork Sub-Family</span></a></td>
<td>Uint8</td>
<td>0x01</td>
<td>0x07</td>
</tr>
<tr class="row-odd"><td colspan="5"><strong>H/W NetWork Command Type = 0x0A SubFamily Set New [Downstream]</strong></td>
</tr>
<tr class="row-even"><td>New <a class="reference internal" href="#hw-sub"><span class="std std-ref">H/W NetWork Sub-Family</span></a> payload</td>
<td>The New <a class="reference internal" href="#hw-sub"><span class="std std-ref">H/W NetWork Sub-Family</span></a> from controlling Central Device.</td>
<td>Uint8</td>
<td>0x01</td>
<td>0x07</td>
</tr>
<tr class="row-odd"><td colspan="5"><strong>H/W NetWork Command Type = 0x0C Extended Family [Upstream]</strong></td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#ext-fam"><span class="std std-ref">H/W NetWork Extended Family</span></a> payload</td>
<td>Command used to get both the <a class="reference internal" href="#hw-fam"><span class="std std-ref">H/W NetWork Family</span></a> 0-8 and <a class="reference internal" href="#hw-sub"><span class="std std-ref">H/W NetWork Sub-Family</span></a> 1-7
in one single transmission. Encoded as shown at <a class="reference internal" href="#ext-fam"><span class="std std-ref">H/W NetWork Extended Family</span></a>.</td>
<td>Uint8</td>
<td>0x11</td>
<td>0x78</td>
</tr>
<tr class="row-odd"><td colspan="5"><strong>H/W NetWork Command Type = 0x0D Extended Family Set New [Downstream]</strong></td>
</tr>
<tr class="row-even"><td>New <a class="reference internal" href="#ext-fam"><span class="std std-ref">H/W NetWork Extended Family</span></a> payload</td>
<td>Command used to get both the <a class="reference internal" href="#hw-fam"><span class="std std-ref">H/W NetWork Family</span></a> 0-8 and <a class="reference internal" href="#hw-sub"><span class="std std-ref">H/W NetWork Sub-Family</span></a> 1-7
in one single transmission. Encoded as shown at <a class="reference internal" href="#ext-fam"><span class="std std-ref">H/W NetWork Extended Family</span></a>.</td>
<td>Uint8</td>
<td>0x11</td>
<td>0x78</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="h-w-network-command-type">
<span id="hw-cmd"></span><h4>3.10.2. H/W NetWork Command Type<a class="headerlink" href="#h-w-network-command-type" title="Permalink to this headline">¶</a></h4>
<table border="1" class="docutils">
<colgroup>
<col width="30%" />
<col width="70%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head" colspan="2">H/W NetWork Command Types</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><strong>Command Type:</strong></td>
<td><strong>Description</strong></td>
</tr>
<tr class="row-odd"><td>0x02</td>
<td>Connection Request</td>
</tr>
<tr class="row-even"><td>0x03</td>
<td>Family Request [New family if available]</td>
</tr>
<tr class="row-odd"><td>0x04</td>
<td>Family Set</td>
</tr>
<tr class="row-even"><td>0x05</td>
<td>Join Denied</td>
</tr>
<tr class="row-odd"><td>0x06</td>
<td>Get Family</td>
</tr>
<tr class="row-even"><td>0x07</td>
<td>Family</td>
</tr>
<tr class="row-odd"><td>0x08</td>
<td>Get SubFamily</td>
</tr>
<tr class="row-even"><td>0x09</td>
<td>SubFamily</td>
</tr>
<tr class="row-odd"><td>0x0A</td>
<td>SubFamily Set</td>
</tr>
<tr class="row-even"><td>0x0B</td>
<td>Get Extended Family</td>
</tr>
<tr class="row-odd"><td>0x0C</td>
<td>Extended Family</td>
</tr>
<tr class="row-even"><td>0x0D</td>
<td>Extended Family Set</td>
</tr>
<tr class="row-odd"><td>0x0E</td>
<td>Reset Long Press Timing</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="h-w-network-family">
<span id="hw-fam"></span><h4>3.10.3. H/W NetWork Family<a class="headerlink" href="#h-w-network-family" title="Permalink to this headline">¶</a></h4>
<table border="1" class="docutils">
<colgroup>
<col width="42%" />
<col width="42%" />
<col width="16%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head" colspan="3">H/W NetWork Families (Colours)</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><strong>Family:</strong></td>
<td><strong>Colours:</strong></td>
<td><strong>#:</strong></td>
</tr>
<tr class="row-odd"><td>Family 1</td>
<td>Green</td>
<td>0x01</td>
</tr>
<tr class="row-even"><td>Family 2</td>
<td>Yellow</td>
<td>0x02</td>
</tr>
<tr class="row-odd"><td>Family 3</td>
<td>Red</td>
<td>0x03</td>
</tr>
<tr class="row-even"><td>Family 4</td>
<td>Blue</td>
<td>0x04</td>
</tr>
<tr class="row-odd"><td>Family 5</td>
<td>Purple</td>
<td>0x05</td>
</tr>
<tr class="row-even"><td>Family 6</td>
<td>Light Blue</td>
<td>0x06</td>
</tr>
<tr class="row-odd"><td>Family 7</td>
<td>Teal</td>
<td>0x07</td>
</tr>
<tr class="row-even"><td>Family 8</td>
<td>Pink</td>
<td>0x08</td>
</tr>
<tr class="row-odd"><td><strong>Family 0 (zero)</strong></td>
<td>White<sup>[1]</sup> </td>
<td>0x00</td>
</tr>
</tbody>
</table>
<p><sup>[1]</sup> Optional Platform Family</p>
</div>
<div class="section" id="h-w-network-sub-family">
<span id="hw-sub"></span><h4>3.10.4. H/W NetWork Sub-Family<a class="headerlink" href="#h-w-network-sub-family" title="Permalink to this headline">¶</a></h4>
<table border="1" class="docutils">
<colgroup>
<col width="42%" />
<col width="42%" />
<col width="16%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head" colspan="3">H/W NetWork Families (Flashes)<sup>[A]</sup> </th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><strong>Family:</strong></td>
<td><strong>Flashes:</strong></td>
<td><strong>#:</strong></td>
</tr>
<tr class="row-odd"><td>Sub-Family 1</td>
<td>One Flash</td>
<td>0x01</td>
</tr>
<tr class="row-even"><td>Sub-Family 2</td>
<td>Two Flashes</td>
<td>0x02</td>
</tr>
<tr class="row-odd"><td>Sub-Family 3</td>
<td>Three Flashes</td>
<td>0x03</td>
</tr>
<tr class="row-even"><td>Sub-Family 4</td>
<td>Four Flashes</td>
<td>0x04</td>
</tr>
<tr class="row-odd"><td>Sub-Family 5</td>
<td>Five Flashes</td>
<td>0x05</td>
</tr>
<tr class="row-even"><td>Sub-Family 6</td>
<td>Six Flashes</td>
<td>0x06</td>
</tr>
<tr class="row-odd"><td>Sub-Family 7</td>
<td>Seven Flashes</td>
<td>0x07</td>
</tr>
</tbody>
</table>
<p><sup>[A]</sup> The flashes is “dark periodes” of the normal Family color.
E.g. Family 1 and Sub-Family 3 is shown as Green with 3 periods of “NO light”.</p>
</div>
<div class="section" id="h-w-network-extended-family">
<span id="ext-fam"></span><h4>3.10.5. H/W NetWork Extended Family<a class="headerlink" href="#h-w-network-extended-family" title="Permalink to this headline">¶</a></h4>
<p>The <a class="reference internal" href="#ext-fam"><span class="std std-ref">H/W NetWork Extended Family</span></a> is encoded in one single byte as:</p>
<p><code class="docutils literal"><span class="pre">s</span></code> = SubFamily<sup>[B]</sup> <code class="docutils literal"><span class="pre">f</span></code> = Family<sup>[B]</sup> <code class="docutils literal"><span class="pre">Bit</span> <span class="pre">7</span></code> is reserved for future use</p>
<p><code class="docutils literal"><span class="pre">Bit</span> <span class="pre">7</span></code> <code class="docutils literal"><span class="pre">sss</span></code> <code class="docutils literal"><span class="pre">ffff</span></code></p>
<table border="1" class="docutils">
<colgroup>
<col width="50%" />
<col width="50%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head" colspan="2">Examples:</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><code class="docutils literal"><span class="pre">0</span></code> <code class="docutils literal"><span class="pre">001</span></code> <code class="docutils literal"><span class="pre">0001</span></code></td>
<td>Family 1, Sub-Family 1</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal"><span class="pre">0</span></code> <code class="docutils literal"><span class="pre">001</span></code> <code class="docutils literal"><span class="pre">0010</span></code></td>
<td>Family 2, Sub-Family 1</td>
</tr>
<tr class="row-even"><td>—</td>
<td>—</td>
</tr>
<tr class="row-odd"><td>—</td>
<td>—</td>
</tr>
<tr class="row-even"><td><code class="docutils literal"><span class="pre">0</span></code> <code class="docutils literal"><span class="pre">011</span></code> <code class="docutils literal"><span class="pre">0101</span></code></td>
<td>Family 5, Sub-Family 3</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal"><span class="pre">0</span></code> <code class="docutils literal"><span class="pre">111</span></code> <code class="docutils literal"><span class="pre">1000</span></code></td>
<td>Family 8, Sub-Family 7</td>
</tr>
</tbody>
</table>
<p><sup>[B]</sup> Family 0 (zero) and Sub-Family 0 (zero) NOT used.</p>
</div>
</div>
<div class="section" id="f-w-update-go-into-boot-mode">
<span id="id7"></span><h3>3.11. F/W Update - Go Into Boot Mode<a class="headerlink" href="#f-w-update-go-into-boot-mode" title="Permalink to this headline">¶</a></h3>
<table border="1" class="docutils">
<colgroup>
<col width="22%" />
<col width="78%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head" colspan="2">Message Type - Go Into Boot Mode [0x10]</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><p class="first"><strong>Communication:</strong></p>
<p><strong>Size:</strong></p>
<p class="last"><strong>Description:</strong></p>
</td>
<td><p class="first">Downstream</p>
<p>12 Bytes</p>
<p class="last">This is the FirmWare update message a.k.a. Go Into Boot Mode. Since this a serious
command a safety check string is added. The command will trigger a message on the Hub
Actions Notification (0x02).</p>
</td>
</tr>
</tbody>
</table>
<div class="section" id="go-into-boot-mode-message-format">
<h4>3.11.1. Go Into Boot Mode Message Format<a class="headerlink" href="#go-into-boot-mode-message-format" title="Permalink to this headline">¶</a></h4>
<table border="1" class="docutils">
<colgroup>
<col width="15%" />
<col width="56%" />
<col width="11%" />
<col width="10%" />
<col width="7%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head" colspan="5"><strong>Go Into Boot Mode Message Format</strong></th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><strong>Name</strong></td>
<td><strong>Description</strong></td>
<td><strong>Format</strong></td>
<td><strong>Min</strong></td>
<td><strong>Max</strong></td>
</tr>
<tr class="row-odd"><td>Common Header</td>
<td>See <a class="reference internal" href="#common-header-description"><span class="std std-ref">Common Message Header</span></a></td>
<td>N/A</td>
<td>N/A</td>
<td>N/A</td>
</tr>
<tr class="row-even"><td>Safety String</td>
<td><div class="first last line-block">
<div class="line">Safety String[0] = ‘L’</div>
<div class="line">Safety String[1] = ‘P’</div>
<div class="line">Safety String[2] = ‘F’</div>
<div class="line">Safety String[3] = ‘2’</div>
<div class="line">Safety String[4] = ‘-‘</div>
<div class="line">Safety String[5] = ‘B’</div>
<div class="line">Safety String[6] = ‘o’</div>
<div class="line">Safety String[7] = ‘o’</div>
<div class="line">Safety String[8] = ‘t’</div>
</div>
</td>
<td>UInt8[9]</td>
<td>N/A</td>
<td>N/A</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="section" id="f-w-update-lock-memory">
<span id="id8"></span><h3>3.12. F/W Update Lock memory<a class="headerlink" href="#f-w-update-lock-memory" title="Permalink to this headline">¶</a></h3>
<table border="1" class="docutils">
<colgroup>
<col width="22%" />
<col width="78%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head" colspan="2">Message Type - F/W Update Lock Memory [0x11]</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><p class="first"><strong>Communication:</strong></p>
<p><strong>Size:</strong></p>
<p class="last"><strong>Description:</strong></p>
</td>
<td><p class="first">Downstream</p>
<p>11 Bytes</p>
<p class="last">This is the safety memory lock used in the production (NOT for the enduser). The FirmWare
can still be updated, but only via the application itself - NOT via a debugger tool and
alike. The safety string Lock Mem should be applied. The chip resets after this command.</p>
</td>
</tr>
</tbody>
</table>
<div class="section" id="f-w-update-lock-memory-message-format">
<h4>3.12.1. F/W Update Lock Memory Message Format<a class="headerlink" href="#f-w-update-lock-memory-message-format" title="Permalink to this headline">¶</a></h4>
<table border="1" class="docutils">
<colgroup>
<col width="15%" />
<col width="56%" />
<col width="11%" />
<col width="10%" />
<col width="7%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head" colspan="5">F/W Update Lock Memory Message Format</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><strong>Name</strong></td>
<td><strong>Description</strong></td>
<td><strong>Format</strong></td>
<td><strong>Min</strong></td>
<td><strong>Max</strong></td>
</tr>
<tr class="row-odd"><td>Common Header</td>
<td>See <a class="reference internal" href="#common-header-description"><span class="std std-ref">Common Message Header</span></a></td>
<td>N/A</td>
<td>N/A</td>
<td>N/A</td>
</tr>
<tr class="row-even"><td>Safety String</td>
<td><div class="first last line-block">
<div class="line">Safety String[0] = ‘L’</div>
<div class="line">Safety String[1] = ‘o’</div>
<div class="line">Safety String[2] = ‘c’</div>
<div class="line">Safety String[3] = ‘k’</div>
<div class="line">Safety String[4] = ‘-‘</div>
<div class="line">Safety String[5] = ‘M’</div>
<div class="line">Safety String[6] = ‘e’</div>
<div class="line">Safety String[7] = ‘m’</div>
</div>
</td>
<td>Uint8[8]</td>
<td>N/A</td>
<td>N/A</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="section" id="f-w-update-lock-status-request">
<span id="f-w-lock-status-request"></span><h3>3.13. F/W Update Lock Status Request<a class="headerlink" href="#f-w-update-lock-status-request" title="Permalink to this headline">¶</a></h3>
<table border="1" class="docutils">
<colgroup>
<col width="22%" />
<col width="78%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head" colspan="2">Message Type - F/W Update Lock Status Request [0x12]</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><p class="first"><strong>Communication:</strong></p>
<p><strong>Size:</strong></p>
<p class="last"><strong>Description:</strong></p>
</td>
<td><p class="first">Downstream</p>
<p>3 Bytes (NO payload - ONLY Header)</p>
<p class="last">Checking the Memory Locking state at the BOOT-loader memory area. Used in the production
(NOT for the enduser). Triggers an answer on F/W Lock Status [0x13]</p>
</td>
</tr>
</tbody>
</table>
<div class="section" id="f-w-update-lock-status-request-message-format">
<h4>3.13.1. F/W Update Lock Status Request Message Format<a class="headerlink" href="#f-w-update-lock-status-request-message-format" title="Permalink to this headline">¶</a></h4>
<table border="1" class="docutils">
<colgroup>
<col width="15%" />
<col width="56%" />
<col width="11%" />
<col width="10%" />
<col width="7%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head" colspan="5">F/W Update Lock Status Request Message Format</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><strong>Name</strong></td>
<td><strong>Description</strong></td>
<td><strong>Format</strong></td>
<td><strong>Min</strong></td>
<td><strong>Max</strong></td>
</tr>
<tr class="row-odd"><td>Common Header</td>
<td>See <a class="reference internal" href="#common-header-description"><span class="std std-ref">Common Message Header</span></a></td>
<td>N/A</td>
<td>N/A</td>
<td>N/A</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="section" id="f-w-lock-status">
<span id="id9"></span><h3>3.14. F/W Lock Status<a class="headerlink" href="#f-w-lock-status" title="Permalink to this headline">¶</a></h3>
<table border="1" class="docutils">
<colgroup>
<col width="22%" />
<col width="78%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head" colspan="2">Message Type - F/W Update Lock Status [0x13]</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><p class="first"><strong>Communication:</strong></p>
<p><strong>Size:</strong></p>
<p class="last"><strong>Description:</strong></p>
</td>
<td><p class="first">Upstream</p>
<p>4 Bytes</p>
<p class="last">Answer to the F/W Update Lock Status Request [0x12]</p>
</td>
</tr>
</tbody>
</table>
<div class="section" id="f-w-update-lock-status-message-format">
<h4>3.14.1. F/W Update Lock Status Message Format<a class="headerlink" href="#f-w-update-lock-status-message-format" title="Permalink to this headline">¶</a></h4>
<table border="1" class="docutils">
<colgroup>
<col width="15%" />
<col width="56%" />
<col width="11%" />
<col width="10%" />
<col width="7%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head" colspan="5">F/W Update Lock Status Message Format</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><strong>Name</strong></td>
<td><strong>Description</strong></td>
<td><strong>Format</strong></td>
<td><strong>Min</strong></td>
<td><strong>Max</strong></td>
</tr>
<tr class="row-odd"><td>Common Header</td>
<td>See <a class="reference internal" href="#common-header-description"><span class="std std-ref">Common Message Header</span></a></td>
<td>N/A</td>
<td>N/A</td>
<td>N/A</td>
</tr>
<tr class="row-even"><td>Lock Status</td>
<td><div class="first last line-block">
<div class="line">Actual Memory Locking Status</div>
<div class="line">0x00 :  Lock Status == OK</div>
<div class="line">0xFF :  Lock Status == NOT LOCKED</div>
</div>
</td>
<td>Uint8</td>
<td>0x00</td>
<td>0xFF</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="section" id="port-information-request">
<span id="id10"></span><h3>3.15. Port Information Request<a class="headerlink" href="#port-information-request" title="Permalink to this headline">¶</a></h3>
<table border="1" class="docutils">
<colgroup>
<col width="22%" />
<col width="78%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head" colspan="2">Message Type - Port Information Request [0x21]</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><p class="first"><strong>Communication:</strong></p>
<p><strong>Size:</strong></p>
<p><strong>Purpose:</strong></p>
<p class="last"><strong>Triggers Reply</strong></p>
</td>
<td><p class="first">Downstream</p>
<p>5 Bytes</p>
<p>Request Port Info and Value.</p>
<p>The reply is dependent of the <a class="reference internal" href="#inf-typ"><span class="std std-ref">Information Type</span></a>.</p>
<div class="last line-block">
<div class="line"><a class="reference internal" href="#inf-typ"><span class="std std-ref">Information Type</span></a></div>
<div class="line">0x00 ==&gt; 0x45 Port Value (Standard Ports)</div>
<div class="line">0x00 ==&gt; 0x46 Port Value (Combined Mode Ports)</div>
<div class="line"><br /></div>
<div class="line">0x01 ==&gt; 0x43 Port Information (Common For All Ports)</div>
<div class="line">0x02 ==&gt; 0x43 Port Information (Common For All Ports)</div>
</div>
</td>
</tr>
</tbody>
</table>
<div class="section" id="port-information-request-format">
<h4>3.15.1. Port Information Request Format<a class="headerlink" href="#port-information-request-format" title="Permalink to this headline">¶</a></h4>
<table border="1" class="docutils">
<colgroup>
<col width="15%" />
<col width="56%" />
<col width="11%" />
<col width="9%" />
<col width="8%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head" colspan="5">Port Information Request Message Format</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><strong>Name</strong></td>
<td><strong>Description</strong></td>
<td><strong>Format</strong></td>
<td><strong>Min</strong></td>
<td><strong>Max</strong></td>
</tr>
<tr class="row-odd"><td>Common Header</td>
<td>See <a class="reference internal" href="#common-header-description"><span class="std std-ref">Common Message Header</span></a></td>
<td>N/A</td>
<td>N/A</td>
<td>N/A</td>
</tr>
<tr class="row-even"><td>Port ID</td>
<td>The Port ID associated with the Attached I/O assigned by the Hub</td>
<td>Uint8</td>
<td>0x00</td>
<td><a class="reference internal" href="#p-id"><span class="std std-ref">Port ID</span></a></td>
</tr>
<tr class="row-odd"><td>Information Type</td>
<td>Identifies the Requested <a class="reference internal" href="#inf-typ"><span class="std std-ref">Information Type</span></a>.</td>
<td>Uint8</td>
<td>0x00</td>
<td>0x02</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="information-type">
<span id="inf-typ"></span><h4>3.15.2. Information Type<a class="headerlink" href="#information-type" title="Permalink to this headline">¶</a></h4>
<table border="1" class="docutils">
<colgroup>
<col width="23%" />
<col width="77%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head" colspan="2">Information Type</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><strong>Information Type</strong></td>
<td><strong>Description</strong></td>
</tr>
<tr class="row-odd"><td>0x00</td>
<td>Port Value</td>
</tr>
<tr class="row-even"><td>0x01</td>
<td>Mode Info</td>
</tr>
<tr class="row-odd"><td>0x02</td>
<td><div class="first last line-block">
<div class="line">Possible Mode Combinations.</div>
<div class="line">Should only be used if the “Logical Combinable”-bit is set in the</div>
<div class="line">(MODE INFO Capabilities byte). I.e. in the Port Information 0x43</div>
</div>
</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="section" id="port-mode-information-request">
<span id="id11"></span><h3>3.16. Port Mode Information Request<a class="headerlink" href="#port-mode-information-request" title="Permalink to this headline">¶</a></h3>
<table border="1" class="docutils">
<colgroup>
<col width="22%" />
<col width="78%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head" colspan="2">Message Type - Port Mode Information Request [0x22]</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><p class="first"><strong>Communication:</strong></p>
<p><strong>Size:</strong></p>
<p><strong>Purpose:</strong></p>
<p class="last"><strong>Triggers Reply</strong></p>
</td>
<td><p class="first">Downstream</p>
<p>6 Bytes</p>
<p>Request information about the different modes of the LPF2 Device connected to the port.</p>
<p class="last">Triggers a reply on Port Mode Information [0x44]. The reply is dependent of the requested
<a class="reference internal" href="#mod-ityp"><span class="std std-ref">Mode Information Types</span></a>.</p>
</td>
</tr>
</tbody>
</table>
<div class="section" id="port-mode-information-request-format">
<h4>3.16.1. Port Mode Information Request Format<a class="headerlink" href="#port-mode-information-request-format" title="Permalink to this headline">¶</a></h4>
<table border="1" class="docutils">
<colgroup>
<col width="15%" />
<col width="56%" />
<col width="11%" />
<col width="9%" />
<col width="8%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head" colspan="5">Port Mode Information Request Format</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><strong>Name</strong></td>
<td><strong>Description</strong></td>
<td><strong>Format</strong></td>
<td><strong>Min</strong></td>
<td><strong>Max</strong></td>
</tr>
<tr class="row-odd"><td>Common Header</td>
<td>See <a class="reference internal" href="#common-header-description"><span class="std std-ref">Common Message Header</span></a></td>
<td>N/A</td>
<td>N/A</td>
<td>N/A</td>
</tr>
<tr class="row-even"><td>Port ID</td>
<td>The Port ID associated with the Attached I/O assigned by the Hub</td>
<td>Uint8</td>
<td>0</td>
<td><a class="reference internal" href="#p-id"><span class="std std-ref">Port ID</span></a></td>
</tr>
<tr class="row-odd"><td>Mode</td>
<td>The Mode to get information for</td>
<td>Uint8</td>
<td>0</td>
<td>N/A</td>
</tr>
<tr class="row-even"><td>Information Type</td>
<td>Identifies the <a class="reference internal" href="#mod-ityp"><span class="std std-ref">Mode Information Types</span></a></td>
<td>Uint8</td>
<td>0</td>
<td>128</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="mode-information-types">
<span id="mod-ityp"></span><h4>3.16.2. Mode Information Types<a class="headerlink" href="#mode-information-types" title="Permalink to this headline">¶</a></h4>
<table border="1" class="docutils">
<colgroup>
<col width="26%" />
<col width="21%" />
<col width="53%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head" colspan="3">Mode Information Type</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><strong>Mode Information No</strong></td>
<td><strong>Info Short Name</strong></td>
<td>Description**</td>
</tr>
<tr class="row-odd"><td>0x00</td>
<td>NAME</td>
<td>Name of the mode</td>
</tr>
<tr class="row-even"><td>0x01</td>
<td>RAW</td>
<td>The raw range</td>
</tr>
<tr class="row-odd"><td>0x02</td>
<td>PCT</td>
<td>The percent range</td>
</tr>
<tr class="row-even"><td>0x03</td>
<td>SI</td>
<td>The SI value range</td>
</tr>
<tr class="row-odd"><td>0x04</td>
<td>SYMBOL</td>
<td>The standard name of value</td>
</tr>
<tr class="row-even"><td>0x05</td>
<td>MAPPING</td>
<td>&#160;</td>
</tr>
<tr class="row-odd"><td>0x06</td>
<td><ul class="first last simple">
<li></li>
</ul>
</td>
<td>Used internally</td>
</tr>
<tr class="row-even"><td>0x07</td>
<td><ul class="first last simple">
<li></li>
</ul>
</td>
<td>Motor Bias (0-100%)</td>
</tr>
<tr class="row-odd"><td>0x08</td>
<td><ul class="first last simple">
<li></li>
</ul>
</td>
<td>Capability bits (6 bytes total)</td>
</tr>
<tr class="row-even"><td>0x80</td>
<td>VALUE FORMAT</td>
<td>Value encoding</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="section" id="port-input-format-setup-single">
<span id="id12"></span><h3>3.17. Port Input Format Setup (Single)<a class="headerlink" href="#port-input-format-setup-single" title="Permalink to this headline">¶</a></h3>
<table border="1" class="docutils">
<colgroup>
<col width="22%" />
<col width="78%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head" colspan="2">Message Type - Port Input Format Setup (Single) [0x41]</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><p class="first"><strong>Communication:</strong></p>
<p><strong>Size:</strong></p>
<p><strong>Purpose:</strong></p>
<p class="last"><strong>Triggers Reply:</strong></p>
</td>
<td><p class="first">Downstream</p>
<p>10 Bytes</p>
<p>Setup the mode of operation for the LPF2 Device connected to the addressed Port.</p>
<p class="last">Triggers a reply on Port Input Format [0x47].</p>
</td>
</tr>
</tbody>
</table>
<div class="section" id="format-of-port-input-format-setup-single">
<h4>3.17.1. Format of Port Input Format Setup (Single)<a class="headerlink" href="#format-of-port-input-format-setup-single" title="Permalink to this headline">¶</a></h4>
<table border="1" class="docutils">
<colgroup>
<col width="15%" />
<col width="56%" />
<col width="11%" />
<col width="9%" />
<col width="8%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head" colspan="5">Format of Port Input Format Setup (Single)</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><strong>Name</strong></td>
<td><strong>Description</strong></td>
<td><strong>Format</strong></td>
<td><strong>Min</strong></td>
<td><strong>Max</strong></td>
</tr>
<tr class="row-odd"><td>Common Header</td>
<td>See <a class="reference internal" href="#common-header-description"><span class="std std-ref">Common Message Header</span></a></td>
<td>N/A</td>
<td>N/A</td>
<td>N/A</td>
</tr>
<tr class="row-even"><td>Port ID</td>
<td>The Port ID associated with the Attached I/O assigned by the Hub</td>
<td>Uint8</td>
<td>0</td>
<td><a class="reference internal" href="#p-id"><span class="std std-ref">Port ID</span></a></td>
</tr>
<tr class="row-odd"><td>Mode</td>
<td>The Mode to get information for</td>
<td>Uint8</td>
<td>0</td>
<td>N/A</td>
</tr>
<tr class="row-even"><td>Delta Interval</td>
<td><p class="first">The changes in the delta value to trigger a value update.
If set to 0 (zero) data will be send as fast as possible (live data)
should NOT be use due to the limited Bluetooth LE bandwidth.</p>
<p class="last"><strong>Remark:</strong> If a sensor is used in combined mode,
the Delta Interval should be set for each of the combined modes.
E.g. A sensor set to both give discrete color values (0-6) and RAW data, should NOT have the
Delta Interval for the RAW data set to ‘1’. The RAW data would trigger a lot of updates and hence
flood fill the BLE radio link.</p>
</td>
<td>Uint32</td>
<td>0</td>
<td>N/A</td>
</tr>
<tr class="row-odd"><td>Notification Enabled</td>
<td><p class="first">Enabling notification of value changes. If NOT enabled the input value(s) can only be
read by Port Information 0x21 property 000.</p>
<blockquote class="last">
<div><div class="line-block">
<div class="line">0 = Disabled</div>
<div class="line">1 = Enabled</div>
</div>
</div></blockquote>
</td>
<td>Uint8</td>
<td>0</td>
<td>1</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="section" id="port-input-format-setup-combinedmode">
<span id="id13"></span><h3>3.18. Port Input Format Setup (CombinedMode)<a class="headerlink" href="#port-input-format-setup-combinedmode" title="Permalink to this headline">¶</a></h3>
<table border="1" class="docutils">
<colgroup>
<col width="22%" />
<col width="78%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head" colspan="2">Message Type - Port Input Format Setup (CombinedMode) [0x42]</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><strong>Communication:</strong></td>
<td>Downstream</td>
</tr>
<tr class="row-odd"><td><strong>Size:</strong></td>
<td><div class="first last line-block">
<div class="line">7 Bytes - SubCommand 0x01</div>
<div class="line">5 Bytes - All other SubCommands (I.e. != 0x01)</div>
</div>
</td>
</tr>
<tr class="row-even"><td><strong>Purpose:</strong></td>
<td><p class="first">This command is used to setup a sensor which can be used with more combinations of Mode
and DataSets (CombinedMode). I.e. by setting a sensor in Combined Mode, the user can have
data of different formats from a sensor in one and only transmission.The count of and the
possible combinations are retrieved from the Port Information Request [21] with the sub
command 0x02: <a class="reference internal" href="#pos-m"><span class="std std-ref">POSSIBLE MODE COMBINATIONS</span></a>.</p>
<p>If the Combination 0 multi update is enabled, an update (delta interval reached) from the
Mode/Dataset[0] will automatically contain a total update of all the Mode/Data-sets setup
in the Combined Mode setup session.</p>
<p>To setup of a Combined Sensor the user has to follow the following steps:</p>
<ol class="last arabic simple">
<li>Lock LPF2 Device for setup (allowing multiple setup of modes without actually
changing the mode).</li>
<li>Setup all the individual modes i.e. more 0x41 setup commands - each setup will result
in a individual Port Input Format (Single) (0x47) handshake packet.</li>
<li>The setup of the ModeAndDataSet combinations should be done in a prioritized order -
if the Combination 0 multi update is wanted, the Mode and Dataset for the very first
setup (Mode/Dataset[0]) should be carefully selected. Changes to this dataset will
become a sort of a common update all event. The setup order is also the order of the
Mode/DataSet bit-pointers used to address the data-values in the Value (CombinedMode)
(0x46)  First Dataset setup equals Bit-pointer 0 (zero), second Dataset setup equals
Bit-pointer 1 etc.</li>
<li>UnlockAndStart the LPF2 device with or without the Enable Combination 0 multi update -
i.e. subcommand 0x03 or 0x04.</li>
</ol>
</td>
</tr>
<tr class="row-odd"><td><strong>Triggers Reply</strong></td>
<td>Triggers a reply on Port Input Format [0x48].</td>
</tr>
</tbody>
</table>
<div class="section" id="format-of-port-input-format-setup-combinedmode">
<h4>3.18.1. Format of Port Input Format Setup (CombinedMode)<a class="headerlink" href="#format-of-port-input-format-setup-combinedmode" title="Permalink to this headline">¶</a></h4>
<table border="1" class="docutils">
<colgroup>
<col width="15%" />
<col width="56%" />
<col width="11%" />
<col width="10%" />
<col width="7%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head" colspan="5">Format of Port Input Format Setup (CombinedMode)</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><strong>Name</strong></td>
<td><strong>Description</strong></td>
<td><strong>Format</strong></td>
<td><strong>Min</strong></td>
<td><strong>Max</strong></td>
</tr>
<tr class="row-odd"><td>Common Header</td>
<td>See <a class="reference internal" href="#common-header-description"><span class="std std-ref">Common Message Header</span></a></td>
<td>N/A</td>
<td>N/A</td>
<td>N/A</td>
</tr>
<tr class="row-even"><td>Port ID</td>
<td>The unique Port ID for this combined sensor</td>
<td>Uint8</td>
<td>0</td>
<td><a class="reference internal" href="#p-id"><span class="std std-ref">Port ID</span></a></td>
</tr>
<tr class="row-odd"><td>Sub Command</td>
<td><a class="reference internal" href="#comb-sub-cmd"><span class="std std-ref">Port Input Format Setup (Sub-) Commands</span></a></td>
<td>Uint8</td>
<td>0</td>
<td>6</td>
</tr>
<tr class="row-even"><td colspan="5"><strong>Sub Command = 0x01 SetModeDataSet combination(s)</strong></td>
</tr>
<tr class="row-odd"><td>Combination Index</td>
<td>Combination index from the LPF2 device Port Information Request sub command 0x03:
<a class="reference internal" href="#pos-m"><span class="std std-ref">POSSIBLE MODE COMBINATIONS</span></a> [Combination index]. The H/W will use this information to setup the right mode of
operation. The Mode/Dataset combinations cannot give this information - the user can choose a subset
of the possible Mode/Dataset combinations and hence a given combination is not explicit!</td>
<td>Uint8</td>
<td>0</td>
<td>7</td>
</tr>
<tr class="row-even"><td>Mode/DataSet[0]</td>
<td><table border="1" class="first docutils">
<colgroup>
<col width="36%" />
<col width="64%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>Mode</td>
<td>DataSet</td>
</tr>
<tr class="row-even"><td>MMMM</td>
<td>DDDD</td>
</tr>
</tbody>
</table>
<p class="last">If the combined sensor is unlocked with the command UnlockAndStartWithMultiUpdate Enabled,
the value updates of Mode/DataSet[0] will trigger a total update of all the chosen combinations
of the Combined Sensor (Master update).</p>
</td>
<td>Uint8</td>
<td>N/A</td>
<td>N/A</td>
</tr>
<tr class="row-odd"><td>Mode/DataSet[1]</td>
<td><table border="1" class="first last docutils">
<colgroup>
<col width="36%" />
<col width="64%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>Mode</td>
<td>DataSet</td>
</tr>
<tr class="row-even"><td>MMMM</td>
<td>DDDD</td>
</tr>
</tbody>
</table>
</td>
<td>Uint8</td>
<td>N/A</td>
<td>N/A</td>
</tr>
<tr class="row-odd"><td>Mode/DataSet[n]</td>
<td><table border="1" class="first last docutils">
<colgroup>
<col width="36%" />
<col width="64%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>Mode</td>
<td>DataSet</td>
</tr>
<tr class="row-even"><td>MMMM</td>
<td>DDDD</td>
</tr>
</tbody>
</table>
</td>
<td>Uint8</td>
<td>N/A</td>
<td>N/A</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="port-input-format-setup-sub-commands">
<span id="comb-sub-cmd"></span><h4>3.18.2. Port Input Format Setup (Sub-) Commands<a class="headerlink" href="#port-input-format-setup-sub-commands" title="Permalink to this headline">¶</a></h4>
<table border="1" class="docutils">
<colgroup>
<col width="37%" />
<col width="63%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head" colspan="2"><a class="reference internal" href="#comb-sub-cmd"><span class="std std-ref">Port Input Format Setup (Sub-) Commands</span></a></th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><strong>Sub-Command:</strong></td>
<td><strong>**Description</strong></td>
</tr>
<tr class="row-odd"><td>0x01</td>
<td>Set ModeAndDataSet combination(s)</td>
</tr>
<tr class="row-even"><td>0x02</td>
<td>Lock LPF2 Device for setup</td>
</tr>
<tr class="row-odd"><td>0x03</td>
<td>UnlockAndStartWithMultiUpdateEnabled</td>
</tr>
<tr class="row-even"><td>0x04</td>
<td>UnlockAndStartWithMultiUpdateDisabled</td>
</tr>
<tr class="row-odd"><td>0x05</td>
<td>NOT USED</td>
</tr>
<tr class="row-even"><td>0x06</td>
<td>Reset Sensor <sup>[X]</sup> </td>
</tr>
</tbody>
</table>
<p><sup>[X]</sup> Reset the sensor to the legacy mode 0 (zero)</p>
</div>
<div class="section" id="possible-mode-combinations">
<span id="pos-m"></span><h4>3.18.3. POSSIBLE MODE COMBINATIONS<a class="headerlink" href="#possible-mode-combinations" title="Permalink to this headline">¶</a></h4>
<p>The possible mode combinations are stored as a one-dimensional array of maximum 8 UInt16.
I.e. A list showing a maximum of 8 different combinations each of max. 16 modes.</p>
<table border="1" class="docutils">
<colgroup>
<col width="23%" />
<col width="16%" />
<col width="29%" />
<col width="32%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head" colspan="4"><a class="reference internal" href="#pos-m"><span class="std std-ref">POSSIBLE MODE COMBINATIONS</span></a></th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><strong>Combination Index:</strong></td>
<td colspan="2"><strong>Modes:</strong></td>
<td><strong>Valid Combination Examples</strong></td>
</tr>
<tr class="row-odd"><td>Index 0</td>
<td colspan="2">0 0 0 0 0 0 0 0 0 0 0 <strong>1</strong> 0 <strong>1</strong> <strong>1</strong> 0</td>
<td>Mode 1 + Mode 2 + Mode 4</td>
</tr>
<tr class="row-even"><td>Index 1</td>
<td colspan="2">0 0 0 0 0 0 0 0 0 0 0 0 0 0 <strong>1</strong> <strong>1</strong></td>
<td>Mode 0 + Mode 1</td>
</tr>
<tr class="row-odd"><td>Index 2</td>
<td colspan="2">0 0 0 0 0 0 0 0 0 0 0 0 <strong>1</strong> 0 0 <strong>1</strong></td>
<td>Mode 0 + Mode 3</td>
</tr>
<tr class="row-even"><td>Index 3</td>
<td colspan="2">0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0</td>
<td><strong>“End-of-combinations”</strong></td>
</tr>
<tr class="row-odd"><td>Index 4</td>
<td colspan="2">0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0</td>
<td>&#160;</td>
</tr>
<tr class="row-even"><td>Index 5</td>
<td colspan="2">0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0</td>
<td>&#160;</td>
</tr>
<tr class="row-odd"><td>Index 6</td>
<td colspan="2">0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0</td>
<td>&#160;</td>
</tr>
<tr class="row-even"><td>Index 7</td>
<td colspan="2">0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0</td>
<td>&#160;</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="section" id="port-information">
<span id="id14"></span><h3>3.19. Port Information<a class="headerlink" href="#port-information" title="Permalink to this headline">¶</a></h3>
<table border="1" class="docutils">
<colgroup>
<col width="22%" />
<col width="78%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head" colspan="2">Message Type - Port Information [0x43]</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><p class="first"><strong>Communication:</strong></p>
<p><strong>Size:</strong></p>
<p><strong>Purpose:</strong></p>
<p class="last"><strong>Replies:</strong></p>
</td>
<td><p class="first">Upstream</p>
<div class="line-block">
<div class="line">Information Type 0x01 : 11 Bytes</div>
<div class="line">Information Type 0x02 :  7 Bytes (1 combination) up to 21 Bytes (8 combinations).</div>
</div>
<p>Returns the specified information about the LPF2 Device connected to the Port.</p>
<p class="last">Port Information Request [0x21] (Information Type: 0x01-0x02).</p>
</td>
</tr>
</tbody>
</table>
<div class="section" id="port-information-format">
<h4>3.19.1. Port Information Format<a class="headerlink" href="#port-information-format" title="Permalink to this headline">¶</a></h4>
<table border="1" class="docutils">
<colgroup>
<col width="15%" />
<col width="56%" />
<col width="11%" />
<col width="10%" />
<col width="7%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head" colspan="5">Port Information Format</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><strong>Name</strong></td>
<td><strong>Description</strong></td>
<td><strong>Format</strong></td>
<td><strong>Min</strong></td>
<td><strong>Max</strong></td>
</tr>
<tr class="row-odd"><td>Common Header</td>
<td>See <a class="reference internal" href="#common-header-description"><span class="std std-ref">Common Message Header</span></a></td>
<td>N/A</td>
<td>N/A</td>
<td>N/A</td>
</tr>
<tr class="row-even"><td>Port ID</td>
<td>The Port ID associated with the Attached I/O assigned by the Hub</td>
<td>Uint8</td>
<td>0</td>
<td><a class="reference internal" href="#p-id"><span class="std std-ref">Port ID</span></a></td>
</tr>
<tr class="row-odd"><td>Information type</td>
<td><p class="first">Identifies the Information Type:</p>
<table border="1" class="last docutils">
<colgroup>
<col width="13%" />
<col width="87%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>0x01</td>
<td>MODE INFO</td>
</tr>
<tr class="row-even"><td>0x02</td>
<td>POSSIBLE MODE COMBINATIONS</td>
</tr>
</tbody>
</table>
</td>
<td>Uint8</td>
<td>0x01</td>
<td>0x02</td>
</tr>
<tr class="row-odd"><td colspan="5"><strong>Information Type == MODE INFO (001)</strong></td>
</tr>
<tr class="row-even"><td>Capabilities</td>
<td><table border="1" class="first last docutils">
<colgroup>
<col width="25%" />
<col width="75%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>Bit 4..7</td>
<td>N/A</td>
</tr>
<tr class="row-even"><td>Bit 3</td>
<td>Logical Synchronizable</td>
</tr>
<tr class="row-odd"><td>Bit 2</td>
<td>Logical Combinable</td>
</tr>
<tr class="row-even"><td>Bit 1</td>
<td>Input (seen from Hub)</td>
</tr>
<tr class="row-odd"><td>Bit 0</td>
<td>Output (seen from Hub)</td>
</tr>
</tbody>
</table>
</td>
<td>Uint8</td>
<td>0x00</td>
<td>0x0F</td>
</tr>
<tr class="row-even"><td>Total Mode Count</td>
<td>Total number of port modes</td>
<td>Uint8</td>
<td>0</td>
<td>255</td>
</tr>
<tr class="row-odd"><td>Input Modes</td>
<td><p class="first">Available Input Port Modes (bitmask)</p>
<table border="1" class="last docutils">
<colgroup>
<col width="46%" />
<col width="54%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>Bit 15</td>
<td>Mode 15</td>
</tr>
<tr class="row-even"><td>…</td>
<td>…</td>
</tr>
<tr class="row-odd"><td>Bit 0</td>
<td>Mode 0</td>
</tr>
</tbody>
</table>
</td>
<td>Uint16</td>
<td>0</td>
<td>65535</td>
</tr>
<tr class="row-even"><td>Output Modes</td>
<td><p class="first">Available Output Port Modes (bitmask)</p>
<table border="1" class="last docutils">
<colgroup>
<col width="46%" />
<col width="54%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>Bit 15</td>
<td>Mode 15</td>
</tr>
<tr class="row-even"><td>…</td>
<td>…</td>
</tr>
<tr class="row-odd"><td>Bit 0</td>
<td>Mode 0</td>
</tr>
</tbody>
</table>
</td>
<td>Uint16</td>
<td>0</td>
<td>65535</td>
</tr>
<tr class="row-even"><td colspan="5"><strong>Information Type == POSSIBLE MODE COMBINATIONS (002)</strong></td>
</tr>
<tr class="row-odd"><td>Mode Combinations</td>
<td><p class="first">Up to 8 times UWORD bit-fields showing the possible mode/value-sets combinations for a given sensor.
Some combinations cannot be used due to the need for different H/W setup
(mode affects each others, H/W switch- and settling time etc.)<sup>[Y]</sup> </p>
<p class="last">See also <a class="reference internal" href="#pos-m"><span class="std std-ref">POSSIBLE MODE COMBINATIONS</span></a> for more information and an example.</p>
</td>
<td>Uint8</td>
<td>0</td>
<td>15</td>
</tr>
</tbody>
</table>
<p><sup>[Y]</sup> Mode combinations <strong>NOT</strong> possible are discarded by the sensor.</p>
</div>
</div>
<div class="section" id="port-mode-information">
<span id="id15"></span><h3>3.20. Port Mode Information<a class="headerlink" href="#port-mode-information" title="Permalink to this headline">¶</a></h3>
<table border="1" class="docutils">
<colgroup>
<col width="22%" />
<col width="78%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head" colspan="2">Message Type - Port Mode Information [0x44]</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><p class="first"><strong>Communication:</strong></p>
<p><strong>Size:</strong></p>
<p><strong>Purpose:</strong></p>
<p class="last"><strong>Replies:</strong></p>
</td>
<td><p class="first">Upstream</p>
<div class="line-block">
<div class="line">Information Type 0x00 : 17 Bytes</div>
<div class="line">Information Type 0x01 : 14 Bytes</div>
<div class="line">Information Type 0x02 : 14 Bytes</div>
<div class="line">Information Type 0x03 : 14 Bytes</div>
<div class="line">Information Type 0x04 : 11 Bytes</div>
<div class="line">Information Type 0x05 :  8 Bytes</div>
<div class="line">Information Type 0x06 : -</div>
<div class="line">Information Type 0x07 :  7 Bytes</div>
<div class="line">Information Type 0x08 : 12 Bytes</div>
<div class="line">-</div>
<div class="line">Information Type 0x80 : 10 Bytes</div>
</div>
<p>Returns specified <a class="reference internal" href="#mod-ityp"><span class="std std-ref">Mode Information Types</span></a> about the LPF2 device connected to the Port.</p>
<p class="last">Port Mode Information [0x22] (Information Type: 0x00-0x80).</p>
</td>
</tr>
</tbody>
</table>
<div class="section" id="port-mode-information-format">
<h4>3.20.1. Port Mode Information Format<a class="headerlink" href="#port-mode-information-format" title="Permalink to this headline">¶</a></h4>
<table border="1" class="docutils">
<colgroup>
<col width="15%" />
<col width="56%" />
<col width="11%" />
<col width="10%" />
<col width="7%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head" colspan="5">Port Mode Information Format</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><strong>Name</strong></td>
<td><strong>Description</strong></td>
<td><strong>Format</strong></td>
<td><strong>Min</strong></td>
<td><strong>Max</strong></td>
</tr>
<tr class="row-odd"><td>Common Header</td>
<td>See <a class="reference internal" href="#common-header-description"><span class="std std-ref">Common Message Header</span></a></td>
<td>N/A</td>
<td>N/A</td>
<td>N/A</td>
</tr>
<tr class="row-even"><td>Port ID</td>
<td>The Port ID associated with the Attached I/O assigned by the Hub</td>
<td>Uint8</td>
<td>0</td>
<td><a class="reference internal" href="#p-id"><span class="std std-ref">Port ID</span></a></td>
</tr>
<tr class="row-odd"><td>Mode</td>
<td>The mode of the Input. Possible values and interpretation depends on the specific Input Type.</td>
<td>Uint8</td>
<td>N/A</td>
<td>N/A</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#mod-ityp"><span class="std std-ref">Mode Information Types</span></a></td>
<td>Identifies the Information Type</td>
<td>Uint8</td>
<td>0</td>
<td>0x80</td>
</tr>
<tr class="row-odd"><td colspan="5"><strong>Information Type == NAME (000)</strong></td>
</tr>
<tr class="row-even"><td>Name</td>
<td>The maximum length is 11 chars <strong>NOT</strong> ASCIIZ terminated - length is decoded from total packet
length. ONLY ASCII chars: 0x30.. 0x39, 0x41..0x5A, 0x5F and 0x61..0x7A are allowed.</td>
<td>Uint8[0..10]</td>
<td>1</td>
<td>11</td>
</tr>
<tr class="row-odd"><td colspan="5"><strong>Information Type == RAW (001)</strong></td>
</tr>
<tr class="row-even"><td>RAW Range</td>
<td>The range for the raw (transmitted) signal, remember other ranges are used for scaling the value.</td>
<td>RawMin, RawMax [2 *
4 bytes [FLOATING
POINT]]</td>
<td>N/A</td>
<td>N/A</td>
</tr>
<tr class="row-odd"><td colspan="5"><strong>Information Type == PCT (002)</strong></td>
</tr>
<tr class="row-even"><td>PCT Range</td>
<td><div class="first last line-block">
<div class="line">What % window should the RAW values be scaled to.</div>
<div class="line">E.g.</div>
<div class="line">If</div>
<div class="line">RAW == 0-200</div>
<div class="line">PCT == 0-100</div>
<div class="line">Then</div>
<div class="line">100 RAW == 50%.</div>
</div>
</td>
<td>PctMin, PctMax [2 *
4 bytes [FLOATING
POINT]]</td>
<td>N/A</td>
<td>N/A</td>
</tr>
<tr class="row-odd"><td colspan="5"><strong>Information Type == SI (003)</strong></td>
</tr>
<tr class="row-even"><td>SI Range</td>
<td>As above</td>
<td>SiMin, SiMax [2 *
4 bytes [FLOATING
POINT]]</td>
<td>N/A</td>
<td>N/A</td>
</tr>
<tr class="row-odd"><td colspan="5"><strong>Information Type == SYMBOL (004)</strong></td>
</tr>
<tr class="row-even"><td>Symbol</td>
<td>The standard name for a given output. E.g. DEG for degrees. Normally shortened to max. 5 chars.</td>
<td>Uint8[0..4]</td>
<td>1</td>
<td>5</td>
</tr>
<tr class="row-odd"><td colspan="5"><strong>Information Type == MAPPING (005)</strong></td>
</tr>
<tr class="row-even"><td>Mapping</td>
<td><table border="1" class="first docutils">
<colgroup>
<col width="22%" />
<col width="78%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">xxxx xxxx</th>
<th class="head">INPUT SIDE</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>Bit 7</td>
<td>Supports NULL value</td>
</tr>
<tr class="row-odd"><td>Bit 6</td>
<td>Supports Functional Mapping 2.0+</td>
</tr>
<tr class="row-even"><td>Bit 5</td>
<td>N/A</td>
</tr>
<tr class="row-odd"><td>Bit 4</td>
<td>ABS (Absolute [min..max])</td>
</tr>
<tr class="row-even"><td>Bit 3</td>
<td>REL (Relative [-1..1])</td>
</tr>
<tr class="row-odd"><td>Bit 2</td>
<td>DIS (Discrete [0, 1, 2, 3])</td>
</tr>
<tr class="row-even"><td>Bit 1</td>
<td>N/A</td>
</tr>
<tr class="row-odd"><td>Bit 0</td>
<td>N/A</td>
</tr>
</tbody>
</table>
<table border="1" class="docutils">
<colgroup>
<col width="22%" />
<col width="78%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">yyyy yyyy</th>
<th class="head">OUTPUT SIDE</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>Bit 7</td>
<td>Supports NULL value</td>
</tr>
<tr class="row-odd"><td>Bit 6</td>
<td>Supports Functional Mapping 2.0+</td>
</tr>
<tr class="row-even"><td>Bit 5</td>
<td>N/A</td>
</tr>
<tr class="row-odd"><td>Bit 4</td>
<td>ABS (Absolute [min..max])</td>
</tr>
<tr class="row-even"><td>Bit 3</td>
<td>REL (Relative [-1..1])</td>
</tr>
<tr class="row-odd"><td>Bit 2</td>
<td>DIS (Discrete [0, 1, 2, 3])</td>
</tr>
<tr class="row-even"><td>Bit 1</td>
<td>N/A</td>
</tr>
<tr class="row-odd"><td>Bit 0</td>
<td>N/A</td>
</tr>
</tbody>
</table>
<p class="last">The roles are: The host of the sensor (even a simple and dumb black box) can then decide,
what to do with the sensor without any setup (default mode 0 (zero).
Using the LSB first (highest priority).</p>
</td>
<td>Uint16
xxxx xxxx
yyyy yyyy</td>
<td>N/A</td>
<td>N/A</td>
</tr>
<tr class="row-even"><td colspan="5"><strong>Information Type == MOTOR BIAS (007)</strong></td>
</tr>
<tr class="row-odd"><td>Motor Bias</td>
<td>Initial PWM percentage for a given motor to start running (is of course also depending of use case).
0 - 100 %</td>
<td>Uint8</td>
<td>0</td>
<td>100</td>
</tr>
<tr class="row-even"><td colspan="5"><strong>Information Type == CAPABILITY BITS (008)</strong></td>
</tr>
<tr class="row-odd"><td>Capability Bits</td>
<td><p class="first">Sensor capabilities as bits. A total of 48 bits (6 bytes) can be retrieved from a sensor.
For decoding see separate doc. Bytes sent as BIG endianness.</p>
<table border="1" class="last docutils">
<colgroup>
<col width="24%" />
<col width="76%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td rowspan="5">Byte 5</td>
<td>Bit 47 (byte 5 bit 7)</td>
</tr>
<tr class="row-even"><td>Bit 46 (byte 5 bit 6)</td>
</tr>
<tr class="row-odd"><td>&#160;</td>
</tr>
<tr class="row-even"><td>&#160;</td>
</tr>
<tr class="row-odd"><td>Bit 40 (byte 5 bit 0)</td>
</tr>
<tr class="row-even"><td>Byte 4
Byte 3
Byte 2
Byte 1</td>
<td><div class="first last line-block">
<div class="line"><br /></div>
</div>
</td>
</tr>
<tr class="row-odd"><td rowspan="5">Byte 0</td>
<td>Bit 7 (byte 0 bit 7)</td>
</tr>
<tr class="row-even"><td>&#160;</td>
</tr>
<tr class="row-odd"><td>&#160;</td>
</tr>
<tr class="row-even"><td>&#160;</td>
</tr>
<tr class="row-odd"><td>Bit 0 (byte 0 bit 0)</td>
</tr>
</tbody>
</table>
</td>
<td>Uint8[6]</td>
<td>&#160;</td>
<td>&#160;</td>
</tr>
<tr class="row-even"><td colspan="5"><strong>Information Type == VALUE FORMAT (128)</strong></td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#val-fmt"><span class="std std-ref">Value Format</span></a></td>
<td>Returns the <a class="reference internal" href="#val-fmt"><span class="std std-ref">Value Format</span></a>. No of datasets, type and number of digits.</td>
<td>Uint8[4]</td>
<td>N/A</td>
<td>N/A</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="section" id="port-value-single">
<span id="id16"></span><h3>3.21. Port Value (Single)<a class="headerlink" href="#port-value-single" title="Permalink to this headline">¶</a></h3>
<table border="1" class="docutils">
<colgroup>
<col width="22%" />
<col width="78%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head" colspan="2">Message Type - Port Value (Single) [0x45]</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><p class="first"><strong>Communication:</strong></p>
<p><strong>Size:</strong></p>
<p><strong>Purpose:</strong></p>
<p class="last"><strong>Replies:</strong></p>
</td>
<td><p class="first">Upstream</p>
<div class="line-block">
<div class="line">Only one Port Value in each message:</div>
<div class="line">5 Bytes if Port Value = UInt8</div>
<div class="line">6 Bytes if Port Value = UInt16</div>
<div class="line">8 Bytes if Port Value = UInt32 or FLOAT</div>
<div class="line"><br /></div>
<div class="line">Example with more port values in a single message:</div>
<div class="line"><br /></div>
<div class="line">Fixed size + Port Count * (1 + value size)</div>
<div class="line"><br /></div>
<div class="line">E.g. 3 port values - 2 FLOATs and 1 UInt16:</div>
<div class="line"><br /></div>
<div class="line">Header + 2 * (1 + 4) + 1 * (1 + 2) = 16 Bytes</div>
</div>
<p>Updates the host with addressed LPF2 Device data. Multiple data in one transmission
(from more ports), but only from one Hub, the Hub addressed in the Common header.
Size of data and type are interpreted using the Port Format received in the Port Mode
Information 0x44.</p>
<p class="last">0x21 Port Value (Information Type: 0x00) (polled mode)
Value is updated automatically using the notification if enabled.</p>
</td>
</tr>
</tbody>
</table>
<div class="section" id="port-value-single-format">
<h4>3.21.1. Port Value (Single) Format<a class="headerlink" href="#port-value-single-format" title="Permalink to this headline">¶</a></h4>
<table border="1" class="docutils">
<colgroup>
<col width="15%" />
<col width="56%" />
<col width="11%" />
<col width="10%" />
<col width="7%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head" colspan="5">Port Value (Single) Format</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><strong>Name</strong></td>
<td><strong>Description</strong></td>
<td><strong>Format</strong></td>
<td><strong>Min</strong></td>
<td><strong>Max</strong></td>
</tr>
<tr class="row-odd"><td>Common Header</td>
<td>See <a class="reference internal" href="#common-header-description"><span class="std std-ref">Common Message Header</span></a></td>
<td>N/A</td>
<td>N/A</td>
<td>N/A</td>
</tr>
<tr class="row-even"><td colspan="5"><strong>The following repeated for each value in this transmission:</strong></td>
</tr>
<tr class="row-odd"><td>Port ID</td>
<td>The unique Port ID for this sensor</td>
<td>Uint8</td>
<td>0</td>
<td><a class="reference internal" href="#p-id"><span class="std std-ref">Port ID</span></a></td>
</tr>
<tr class="row-even"><td>Input Value</td>
<td>The value of the addressed port</td>
<td>Depending of the
port format</td>
<td>N/A</td>
<td>N/A</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="value-format">
<span id="val-fmt"></span><h4>3.21.2. Value Format<a class="headerlink" href="#value-format" title="Permalink to this headline">¶</a></h4>
<table border="1" class="docutils">
<colgroup>
<col width="30%" />
<col width="15%" />
<col width="56%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head" colspan="3">LPF2 <a class="reference internal" href="#val-fmt"><span class="std std-ref">Value Format</span></a></th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>Byte[0]</td>
<td colspan="2">Number of datasets</td>
</tr>
<tr class="row-odd"><td rowspan="5">Byte[1]</td>
<td colspan="2">Dataset type</td>
</tr>
<tr class="row-even"><td>00</td>
<td>8 bit</td>
</tr>
<tr class="row-odd"><td>01</td>
<td>16 bit</td>
</tr>
<tr class="row-even"><td>10</td>
<td>32 bit</td>
</tr>
<tr class="row-odd"><td>11</td>
<td>FLOAT</td>
</tr>
<tr class="row-even"><td>Byte[2]</td>
<td colspan="2">Total figures</td>
</tr>
<tr class="row-odd"><td>Byte[3]</td>
<td colspan="2">Decimals if any</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="section" id="port-value-combinedmode">
<span id="id17"></span><h3>3.22. Port Value (CombinedMode)<a class="headerlink" href="#port-value-combinedmode" title="Permalink to this headline">¶</a></h3>
<table border="1" class="docutils">
<colgroup>
<col width="22%" />
<col width="78%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head" colspan="2">Message Type - Port Value (Combined) [0x46]</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><p class="first"><strong>Communication:</strong></p>
<p><strong>Size:</strong></p>
<p><strong>Purpose:</strong></p>
<p class="last"><strong>Replies:</strong></p>
</td>
<td><p class="first">Upstream</p>
<p>6 Bytes + the individual size(s) of all the values.</p>
<p>Updates the host with values from a Combined Mode sensor. I.e. a sensor that can deliver
data from different modes in one message.</p>
<p>The updated mode/dataset combination value(s) are addressed by the use of Value bit
pointer(s).</p>
<p>There will only be updated data from inputs opened by the notification enabled command.</p>
<p>Updates can be further controlled using the Enable Combination 0 multi update. When using
a Combined mode sensor, the user can define individual Delta Interval values for all the
combined sensor modes. The first mode/dataset[0] can also be used as a sort of master
updater i.e. when the triggerlevel (Delta Interval) for this Mode/Dataset[0] is reached
it will automatically update all the other enabled Mode/DataSets in one single message.</p>
<p class="last">0x21 Port Value (Information Type: 0x00) (polled mode)
Value is updated automatically using the notification if enabled.</p>
</td>
</tr>
</tbody>
</table>
<div class="section" id="port-value-combined-format">
<h4>3.22.1. Port Value (Combined) Format<a class="headerlink" href="#port-value-combined-format" title="Permalink to this headline">¶</a></h4>
<table border="1" class="docutils">
<colgroup>
<col width="15%" />
<col width="56%" />
<col width="11%" />
<col width="10%" />
<col width="7%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head" colspan="5">Port Value (Combined) Format</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><strong>Name</strong></td>
<td><strong>Description</strong></td>
<td><strong>Format</strong></td>
<td><strong>Min</strong></td>
<td><strong>Max</strong></td>
</tr>
<tr class="row-odd"><td>Common Header</td>
<td>See <a class="reference internal" href="#common-header-description"><span class="std std-ref">Common Message Header</span></a></td>
<td>N/A</td>
<td>N/A</td>
<td>N/A</td>
</tr>
<tr class="row-even"><td>Port ID</td>
<td>The unique Port ID for this sensor</td>
<td>Uint8</td>
<td>0</td>
<td><a class="reference internal" href="#p-id"><span class="std std-ref">Port ID</span></a></td>
</tr>
<tr class="row-odd"><td colspan="5"><strong>The value pointers are used for addressing the changed value(s). Value size should be decoded using the actual format for the Mode/Dataset.</strong></td>
</tr>
<tr class="row-even"><td>Mode/Dataset bit pointers</td>
<td>Pointing to the combination of up to 16 mode/data sets. E.g. 0001 0100b means selected
mode/datasets 2 and 4. Lowest pointer first (val2, val4). The value size is interpreted
by the using the actual Mode/Format setting<sup>[Z]</sup> .</td>
<td>Uint16(binary</td>
<td>0</td>
<td>0xFFFF</td>
</tr>
<tr class="row-odd"><td>Input Value change at
Mode/Dataset[bit-p]</td>
<td>The changed value of the LPF2-Device at PORT ID.
The bit-pointer addresses the next Mode/ dataset changed.</td>
<td>Depends on Input
Format.</td>
<td>N/A</td>
<td>N/A</td>
</tr>
<tr class="row-even"><td>Input Value change at
Mode/Dataset[(bit-p) + n]</td>
<td>Changed value of the LPF2-Device at PORT ID.
The bit-pointer addresses the first Mode/dataset changed.</td>
<td>&#160;</td>
<td>&#160;</td>
<td>&#160;</td>
</tr>
</tbody>
</table>
<p><sup>[Z]</sup> The user should resolves the data sizes of all the (<a class="reference internal" href="#val-fmt"><span class="std std-ref">Value Format</span></a>) values by using the individual formatting for each mode/dataset combination. These should be initial
requested through the Port Mode Information Request (0x22) and received through the Port Mode Information (0x44).</p>
</div>
</div>
<div class="section" id="port-input-format-single">
<span id="id18"></span><h3>3.23. Port Input Format (Single)<a class="headerlink" href="#port-input-format-single" title="Permalink to this headline">¶</a></h3>
<table border="1" class="docutils">
<colgroup>
<col width="22%" />
<col width="78%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head" colspan="2">Message Type - Port Input Format (Single) [0x47]</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><p class="first"><strong>Communication:</strong></p>
<p><strong>Size:</strong></p>
<p><strong>Purpose:</strong></p>
<p class="last"><strong>Replies To:</strong></p>
</td>
<td><p class="first">Upstream</p>
<p>10 Bytes</p>
<p>Handshake notification of changes made to the Port Input Format.</p>
<p class="last">0x41 Port Input Format Setup (Single)</p>
</td>
</tr>
</tbody>
</table>
<div class="section" id="format-of-port-input-format-single">
<h4>3.23.1. Format of Port Input Format (Single)<a class="headerlink" href="#format-of-port-input-format-single" title="Permalink to this headline">¶</a></h4>
<table border="1" class="docutils">
<colgroup>
<col width="15%" />
<col width="56%" />
<col width="11%" />
<col width="10%" />
<col width="7%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head" colspan="5">Port Input Format (Single) [0x47]</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><strong>Name</strong></td>
<td><strong>Description</strong></td>
<td><strong>Format</strong></td>
<td><strong>Min</strong></td>
<td><strong>Max</strong></td>
</tr>
<tr class="row-odd"><td>Common Header</td>
<td>See <a class="reference internal" href="#common-header-description"><span class="std std-ref">Common Message Header</span></a></td>
<td>N/A</td>
<td>N/A</td>
<td>N/A</td>
</tr>
<tr class="row-even"><td>Port ID</td>
<td>The Port ID associated with the Attached I/O assigned by the Hub</td>
<td>Uint8</td>
<td>0</td>
<td><a class="reference internal" href="#p-id"><span class="std std-ref">Port ID</span></a></td>
</tr>
<tr class="row-odd"><td>Mode</td>
<td>The mode of the addressed Input.</td>
<td>Uint8</td>
<td>N/A</td>
<td>N/A</td>
</tr>
<tr class="row-even"><td>Delta Interval</td>
<td>The delta change the Input Value has to change for triggering a new value update notification.
Example: a value of 1 means that any change to the value will trigger an update
(a form of live data) and a value of 10 means that the value must have changed 10 steps from an
earlier notification before triggering a new update i.e. jitter-filtering.</td>
<td>Uint32</td>
<td>0</td>
<td>N/A</td>
</tr>
<tr class="row-odd"><td>Notification ENabled</td>
<td><p class="first">If notifications are disabled, the Input Value can only be read by sending a read request
through the Input Command Characteristic</p>
<blockquote class="last">
<div><div class="line-block">
<div class="line">0 = Disabled</div>
<div class="line">1 = Enabled</div>
</div>
</div></blockquote>
</td>
<td>Uint8</td>
<td>0</td>
<td>1</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="section" id="port-input-format-combinedmode">
<span id="id19"></span><h3>3.24. Port Input Format (CombinedMode)<a class="headerlink" href="#port-input-format-combinedmode" title="Permalink to this headline">¶</a></h3>
<table border="1" class="docutils">
<colgroup>
<col width="22%" />
<col width="78%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head" colspan="2">Message Type - Port Input Format (CombinedMode) [0x48]</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><p class="first"><strong>Communication:</strong></p>
<p><strong>Size:</strong></p>
<p><strong>Purpose:</strong></p>
<p class="last"><strong>Replies To:</strong></p>
</td>
<td><p class="first">Upstream</p>
<p>7 Bytes</p>
<p>Port Input Format (CombinedMode) is the handshake notification for the setup of one or
more bit-pointer in the 16-bit Mode/Dataset Combination Bit Pointer - i.e. bitposition-
addressed Mode/DataSet(s). Remember first combination setup referenced through bit 0,
second through bit1 etc.</p>
<p>All Format settings will be reset when the input disconnects or the Port is closed.</p>
<p class="last">0x42 Port Input Format Setup (CombinedMode)</p>
</td>
</tr>
</tbody>
</table>
<div class="section" id="format-of-port-input-format-combinedmode">
<h4>3.24.1. Format of Port Input Format (CombinedMode)<a class="headerlink" href="#format-of-port-input-format-combinedmode" title="Permalink to this headline">¶</a></h4>
<table border="1" class="docutils">
<colgroup>
<col width="15%" />
<col width="56%" />
<col width="11%" />
<col width="10%" />
<col width="7%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head" colspan="5">Format of Port Input Format (CombinedMode)</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><strong>Name</strong></td>
<td><strong>Description</strong></td>
<td><strong>Format</strong></td>
<td><strong>Min</strong></td>
<td><strong>Max</strong></td>
</tr>
<tr class="row-odd"><td>Common Header</td>
<td>See <a class="reference internal" href="#common-header-description"><span class="std std-ref">Common Message Header</span></a></td>
<td>N/A</td>
<td>N/A</td>
<td>N/A</td>
</tr>
<tr class="row-even"><td>Port ID</td>
<td>The Port ID for this combined sensor</td>
<td>Uint8</td>
<td>0</td>
<td><a class="reference internal" href="#p-id"><span class="std std-ref">Port ID</span></a></td>
</tr>
<tr class="row-odd"><td>Combined Control Byte</td>
<td>Bit combinations declared below:</td>
<td>Uint8</td>
<td>0</td>
<td>255</td>
</tr>
<tr class="row-even"><td>Used Cobination Index</td>
<td>Points into the table identifying the possible H/W mode combination(s) of the LPF2 Device
being used for this Combined setup. Only bit 0-3 used for this.</td>
<td>&#160;</td>
<td>0x?0</td>
<td>0x?7</td>
</tr>
<tr class="row-odd"><td>Multi Update</td>
<td><p class="first">Bit 7 in the Combined Control Byte indicates the actual Multi Update state:</p>
<table border="1" class="last docutils">
<colgroup>
<col width="37%" />
<col width="63%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>0x1000 <cite>????</cite></td>
<td>Multi Update Enabled</td>
</tr>
<tr class="row-even"><td>0x0000 <cite>????</cite></td>
<td>Multi Update Disabled</td>
</tr>
</tbody>
</table>
</td>
<td>&#160;</td>
<td>0x0?</td>
<td>0x8?</td>
</tr>
<tr class="row-odd"><td colspan="5"><strong>The Mode/Dataset combination bit pointer is used as acknowledge-handshake for the selected Mode/Dataset combinations (setup went OK).</strong>
<strong>The bits in the bit-pointer follows the address/indexing used in the setup.</strong>
<strong>A bit-pointer setting of 0x0000 means: Notification initiated by a Combined Sensor Mode Clear - i.e. Sub Command ID = Reset Sensor.</strong></td>
</tr>
<tr class="row-even"><td>Mode/Dataset combination
bit pointer</td>
<td>Pointing to the combination of up to 16 mode/ data sets. Thus, a value of e.g.
0000 0000 0001 1111b indicates that the Hub has successfully configured the desired mode/data sets
for the value(s) bit-addressed. In the example it means configuring values for 5 mode/datasets.</td>
<td>Uint16(binary</td>
<td>0</td>
<td>0xFFFF</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="section" id="virtual-port-setup">
<span id="id20"></span><h3>3.25. Virtual Port Setup<a class="headerlink" href="#virtual-port-setup" title="Permalink to this headline">¶</a></h3>
<table border="1" class="docutils">
<colgroup>
<col width="22%" />
<col width="78%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head" colspan="2">Message Type - Virtual Port Setup [0x61]</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><p class="first"><strong>Communication:</strong></p>
<p><strong>Size:</strong></p>
<p><strong>Purpose:</strong></p>
<p class="last"><strong>Triggers:</strong></p>
</td>
<td><p class="first">Downstream</p>
<div class="line-block">
<div class="line">If Sub Command = 0x00: 5 Bytes</div>
<div class="line">If Sub Command = 0x01: 6 Bytes</div>
</div>
<p>Used to control synchronization of Ports. I.e. connect or disconnect a Virtual Port. It
is up to the user (or the HUB) to decide if the virtual connection make sense. E.g. a
Motor and a Light output can both be controlled at the same time using e.g. the command
StartPower(Power1, Power2).</p>
<p>The Virtual Port gets a new ID while the original Ports keeps the original IDs.
All Format settings will be reset when the input disconnects or the Port is closed.</p>
<p>0x04  Hub Attached IO (Only the Virtual Port. The individual are Port IDs kept)</p>
<p><strong>REMARK:</strong></p>
<p>Primo 2018 the running implementations of e.g. synchronized motors in move-bases and HUBs
are implemented with implicit Attached IO messages.</p>
<p>I.e. when internal (external) I/O devices can be synchronized (setup as Virtual Port) 3
Attached IO messages is automatically sent: First Port, Second Port and then the Virtual
(Third Port).</p>
<p class="last">Current implementation will return an ERROR if this command is sent. This should be
changed in upgrades of F/W, so this command just return, what already is implicit set.
Will make the interface more consistent for the App developers (same reaction for all
calls).Port Input Format Setup (CombinedMode)</p>
</td>
</tr>
</tbody>
</table>
<div class="section" id="virtual-port-setup-format">
<span id="vpset-fmt"></span><h4>3.25.1. Virtual Port Setup Format<a class="headerlink" href="#virtual-port-setup-format" title="Permalink to this headline">¶</a></h4>
<table border="1" class="docutils">
<colgroup>
<col width="15%" />
<col width="56%" />
<col width="11%" />
<col width="10%" />
<col width="7%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head" colspan="5">Virtual Port Setup Format</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><strong>Name</strong></td>
<td><strong>Description</strong></td>
<td><strong>Format</strong></td>
<td><strong>Min</strong></td>
<td><strong>Max</strong></td>
</tr>
<tr class="row-odd"><td>Common Header</td>
<td>See <a class="reference internal" href="#common-header-description"><span class="std std-ref">Common Message Header</span></a></td>
<td>N/A</td>
<td>N/A</td>
<td>N/A</td>
</tr>
<tr class="row-even"><td>Sub Command</td>
<td><table border="1" class="first last docutils">
<colgroup>
<col width="8%" />
<col width="92%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>0</td>
<td>Disconnected</td>
</tr>
<tr class="row-even"><td>1</td>
<td>Connected</td>
</tr>
</tbody>
</table>
</td>
<td>Uint8</td>
<td>0</td>
<td>1</td>
</tr>
<tr class="row-odd"><td colspan="5"><strong>If Sub Command == Disconnect (0)</strong></td>
</tr>
<tr class="row-even"><td>Port ID</td>
<td>The Virtual Port ID to disconnect</td>
<td>Uint8</td>
<td>0</td>
<td><a class="reference internal" href="#p-id"><span class="std std-ref">Port ID</span></a></td>
</tr>
<tr class="row-odd"><td colspan="5"><strong>If Sub Command == Connect (1)</strong></td>
</tr>
<tr class="row-even"><td>Port ID A</td>
<td>The Port ID of the first synchronizable Port</td>
<td>Uint8</td>
<td>0</td>
<td><a class="reference internal" href="#p-id"><span class="std std-ref">Port ID</span></a></td>
</tr>
<tr class="row-odd"><td>Port ID B</td>
<td>The Port ID of the second synchronizable Port</td>
<td>Uint8</td>
<td>0</td>
<td><a class="reference internal" href="#p-id"><span class="std std-ref">Port ID</span></a></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="section" id="port-output-command">
<span id="id21"></span><h3>3.26. Port Output Command<a class="headerlink" href="#port-output-command" title="Permalink to this headline">¶</a></h3>
<table border="1" class="docutils">
<colgroup>
<col width="22%" />
<col width="78%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head" colspan="2">Message Type - Port Output Command [0x81]</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><p class="first"><strong>Communication:</strong></p>
<p><strong>Size:</strong></p>
<p class="last"><strong>Purpose:</strong></p>
</td>
<td><p class="first">Downstream</p>
<p>The size should be seen as a fixed portion (Common Header, Port ID, Startup and
Completion Information, Sub Command token and an variable portion of payload bytes.</p>
<p>Output commands. In the following the commands are group in functional groups.</p>
<p class="last">Motor commands. Single and synchronized ones (simple or drive).
Feedback from synchronized.</p>
</td>
</tr>
</tbody>
</table>
<div class="section" id="port-output-command-format-common-part">
<span id="po-fmt"></span><h4>3.26.1. Port Output Command Format (Common part)<a class="headerlink" href="#port-output-command-format-common-part" title="Permalink to this headline">¶</a></h4>
<table border="1" class="docutils">
<colgroup>
<col width="20%" />
<col width="54%" />
<col width="11%" />
<col width="8%" />
<col width="7%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head" colspan="5"><strong>Common Message Format for Port Output Command 0x81</strong></th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><strong>Name</strong></td>
<td><strong>Description</strong></td>
<td><strong>Format</strong></td>
<td><strong>Min</strong></td>
<td><strong>Max</strong></td>
</tr>
<tr class="row-odd"><td>Common Header</td>
<td>See <a class="reference internal" href="#common-header-description"><span class="std std-ref">Common Message Header</span></a></td>
<td>N/A</td>
<td>N/A</td>
<td>N/A</td>
</tr>
<tr class="row-even"><td>Port ID</td>
<td>The Port ID associated with the Attached I/O assigned by the Hub</td>
<td>Uint8</td>
<td>0</td>
<td><a class="reference internal" href="#p-id"><span class="std std-ref">Port ID</span></a></td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#st-comp"><span class="std std-ref">Startup and Completion Information</span></a></td>
<td>Startup (s) and Completion (c): <code class="docutils literal"><span class="pre">ssss</span></code> <code class="docutils literal"><span class="pre">cccc</span></code></td>
<td>Uint8</td>
<td>0</td>
<td>255</td>
</tr>
<tr class="row-even"><td>Sub Command</td>
<td>The Sub Command to execute. See further description in the following pages</td>
<td>Uint8</td>
<td>0x00</td>
<td>0xFF</td>
</tr>
<tr class="row-odd"><td>Payload</td>
<td>Payload size (n) depends on the sub-command. The payload is the parameters for the sub-command.</td>
<td>Uint8 * n</td>
<td>0</td>
<td>255</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="startup-and-completion-information">
<span id="st-comp"></span><h4>3.26.2. Startup and Completion Information<a class="headerlink" href="#startup-and-completion-information" title="Permalink to this headline">¶</a></h4>
<table border="1" class="docutils">
<colgroup>
<col width="20%" />
<col width="20%" />
<col width="59%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head" colspan="3">Startup and Completion Information</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><strong>ssss:</strong></td>
<td><strong>cccc:</strong></td>
<td><strong>Description:</strong></td>
</tr>
<tr class="row-odd"><td>0000</td>
<td>xxxx</td>
<td>Buffer if necessary</td>
</tr>
<tr class="row-even"><td>0001</td>
<td>xxxx</td>
<td>Execute immediately</td>
</tr>
<tr class="row-odd"><td>0010</td>
<td>xxxx</td>
<td>&#160;</td>
</tr>
<tr class="row-even"><td colspan="3">—</td>
</tr>
<tr class="row-odd"><td>xxxx</td>
<td>0000</td>
<td>No action</td>
</tr>
<tr class="row-even"><td>xxxx</td>
<td>0001</td>
<td>Command feedback (Status)</td>
</tr>
<tr class="row-odd"><td>xxxx</td>
<td>0010</td>
<td>&#160;</td>
</tr>
<tr class="row-even"><td>xxxx</td>
<td>0011</td>
<td>&#160;</td>
</tr>
<tr class="row-odd"><td colspan="3">—</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="section" id="output-command-0x81-motor-sub-commands-0x01-0x3f">
<h3>3.27. Output Command 0x81 - Motor Sub Commands [0x01-0x3F]<a class="headerlink" href="#output-command-0x81-motor-sub-commands-0x01-0x3f" title="Permalink to this headline">¶</a></h3>
<div class="section" id="output-sub-command-startpower-power">
<h4>3.27.1. Output Sub Command - StartPower(Power)<a class="headerlink" href="#output-sub-command-startpower-power" title="Permalink to this headline">¶</a></h4>
<table border="1" class="docutils">
<colgroup>
<col width="27%" />
<col width="6%" />
<col width="34%" />
<col width="32%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head" colspan="4">StartPower (Power): Output Command 0x81 - Sub Command N/A</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><strong>Sub Command</strong></td>
<td><strong>Value</strong></td>
<td><strong>Parameter Description</strong></td>
<td><strong>Description</strong></td>
</tr>
<tr class="row-odd"><td>StartPower (Power)</td>
<td>N/A</td>
<td><p class="first">Power [Int8]:</p>
<table border="1" class="last docutils">
<colgroup>
<col width="30%" />
<col width="70%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>[-100..-1]</td>
<td>CCW PWM 1-100%</td>
</tr>
<tr class="row-even"><td>[1..100]</td>
<td>CW PWM dutycycle 1-100%</td>
</tr>
<tr class="row-odd"><td>[0]</td>
<td>FLOAT</td>
</tr>
<tr class="row-even"><td>[127]</td>
<td>BRAKE</td>
</tr>
</tbody>
</table>
</td>
<td><p class="first">Single:
Turn on/off motor unregulated.</p>
<p>Synchronized:
Turn on/off both motors</p>
<p class="last"><code class="docutils literal"><span class="pre">Encoded</span> <span class="pre">through</span></code> <a class="reference internal" href="#wr-dmd"><span class="std std-ref">WriteDirectModeData</span></a></p>
</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="output-sub-command-startpower-power1-power2-0x02">
<h4>3.27.2. Output Sub Command - StartPower(Power1, Power2) [0x02]<a class="headerlink" href="#output-sub-command-startpower-power1-power2-0x02" title="Permalink to this headline">¶</a></h4>
<table border="1" class="docutils">
<colgroup>
<col width="27%" />
<col width="6%" />
<col width="34%" />
<col width="32%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head" colspan="4">StartPower (Power1, Power2): Output Command 0x81 - Sub Command 0x02</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><strong>Sub Command</strong></td>
<td><strong>Value</strong></td>
<td><strong>Parameter Description</strong></td>
<td><strong>Description</strong></td>
</tr>
<tr class="row-odd"><td>StartPower (Power1, Power2)</td>
<td>0x02</td>
<td><p class="first">Power1, Power2 [Int8, Int8]:</p>
<table border="1" class="last docutils">
<colgroup>
<col width="30%" />
<col width="70%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>[-100..-1]</td>
<td>CCW PWM 1-100%</td>
</tr>
<tr class="row-even"><td>[1..100]</td>
<td>CW PWM dutycycle 1-100%</td>
</tr>
<tr class="row-odd"><td>[0]</td>
<td>FLOAT</td>
</tr>
<tr class="row-even"><td>[127]</td>
<td>BRAKE</td>
</tr>
</tbody>
</table>
</td>
<td><p class="first">Single:
N/A</p>
<p>Synchronized:
Turn on/off BOTH motors unregulated.</p>
<p class="last"><code class="docutils literal"><span class="pre">Encoded</span> <span class="pre">through</span></code> <a class="reference internal" href="#wr-dmd"><span class="std std-ref">WriteDirectModeData</span></a></p>
</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="output-sub-command-setacctime-time-profileno-0x05">
<h4>3.27.3. Output Sub Command - SetAccTime (Time, ProfileNo) [0x05]<a class="headerlink" href="#output-sub-command-setacctime-time-profileno-0x05" title="Permalink to this headline">¶</a></h4>
<table border="1" class="docutils">
<colgroup>
<col width="27%" />
<col width="6%" />
<col width="34%" />
<col width="32%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head" colspan="4">SetAccTime (Time, ProfileNo) : Output Command 0x81 - Sub Command 0x05</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><strong>Sub Command</strong></td>
<td><strong>Value</strong></td>
<td><strong>Parameter Description</strong></td>
<td><strong>Description</strong></td>
</tr>
<tr class="row-odd"><td>SetAccTime (Time, ProfileNo)</td>
<td>0x05</td>
<td><p class="first">Time [Int16]:</p>
<p>[0..10000]ms (Upper limit - normally used with less)</p>
<p>ProfileNo [Int8]:</p>
<p>[0..MAX_PROFILES]</p>
<p class="last">The selected profile will be used in all motor
based commands if the UseProfileFlag is set TRUE.
The Time and Profile Number set for the profile
is ignored if the UseProfile-Flag is set FALSE.</p>
</td>
<td><p class="first">Single/Synchronized:</p>
<p>Sets an acceleration profile for the motor(s)</p>
<p class="last">The Time is the duration time for an acceleration
from 0 to 100%. I.e. a Time set to 1000 ms.
should give an acceleration time of 300 ms.
from 40% to 70%</p>
</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="output-sub-command-setdectime-time-profileno-0x06">
<h4>3.27.4. Output Sub Command - SetDecTime (Time, ProfileNo) [0x06]<a class="headerlink" href="#output-sub-command-setdectime-time-profileno-0x06" title="Permalink to this headline">¶</a></h4>
<table border="1" class="docutils">
<colgroup>
<col width="27%" />
<col width="6%" />
<col width="34%" />
<col width="32%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head" colspan="4">SetDecTime (Time, ProfileNo) : Output Command 0x81 - Sub Command 0x06</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><strong>Sub Command</strong></td>
<td><strong>Value</strong></td>
<td><strong>Parameter Description</strong></td>
<td><strong>Description</strong></td>
</tr>
<tr class="row-odd"><td>SetDecTime (Time, ProfileNo)</td>
<td>0x06</td>
<td><p class="first">Time [Int16]:</p>
<p>[0..10000]ms (Upper limit - normally used with less)</p>
<p>ProfileNo [Int8]:
[0..MAX_PROFILES]</p>
<p class="last">The selected profile will be used in all motor based
commands if the UseProfileFlag is set TRUE.
The Time and Profile Number set for the profile is
ignored if the UseProfile-Flag is set FALSE.</p>
</td>
<td><p class="first">Single/Synchronized:</p>
<p>Sets a deceleration profile for the motor(s)</p>
<p class="last">The Time is the duration time for an deceleration
from 100% to 0. I.e. a Time set to 1000 ms.
should give an deceleration time of 400 ms.
from 80% down to 40%</p>
</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="output-sub-command-startspeed-speed-maxpower-useprofile-0x07">
<h4>3.27.5. Output Sub Command - StartSpeed (Speed, MaxPower, UseProfile) [0x07]<a class="headerlink" href="#output-sub-command-startspeed-speed-maxpower-useprofile-0x07" title="Permalink to this headline">¶</a></h4>
<table border="1" class="docutils">
<colgroup>
<col width="27%" />
<col width="6%" />
<col width="34%" />
<col width="32%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head" colspan="4">StartSpeed (Speed, MaxPower, UseProfile) : Output Command 0x81 - Sub Command 0x07</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><strong>Sub Command</strong></td>
<td><strong>Value</strong></td>
<td><strong>Parameter Description</strong></td>
<td><strong>Description</strong></td>
</tr>
<tr class="row-odd"><td>StartSpeed (Speed, MaxPower, UseProfile)</td>
<td>0x07</td>
<td><p class="first">Speed [Int8]:</p>
<table border="1" class="docutils">
<colgroup>
<col width="26%" />
<col width="74%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>[-100..-1]</td>
<td>CCW PWM 1-100%</td>
</tr>
<tr class="row-even"><td>[1..100]</td>
<td>CW PWM 1-100%</td>
</tr>
<tr class="row-odd"><td>[0]</td>
<td>implicite [126] HOLD POSITION</td>
</tr>
</tbody>
</table>
<p>If FLOAT or BRAKE should be used e.g. when a slider
is set to 0 (zero) the user has to use either
StartPower(0 or 127).</p>
<p>MaxPower [Int8]:</p>
<p>[ABS(0..100)]%</p>
<p>UseProfile [Int8]:</p>
<p>[0 = DO NOT USE, 1 = USE PROFILE]</p>
<table border="1" class="last docutils">
<colgroup>
<col width="45%" />
<col width="55%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>0x0000000?</td>
<td>Acc.- profile</td>
</tr>
<tr class="row-even"><td>0x000000?0</td>
<td>Decc.- profile</td>
</tr>
</tbody>
</table>
</td>
<td><p class="first">Single/Synchronized:</p>
<p class="last">START or HOLD the motor(s) and keeping the
SPEED/POSITION NOT using power-levels greater
than MaxPower.</p>
</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="output-sub-command-startspeed-speed1-speed2-maxpower-useprofile-0x08">
<h4>3.27.6. Output Sub Command - StartSpeed (Speed1, Speed2, MaxPower, UseProfile) [0x08]<a class="headerlink" href="#output-sub-command-startspeed-speed1-speed2-maxpower-useprofile-0x08" title="Permalink to this headline">¶</a></h4>
<table border="1" class="docutils">
<colgroup>
<col width="27%" />
<col width="6%" />
<col width="34%" />
<col width="32%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head" colspan="4">StartSpeed (Speed1, Speed2, MaxPower, UseProfile) : Output Command 0x81 - Sub Command 0x08</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><strong>Sub Command</strong></td>
<td><strong>Value</strong></td>
<td><strong>Parameter Description</strong></td>
<td><strong>Description</strong></td>
</tr>
<tr class="row-odd"><td>StartSpeed (Speed1, Speed2, MaxPower,
UseProfile)</td>
<td>0x08</td>
<td><p class="first">Speed1, Speed2 [Int8]:</p>
<table border="1" class="docutils">
<colgroup>
<col width="26%" />
<col width="74%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>[-100..-1]</td>
<td>CCW PWM dutycycle 1-100%</td>
</tr>
<tr class="row-even"><td>[1..100]</td>
<td>CW PWM dutycycle 1-100%</td>
</tr>
<tr class="row-odd"><td>[0]</td>
<td>implicite [126] HOLD POSITION</td>
</tr>
</tbody>
</table>
<p>If FLOAT or BRAKE should be used e.g. when a slider
is set to 0 (zero) the user has to use either
StartPower(0 or 127).</p>
<p>MaxPower [Int8]:</p>
<p>[ABS(0..100)]%</p>
<p>UseProfile [Int8]:</p>
<p>[0 = DO NOT USE, 1 = USE PROFILE]</p>
<table border="1" class="last docutils">
<colgroup>
<col width="45%" />
<col width="55%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>0x0000000?</td>
<td>Acc.- profile</td>
</tr>
<tr class="row-even"><td>0x000000?0</td>
<td>Decc.- profile</td>
</tr>
</tbody>
</table>
</td>
<td><p class="first">Single:</p>
<p>N/A</p>
<p>Synchronized:</p>
<p class="last">START or HOLD the motor(s) and keeping the
SPEED/POSITION NOT using power-levels
greater than MaxPower.</p>
</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="output-sub-command-startspeedfortime-time-speed-maxpower-endstate-useprofile-0x09">
<h4>3.27.7. Output Sub Command - StartSpeedForTime (Time, Speed, MaxPower, EndState, UseProfile) [0x09]<a class="headerlink" href="#output-sub-command-startspeedfortime-time-speed-maxpower-endstate-useprofile-0x09" title="Permalink to this headline">¶</a></h4>
<table border="1" class="docutils">
<colgroup>
<col width="27%" />
<col width="6%" />
<col width="34%" />
<col width="32%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head" colspan="4">StartSpeedForTime (Time, Speed, MaxPower, EndState, UseProfile) : Output Command 0x81 - Sub Command 0x09</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><strong>Sub Command</strong></td>
<td><strong>Value</strong></td>
<td><strong>Parameter Description</strong></td>
<td><strong>Description</strong></td>
</tr>
<tr class="row-odd"><td>StartSpeedForTime (Time, Speed, MaxPower,
EndState, UseProfile)</td>
<td>0x09</td>
<td><p class="first">Time [Int16]:</p>
<p>[0..MAX_INT16]ms</p>
<p>Speed [Int8]:</p>
<p>[-100..100]%</p>
<p>MaxPower [Int8]:</p>
<p>[ABS(0..100)]%</p>
<p>EndState[Int8]:</p>
<p>[0 = FLOAT, 126 = HOLD, 127 = BRAKE]</p>
<p>[0 = DO NOT USE, 1 = USE PROFILE]</p>
<table border="1" class="last docutils">
<colgroup>
<col width="45%" />
<col width="55%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>0x0000000?</td>
<td>Acc.- profile</td>
</tr>
<tr class="row-even"><td>0x000000?0</td>
<td>Decc.- profile</td>
</tr>
</tbody>
</table>
</td>
<td><p class="first">Single/Synchronized:</p>
<p class="last">Start the motor(s) for Time ms. keeping a speed
of Speed using a maximum power of MaxPower.
After Time stopping the output using the EndState.</p>
</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="output-sub-command-startspeedfortime-time-speed-maxpower-endstate-useprofile-0x0a">
<h4>3.27.8. Output Sub Command - StartSpeedForTime (Time, Speed, MaxPower, EndState, UseProfile) [0x0A]<a class="headerlink" href="#output-sub-command-startspeedfortime-time-speed-maxpower-endstate-useprofile-0x0a" title="Permalink to this headline">¶</a></h4>
<table border="1" class="docutils">
<colgroup>
<col width="27%" />
<col width="6%" />
<col width="34%" />
<col width="32%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head" colspan="4">StartSpeed (Time, SpeedL, SpeedR, MaxPower, EndState, UseProfile) : Output Command 0x81 - Sub Command 0x0A</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><strong>Sub Command</strong></td>
<td><strong>Value</strong></td>
<td><strong>Parameter Description</strong></td>
<td><strong>Description</strong></td>
</tr>
<tr class="row-odd"><td>StartSpeedForTime(Time, SpeedL, SpeedR,
MaxPower, EndState, UseProfile)</td>
<td>0x0A</td>
<td><p class="first">Time [Int16]:</p>
<p>[0.. MAX_INT16]ms</p>
<p>SpeedL, SpeedR [Int8]:</p>
<p>[-100..100]%</p>
<p>MaxPower [Int8]:</p>
<p>[ABS(0..100)]%</p>
<p>EndState[Int8]:</p>
<p>[0 = FLOAT, 126 = HOLD, 127 = BRAKE]</p>
<p>[0 = DO NOT USE, 1 = USE PROFILE]</p>
<table border="1" class="last docutils">
<colgroup>
<col width="45%" />
<col width="55%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>0x0000000?</td>
<td>Acc.- profile</td>
</tr>
<tr class="row-even"><td>0x000000?0</td>
<td>Decc.- profile</td>
</tr>
</tbody>
</table>
</td>
<td><p class="first">Single:</p>
<p>N/A</p>
<p>Synchronized:</p>
<p class="last">Start the motors for Time ms. And try to keep
individual speeds using Speed(X) while using a
maximum power of MaxPower. After Time stopping
the outputs using the EndState.</p>
</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="output-sub-command-startspeedfordegrees-degrees-speed-maxpower-endstate-useprofile-0x0b">
<h4>3.27.9. Output Sub Command - StartSpeedForDegrees(Degrees, Speed, MaxPower, EndState, UseProfile) [0x0B]<a class="headerlink" href="#output-sub-command-startspeedfordegrees-degrees-speed-maxpower-endstate-useprofile-0x0b" title="Permalink to this headline">¶</a></h4>
<table border="1" class="docutils">
<colgroup>
<col width="27%" />
<col width="6%" />
<col width="34%" />
<col width="32%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head" colspan="4">StartSpeedForDegrees(Degrees, Speed, MaxPower, EndState, UseProfile) : Output Command 0x81 - Sub Command 0x0B</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><strong>Sub Command</strong></td>
<td><strong>Value</strong></td>
<td><strong>Parameter Description</strong></td>
<td><strong>Description</strong></td>
</tr>
<tr class="row-odd"><td>StartSpeedForDegrees(Degrees, Speed,
MaxPower, EndState, UseProfile)</td>
<td>0x0B</td>
<td><p class="first">Degrees [Int32]:</p>
<p>[1..MAX_INT32]</p>
<p>Speed [Int8]:</p>
<p>[-100..100]%</p>
<p>MaxPower [Int8]:</p>
<p>[ABS(0..100)]%</p>
<p>EndState[Int8]:</p>
<p>[0 = FLOAT, 126 = HOLD, 127 = BRAKE]</p>
<p>[0 = DO NOT USE, 1 = USE PROFILE]</p>
<table border="1" class="last docutils">
<colgroup>
<col width="45%" />
<col width="55%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>0x0000000?</td>
<td>Acc.- profile</td>
</tr>
<tr class="row-even"><td>0x000000?0</td>
<td>Decc.- profile</td>
</tr>
</tbody>
</table>
</td>
<td><p class="first">Single/Synchronized:</p>
<p class="last">Start the motor(s) for Degrees at a speed of
Speed using a maximum power of MaxPower.
After Degrees stopping the output using the
EndState. Direction controlled solely by the
sign of the Speed param.</p>
</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="output-sub-command-startspeedfordegrees-degrees-speedl-speedr-maxpower-endstate-useprofile-0x0c">
<h4>3.27.10. Output Sub Command - StartSpeedForDegrees(Degrees, SpeedL, SpeedR, MaxPower, EndState, UseProfile) [0x0C]<a class="headerlink" href="#output-sub-command-startspeedfordegrees-degrees-speedl-speedr-maxpower-endstate-useprofile-0x0c" title="Permalink to this headline">¶</a></h4>
<table border="1" class="docutils">
<colgroup>
<col width="27%" />
<col width="6%" />
<col width="34%" />
<col width="32%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head" colspan="4">StartSpeedForDegrees(Degrees, SpeedL, SpeedR, MaxPower, EndState, UseProfile) : Output Command 0x81 - Sub Command 0x0C</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><strong>Sub Command</strong></td>
<td><strong>Value</strong></td>
<td><strong>Parameter Description</strong></td>
<td><strong>Description</strong></td>
</tr>
<tr class="row-odd"><td>StartSpeedForDegrees(Degrees, SpeedL,
SpeedR, MaxPower, EndState, UseProfile)</td>
<td>0x0C</td>
<td><p class="first">Degrees [Int32]:</p>
<p>[0..10000000]</p>
<p>(NO signed value - See <a class="reference internal" href="#tacho-math"><span class="std std-ref">Tacho Math</span></a>)</p>
<p>SpeedL, SpeedR [Int8]:</p>
<p>[-100..100]%</p>
<p>MaxPower [Int8]:</p>
<p>[ABS(0..100)]%</p>
<p>EndState[Int8]:</p>
<p>[0 = FLOAT, 126 = HOLD, 127 = BRAKE]</p>
<p>[0 = DO NOT USE, 1 = USE PROFILE]</p>
<table border="1" class="last docutils">
<colgroup>
<col width="45%" />
<col width="55%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>0x0000000?</td>
<td>Acc.- profile</td>
</tr>
<tr class="row-even"><td>0x000000?0</td>
<td>Decc.- profile</td>
</tr>
</tbody>
</table>
</td>
<td><p class="first">Single:</p>
<p>N/A</p>
<p>Synchronized:</p>
<p class="last">Start the motors for Degrees and try to keep
individual speeds using Speed(X) while using a
maximum power of MaxPower. After Degrees is
reached stop the outputs using the EndState.</p>
</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="output-sub-command-gotoabsoluteposition-abspos-speed-maxpower-endstate-useprofile-0x0d">
<h4>3.27.11. Output Sub Command - GotoAbsolutePosition(AbsPos, Speed, MaxPower, EndState, UseProfile) [0x0D]<a class="headerlink" href="#output-sub-command-gotoabsoluteposition-abspos-speed-maxpower-endstate-useprofile-0x0d" title="Permalink to this headline">¶</a></h4>
<table border="1" class="docutils">
<colgroup>
<col width="27%" />
<col width="6%" />
<col width="34%" />
<col width="32%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head" colspan="4">GotoAbsolutePosition(AbsPos, Speed, MaxPower, EndState, UseProfile) : Output Command 0x81 - Sub Command 0x0D</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><strong>Sub Command</strong></td>
<td><strong>Value</strong></td>
<td><strong>Parameter Description</strong></td>
<td><strong>Description</strong></td>
</tr>
<tr class="row-odd"><td>GotoAbsolutePosition(AbsPos, Speed,
MaxPower, EndState, UseProfile)</td>
<td>0x0D</td>
<td><p class="first">AbsPos [Int32]:</p>
<p>[MIN_INT32..MAX_INT32]</p>
<p>Speed [Int8]:</p>
<p>[1..100]%</p>
<p>MaxPower [Int8]:</p>
<p>[ABS(0..100)]%</p>
<p>EndState[Int8]:</p>
<p>[0 = FLOAT, 126 = HOLD, 127 = BRAKE]</p>
<p>[0 = DO NOT USE, 1 = USE PROFILE]</p>
<table border="1" class="last docutils">
<colgroup>
<col width="45%" />
<col width="55%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>0x0000000?</td>
<td>Acc.- profile</td>
</tr>
<tr class="row-even"><td>0x000000?0</td>
<td>Decc.- profile</td>
</tr>
</tbody>
</table>
</td>
<td><p class="first">Single:</p>
<p>Start the motor with a speed of Speed using a
maximum power of MaxPower and GOTO the Absolute
position AbsPos. After position is reached the
motor is stopped using the EndState mode of
operation.</p>
<p class="last">Synchronized:
As above - but using the Virtual Port as
destination for the command.</p>
</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="output-sub-command-gotoabsoluteposition-abspos1-abspos2-speed-maxpower-endstate-useprofile-0x0e">
<h4>3.27.12. Output Sub Command - GotoAbsolutePosition(AbsPos1, AbsPos2, Speed, MaxPower, EndState, UseProfile) [0x0E]<a class="headerlink" href="#output-sub-command-gotoabsoluteposition-abspos1-abspos2-speed-maxpower-endstate-useprofile-0x0e" title="Permalink to this headline">¶</a></h4>
<table border="1" class="docutils">
<colgroup>
<col width="27%" />
<col width="6%" />
<col width="34%" />
<col width="32%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head" colspan="4">GotoAbsolutePosition(AbsPos1, AbsPos2, Speed, MaxPower, EndState, UseProfile) : Output Command 0x81 - Sub Command 0x0E</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><strong>Sub Command</strong></td>
<td><strong>Value</strong></td>
<td><strong>Parameter Description</strong></td>
<td><strong>Description</strong></td>
</tr>
<tr class="row-odd"><td>GotoAbsolutePosition(AbsPos1, AbsPos2,
Speed, MaxPower, EndState, UseProfile)</td>
<td>0x0E</td>
<td><p class="first">AbsPos1, AbsPos2 [Int32]:</p>
<p>[MIN_INT32..MAX_INT32]</p>
<p>Speed [Int8]:</p>
<p>[1..100]%</p>
<p>MaxPower [Int8]:</p>
<p>[ABS(0..100)]%</p>
<p>EndState[Int8]:</p>
<p>[0 = FLOAT, 126 = HOLD, 127 = BRAKE]</p>
<p>[0 = DO NOT USE, 1 = USE PROFILE]</p>
<table border="1" class="last docutils">
<colgroup>
<col width="45%" />
<col width="55%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>0x0000000?</td>
<td>Acc.- profile</td>
</tr>
<tr class="row-even"><td>0x000000?0</td>
<td>Decc.- profile</td>
</tr>
</tbody>
</table>
</td>
<td><p class="first">Single:</p>
<p>N/A</p>
<p>Synchronized:</p>
<p>Start the motors with individual speeds
calculated from the common given Speed using a
powerlevel limited to the MaxPower value.
And the GOTO the Absolute positions: AbsPos1 and
AbsPos2.</p>
<p class="last">E.g. If the distance to the AbsPosx of one of the
motors is 1/3 of the other - the power used also
has to be less.</p>
</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="output-sub-command-presetencoder-position-n-a">
<h4>3.27.13. Output Sub Command - PresetEncoder(Position) N/A<a class="headerlink" href="#output-sub-command-presetencoder-position-n-a" title="Permalink to this headline">¶</a></h4>
<table border="1" class="docutils">
<colgroup>
<col width="27%" />
<col width="6%" />
<col width="34%" />
<col width="32%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head" colspan="4">PresetEncoder(Position) : Output Command 0x81 - Sub Command N/A</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><strong>Sub Command</strong></td>
<td><strong>Value</strong></td>
<td><strong>Parameter Description</strong></td>
<td><strong>Description</strong></td>
</tr>
<tr class="row-odd"><td>PresetEncoder(Position)</td>
<td>N/A</td>
<td><p class="first">Position [Int32]:</p>
<p>[MIN_INT32..MAX_INT32]</p>
<p class="last">As a new command (NOT QUEUED) will stop an
executing command, the PresetEncoder() will
automatically STOP the Motor(s).</p>
</td>
<td><p class="first">Single:</p>
<p>Preset the encoder of the motor to Position.</p>
<p>A 0 (zero) value equals RESET.</p>
<p>Synchronized:</p>
<p>Presets all the encoders: the virtual encoder
and both the individual encoders. They are all
set to POSITION.</p>
<p>A value of 0 (zero) equals RESET.</p>
<p class="last"><code class="docutils literal"><span class="pre">Encoded</span> <span class="pre">through</span></code> <a class="reference internal" href="#wr-dmd"><span class="std std-ref">WriteDirectModeData</span></a></p>
</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="output-sub-command-presetencoder-leftposition-rightposition-0x14">
<h4>3.27.14. Output Sub Command - PresetEncoder(LeftPosition, RightPosition) [0x14]<a class="headerlink" href="#output-sub-command-presetencoder-leftposition-rightposition-0x14" title="Permalink to this headline">¶</a></h4>
<table border="1" class="docutils">
<colgroup>
<col width="27%" />
<col width="6%" />
<col width="34%" />
<col width="32%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head" colspan="4">PresetEncoder(LeftPosition, RightPosition) : Output Command 0x81 - Sub Command 0x14</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><strong>Sub Command</strong></td>
<td><strong>Value</strong></td>
<td><strong>Parameter Description</strong></td>
<td><strong>Description</strong></td>
</tr>
<tr class="row-odd"><td>PresetEncoder(LeftPosition,
RightPosition)</td>
<td>0x14</td>
<td><p class="first">LeftPosition, RightPosition [Int32]:</p>
<p>[MIN_INT32..MAX_INT32]</p>
<p class="last">As a new command (NOT QUEUED) will stop an executing
command, the PresetEncoder() will automatically STOP
the Motor(s).</p>
</td>
<td><p class="first">Single:</p>
<p>N/A</p>
<p>Synchronized:</p>
<p class="last">Presets ONLY the individual encoders of the
synchronized motors to (L/R) Position. The
synchronized virtual encoder is NOT affected!
A value of 0 (zero) equals RESET.</p>
</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="output-sub-command-tiltimpactpreset-presetvalue-n-a">
<h4>3.27.15. Output Sub Command - TiltImpactPreset(PresetValue) N/A<a class="headerlink" href="#output-sub-command-tiltimpactpreset-presetvalue-n-a" title="Permalink to this headline">¶</a></h4>
<table border="1" class="docutils">
<colgroup>
<col width="27%" />
<col width="6%" />
<col width="34%" />
<col width="32%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head" colspan="4">TiltImpactPreset(PresetValue) : Output Command 0x81 - Sub Command N/A</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><strong>Sub Command</strong></td>
<td><strong>Value</strong></td>
<td><strong>Parameter Description</strong></td>
<td><strong>Description</strong></td>
</tr>
<tr class="row-odd"><td>TiltImpactPreset(PresetValue)</td>
<td>N/A</td>
<td><p class="first">PresetValue: [Int32]</p>
<p class="last">PresetValue [0..MAX_INT32]</p>
</td>
<td><p class="first">(P)Resets the Mode 3 ImpactCounts.</p>
<p class="last"><code class="docutils literal"><span class="pre">Encoded</span> <span class="pre">through</span></code> <a class="reference internal" href="#wr-dmd"><span class="std std-ref">WriteDirectModeData</span></a></p>
</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="output-sub-command-tiltconfigorientation-orientation-n-a">
<h4>3.27.16. Output Sub Command - TiltConfigOrientation(Orientation) N/A<a class="headerlink" href="#output-sub-command-tiltconfigorientation-orientation-n-a" title="Permalink to this headline">¶</a></h4>
<table border="1" class="docutils">
<colgroup>
<col width="27%" />
<col width="6%" />
<col width="34%" />
<col width="32%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head" colspan="4">TiltConfigOrientation(Orientation) : Output Command 0x81 - Sub Command N/A</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><strong>Sub Command</strong></td>
<td><strong>Value</strong></td>
<td><strong>Parameter Description</strong></td>
<td><strong>Description</strong></td>
</tr>
<tr class="row-odd"><td>TiltConfigOrientation(Orientation)</td>
<td>N/A</td>
<td><p class="first">Orientation: [Int8]</p>
<p>Orientation [0-6]:</p>
<table border="1" class="last docutils">
<colgroup>
<col width="6%" />
<col width="94%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>0</td>
<td>Bottom (Default/Normal)</td>
</tr>
<tr class="row-even"><td>1</td>
<td>Front</td>
</tr>
<tr class="row-odd"><td>2</td>
<td>Back</td>
</tr>
<tr class="row-even"><td>3</td>
<td>Left</td>
</tr>
<tr class="row-odd"><td>4</td>
<td>Right</td>
</tr>
<tr class="row-even"><td>5</td>
<td>Top</td>
</tr>
<tr class="row-odd"><td>6</td>
<td>Use actual as Bottom reference.</td>
</tr>
</tbody>
</table>
</td>
<td><p class="first">Set the default bottom side (orientation)
mode 5.</p>
<p><code class="docutils literal"><span class="pre">Encoded</span> <span class="pre">through</span></code> <a class="reference internal" href="#wr-dmd"><span class="std std-ref">WriteDirectModeData</span></a></p>
<p class="last">If 6 “Use actual as Bottom reference” is issued,
then all other orientations are relative to this.</p>
</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="output-sub-command-tiltconfigimpact-impactthreshold-bumpholdoff-n-a">
<h4>3.27.17. Output Sub Command - TiltConfigImpact(ImpactThreshold, BumpHoldoff) N/A<a class="headerlink" href="#output-sub-command-tiltconfigimpact-impactthreshold-bumpholdoff-n-a" title="Permalink to this headline">¶</a></h4>
<table border="1" class="docutils">
<colgroup>
<col width="27%" />
<col width="6%" />
<col width="34%" />
<col width="32%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head" colspan="4">TiltConfigImpact(ImpactThreshold, BumpHoldoff) : Output Command 0x81 - Sub Command N/A</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><strong>Sub Command</strong></td>
<td><strong>Value</strong></td>
<td><strong>Parameter Description</strong></td>
<td><strong>Description</strong></td>
</tr>
<tr class="row-odd"><td>TiltConfigImpact(ImpactThreshold,
BumpHoldoff)</td>
<td>N/A</td>
<td><p class="first">ImpactThreshold: [Int8]
ImpactThreshold [0-127]</p>
<p class="last">BumpHoldoff: [Int8]
[1..127] 10th of ms</p>
</td>
<td><p class="first">Sets the Impact size for a BUMP - mode 6.</p>
<p>Sets the minimum Holdoff time between individual
impacts (Bumps).</p>
<p>The HoldOff can be set between 10 ms. and 1.27
second.</p>
<p class="last"><code class="docutils literal"><span class="pre">Encoded</span> <span class="pre">through</span></code> <a class="reference internal" href="#wr-dmd"><span class="std std-ref">WriteDirectModeData</span></a></p>
</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="output-sub-command-tiltfactorycalibration-orientation-passcode-n-a">
<h4>3.27.18. Output Sub Command - TiltFactoryCalibration(Orientation, PassCode) N/A<a class="headerlink" href="#output-sub-command-tiltfactorycalibration-orientation-passcode-n-a" title="Permalink to this headline">¶</a></h4>
<table border="1" class="docutils">
<colgroup>
<col width="27%" />
<col width="6%" />
<col width="34%" />
<col width="32%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head" colspan="4">TiltFactoryCalibration(Orientation, PassCode) : Output Command 0x81 - Sub Command N/A</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><strong>Sub Command</strong></td>
<td><strong>Value</strong></td>
<td><strong>Parameter Description</strong></td>
<td><strong>Description</strong></td>
</tr>
<tr class="row-odd"><td>TiltFactoryCalibration(Orientation,
PassCode)</td>
<td>N/A</td>
<td><p class="first">Orientation: [Int8]</p>
<table border="1" class="docutils">
<colgroup>
<col width="33%" />
<col width="67%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>1</td>
<td>XY</td>
</tr>
<tr class="row-even"><td>2</td>
<td>Z</td>
</tr>
</tbody>
</table>
<p class="last">PassCode = Calib-Sensor</p>
</td>
<td><p class="first">Tells the orientation set physically by the
montage automat - Mode 7.</p>
<table border="1" class="docutils">
<colgroup>
<col width="9%" />
<col width="91%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>XY</td>
<td>Laying flat</td>
</tr>
<tr class="row-even"><td>Z</td>
<td>Standing (long dir.)</td>
</tr>
</tbody>
</table>
<p class="last"><code class="docutils literal"><span class="pre">Encoded</span> <span class="pre">through</span></code> <a class="reference internal" href="#wr-dir"><span class="std std-ref">WriteDirect</span></a></p>
</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="output-sub-command-hardware-reset-genericzerosethardware-n-a">
<h4>3.27.19. Output Sub Command - HARDWARE RESET GenericZeroSetHardware() N/A<a class="headerlink" href="#output-sub-command-hardware-reset-genericzerosethardware-n-a" title="Permalink to this headline">¶</a></h4>
<table border="1" class="docutils">
<colgroup>
<col width="27%" />
<col width="6%" />
<col width="34%" />
<col width="32%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head" colspan="4">HARDWARE RESET : Output Command 0x81 -  Sub Command N/A</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><strong>Sub Command</strong></td>
<td><strong>Value</strong></td>
<td><strong>Parameter Description</strong></td>
<td><strong>Description</strong></td>
</tr>
<tr class="row-odd"><td>GenericZeroSetHardware()</td>
<td>N/A</td>
<td>Resets or zerosets the H/W component attached to
the Port ID</td>
<td>Transmits the universal H/W Reset 0x11 token to
the addressed H/W.
<code class="docutils literal"><span class="pre">Encoded</span> <span class="pre">through</span></code> <a class="reference internal" href="#wr-dir"><span class="std std-ref">WriteDirect</span></a></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="output-sub-command-setrgbcolorno-colorno-n-a">
<h4>3.27.20. Output Sub Command - SetRgbColorNo(ColorNo) N/A<a class="headerlink" href="#output-sub-command-setrgbcolorno-colorno-n-a" title="Permalink to this headline">¶</a></h4>
<table border="1" class="docutils">
<colgroup>
<col width="27%" />
<col width="6%" />
<col width="34%" />
<col width="32%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head" colspan="4">SetRgbColorNo(ColorNo) : Output Command 0x81 - Sub Command N/A</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><strong>Sub Command</strong></td>
<td><strong>Value</strong></td>
<td><strong>Parameter Description</strong></td>
<td><strong>Description</strong></td>
</tr>
<tr class="row-odd"><td>SetRgbColorNo(ColorNo)</td>
<td>N/A</td>
<td>ColorNo: [Int8]
[0..10]</td>
<td><p class="first">Show the Color specified by ColorNo.</p>
<p class="last"><code class="docutils literal"><span class="pre">Encoded</span> <span class="pre">through</span></code> <a class="reference internal" href="#wr-dmd"><span class="std std-ref">WriteDirectModeData</span></a></p>
</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="output-sub-command-setrgbcolorno-redcolor-greencolor-bluecolor-n-a">
<h4>3.27.21. Output Sub Command - SetRgbColorNo(RedColor, GreenColor, BlueColor) N/A<a class="headerlink" href="#output-sub-command-setrgbcolorno-redcolor-greencolor-bluecolor-n-a" title="Permalink to this headline">¶</a></h4>
<table border="1" class="docutils">
<colgroup>
<col width="27%" />
<col width="6%" />
<col width="34%" />
<col width="32%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head" colspan="4">SetRgbColorNo(RedColor, GreenColor, BlueColor) : Output Command 0x81 - Sub Command N/A</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><strong>Sub Command</strong></td>
<td><strong>Value</strong></td>
<td><strong>Parameter Description</strong></td>
<td><strong>Description</strong></td>
</tr>
<tr class="row-odd"><td>SetRgbColors(RedColor, GreenColor,
BlueColor)</td>
<td>N/A</td>
<td>RedColor, GreenColor, BlueColor: [UInt8]
[0..255, 0..255, 0..255]</td>
<td><p class="first">Show a color mixed off the individual RGB values.</p>
<p class="last"><code class="docutils literal"><span class="pre">Encoded</span> <span class="pre">through</span></code> <a class="reference internal" href="#wr-dmd"><span class="std std-ref">WriteDirectModeData</span></a></p>
</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="section" id="writedirect">
<span id="wr-dir"></span><h3>3.28. WriteDirect<a class="headerlink" href="#writedirect" title="Permalink to this headline">¶</a></h3>
<div class="section" id="output-sub-command-writedirect-byte-0-byte-0-n-sub-command-0x50">
<h4>3.28.1. Output Sub Command - WriteDirect(Byte[0],Byte[0 + n]) Sub Command [0x50]<a class="headerlink" href="#output-sub-command-writedirect-byte-0-byte-0-n-sub-command-0x50" title="Permalink to this headline">¶</a></h4>
<table border="1" class="docutils">
<colgroup>
<col width="27%" />
<col width="6%" />
<col width="34%" />
<col width="32%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head" colspan="4">WriteDirect(Byte[0],Byte[0 + n]) : Output Command 0x81 - Sub Command 0x50</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><strong>Sub Command</strong></td>
<td><strong>Value</strong></td>
<td><strong>Parameter Description</strong></td>
<td><strong>Description</strong></td>
</tr>
<tr class="row-odd"><td>WriteDirect(Byte[0],Byte[0 + n])</td>
<td>0x50</td>
<td><p class="first">Byte(x): [Uint8]
[0..255]</p>
<p>The user has to add some decorations:</p>
<p>PayLoad[0],
PayLoad[1],
CheckSum</p>
<p class="last">See <a class="reference internal" href="#chk-sum"><span class="std std-ref">Checksum Calculation</span></a>:</p>
</td>
<td>Direct byte values written directly via the
H/W-wired to the LPF2 Device at I/O at Port ID.</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="section" id="writedirectmodedata">
<span id="wr-dmd"></span><h3>3.29. WriteDirectModeData<a class="headerlink" href="#writedirectmodedata" title="Permalink to this headline">¶</a></h3>
<div class="section" id="output-sub-command-writedirectmodedata-sub-command-0x5">
<h4>3.29.1. Output Sub Command - WriteDirectModeData() Sub Command [0x5]<a class="headerlink" href="#output-sub-command-writedirectmodedata-sub-command-0x5" title="Permalink to this headline">¶</a></h4>
<table border="1" class="docutils">
<colgroup>
<col width="27%" />
<col width="6%" />
<col width="34%" />
<col width="32%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head" colspan="4">WriteDirectModeData((Mode, PayLoad[0] PayLoad [0 + n]) : Output Command 0x81 - Sub Command 0x51</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><strong>Sub Command</strong></td>
<td><strong>Value</strong></td>
<td><strong>Parameter Description</strong></td>
<td><strong>Description</strong></td>
</tr>
<tr class="row-odd"><td>WriteDirectModeData(Mode,
PayLoad[0] PayLoad [0 + n]</td>
<td>0x51</td>
<td><p class="first">Mode: [Uint8]
[0..MaxMode]
Sets the mode.</p>
<p>PayLoad[x]: [Uint8]
[0..255]
Payload transferred directly to the io-module and
used in the previous setup mode.</p>
<p class="last">Commands encoded using this encoding are show
in the Appendix: <a class="reference internal" href="index.html#enc-wdm"><span class="std std-ref">Encoding of WriteDirectModeData [0x81, 0x51]</span></a></p>
</td>
<td>Write Direct data to a specific mode. I.e.
the command will select/ change mode and uses
the following  payload as para-meters for this
new mode.</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="section" id="checksum-calculation">
<span id="chk-sum"></span><h3>3.30. Checksum Calculation<a class="headerlink" href="#checksum-calculation" title="Permalink to this headline">¶</a></h3>
<p>The Checksum is calculated as:</p>
<p>ChkSum = PayLoad[0] ^ … PayLoad[n] ^ 0xFF</p>
</div>
<div class="section" id="tacho-math">
<span id="id22"></span><h3>3.31. Tacho Math<a class="headerlink" href="#tacho-math" title="Permalink to this headline">¶</a></h3>
<p>The Syncronized movement is the average of the two tachocounters with the signed ratio given from the SpeedL and SpeedR. The degrees count limited to 10000000
due to max resolution without internal mathematically overflow.</p>
<p>As an example:</p>
<p>Example A:</p>
<ul class="simple">
<li>Run for 88 Degrees</li>
<li>Left Speed (SpeedL) set to 75</li>
<li>Left Speed (SpeedR) set to 35</li>
</ul>
<p>The individual tachocounters should travel:</p>
<p>TachoL = ((88 * 2) * 75 * sign(SpeedL)) / (75 + 35) = 120</p>
<p>TachoR = ((88 * 2) * 35 * sign(SpeedR)) / (75 + 35) = 56</p>
<p>Example B:</p>
<ul class="simple">
<li>Run for 160 Degrees</li>
<li>Left Speed (SpeedL) set to 55</li>
<li>Right Speed (SpeedR) set to -48</li>
</ul>
<p>The individual tachocounters should travel:</p>
<p>TachoL = ((160 * 2) * 55 * sign(SpeedL)) / (55 + |-48|)    = 171</p>
<p>TachoR = ((160 * 2) * |-48| * sign(SpeedR)) / (55 + |-48|) = -149</p>
</div>
<div class="section" id="port-output-command-feedback">
<span id="id23"></span><h3>3.32. Port Output Command Feedback<a class="headerlink" href="#port-output-command-feedback" title="Permalink to this headline">¶</a></h3>
<table border="1" class="docutils">
<colgroup>
<col width="22%" />
<col width="78%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head" colspan="2">Message Type - Port Output Command Feedback [0x82]</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><p class="first"><strong>Communication:</strong></p>
<p><strong>Size:</strong></p>
<p><strong>Purpose:</strong></p>
<p class="last"><strong>Replies To</strong></p>
</td>
<td><p class="first">Upstream</p>
<p>Normally with feedback from 1 (one) port the message size is 5 Bytes. If feedback from
more ports, the message size is increased 2 bytes for each additional port.</p>
<p>Allows users to keep track of one or more buffering 1-bytes queue and the progress of
requested Port Output Command(s) (0x81). Immediate commands discarding the executing
and/or the buffered command(s) are also flagged.</p>
<p class="last">0x81 Port Output Command progress and buffering status</p>
</td>
</tr>
</tbody>
</table>
<div class="section" id="port-output-command-feedback-format">
<h4>3.32.1. Port Output Command Feedback Format<a class="headerlink" href="#port-output-command-feedback-format" title="Permalink to this headline">¶</a></h4>
<table border="1" class="docutils">
<colgroup>
<col width="9%" />
<col width="61%" />
<col width="12%" />
<col width="10%" />
<col width="8%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head" colspan="5">Port Output Command Feedback Message Format [0x81]</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><strong>Name</strong></td>
<td><strong>Description</strong></td>
<td><strong>Format</strong></td>
<td><strong>Min</strong></td>
<td><strong>Max</strong></td>
</tr>
<tr class="row-odd"><td>Common Header</td>
<td>See <a class="reference internal" href="#common-header-description"><span class="std std-ref">Common Message Header</span></a></td>
<td>N/A</td>
<td>N/A</td>
<td>N/A</td>
</tr>
<tr class="row-even"><td>Port ID</td>
<td>The Port ID for the feedback message</td>
<td>UInt8</td>
<td>0</td>
<td>255</td>
</tr>
<tr class="row-odd"><td>Port FeedBack
Message</td>
<td><p class="first">FeedBack Message (as BIT-fields)</p>
<table border="1" class="docutils">
<colgroup>
<col width="11%" />
<col width="89%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>0x01</td>
<td>Buffer Empty + Command In Progress</td>
</tr>
<tr class="row-even"><td>0x02</td>
<td>Buffer Empty + Command Completed</td>
</tr>
<tr class="row-odd"><td>0x04</td>
<td>Current Command(s) Discarded</td>
</tr>
<tr class="row-even"><td>0x08</td>
<td>Idle</td>
</tr>
<tr class="row-odd"><td>0x10</td>
<td>Busy/Full</td>
</tr>
</tbody>
</table>
<p>See the <a class="reference internal" href="index.html#buff-stat"><span class="std std-ref">Buffering State Machine</span></a> for further explanation of the Buffering for both the HUB- and SDK side.</p>
<p class="last">Also have a look at the <a class="reference internal" href="#tx-flow-ctrl"><span class="std std-ref">Transmission Flow Control (Preliminary PROPOSAL!)</span></a>.</p>
</td>
<td>UInt8</td>
<td>0</td>
<td>0x1F</td>
</tr>
<tr class="row-even"><td>2nd Port ID</td>
<td>Optional 2nd PortID for the feedback message</td>
<td>UInt8</td>
<td>0</td>
<td>255</td>
</tr>
<tr class="row-odd"><td>Port 2
FeedBack
Message</td>
<td>FeedBack Message (as BIT-fields)
See above for bit encoding</td>
<td>UInt8</td>
<td>0</td>
<td>0x1F</td>
</tr>
<tr class="row-even"><td>3rd Port ID</td>
<td>Optional 3rd PortID for the feedback message</td>
<td>UInt8</td>
<td>0</td>
<td>255</td>
</tr>
<tr class="row-odd"><td>Port 3
FeedBack
Message</td>
<td>FeedBack Message (as BIT-fields)
See above for bit encoding</td>
<td>UInt8</td>
<td>0</td>
<td>0x1F</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<span id="document-4-Buffering"></span><div class="section" id="buffering-state-machine">
<span id="buff-stat"></span><h2>4. Buffering State Machine<a class="headerlink" href="#buffering-state-machine" title="Permalink to this headline">¶</a></h2>
<p>Each port can have a command in progress and also a buffered command.</p>
<p>Per port, the state machine for this is as follows:</p>
<ul class="simple">
<li><dl class="first docutils">
<dt>There are three states:</dt>
<dd><ol class="first last arabic">
<li>Nothing in progress, buffer empty. (“Idle”)</li>
<li>Command in progress, buffer empty (“Busy/Empty”)</li>
<li>Command in progress, buffer full (“Busy/Full”)</li>
</ol>
</dd>
</dl>
</li>
</ul>
<img alt="_images/LWP_buffering.png" src="_images/LWP_buffering.png" />
<ul class="simple">
<li><dl class="first docutils">
<dt>There are external events which affect the state machine:</dt>
<dd><ol class="first last arabic">
<li>A command is submitted for immediate execution (“EI”)</li>
<li>A command is submitted for execution or buffering - “buffer if necessary” (“Q”)</li>
<li>The current command completes (“Done”)</li>
<li>An internal FW event occurs which interrupts all pending commands (internal interrupt, “Interrupt”) (Example of this: a virtual motor is interrupted by use of one of its component motors, or vice versa.)</li>
</ol>
</dd>
</dl>
</li>
<li>The state machine emits signals in the form of “Port Output Command Feedback” messages to the SDK. (The content of this command could be targetted towards tracking the fates of individual commands, or tracking the buffer state as a whole. We have chosen in the following to go with the latter option.)</li>
</ul>
<p>Relevant info is:</p>
<ul class="simple">
<li>What the new state is</li>
<li>Whether the state was reached because all existing commands were discarded.</li>
<li>Whether any command was completed successfully (only strictly necessary if we have instantaneous commands; see below).</li>
</ul>
<div class="section" id="state-machine-specification">
<h3>4.1. State machine specification<a class="headerlink" href="#state-machine-specification" title="Permalink to this headline">¶</a></h3>
<table border="1" class="docutils">
<colgroup>
<col width="15%" />
<col width="21%" />
<col width="15%" />
<col width="12%" />
<col width="37%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Old state</th>
<th class="head">Event</th>
<th class="head">–&gt;</th>
<th class="head">New state</th>
<th class="head">Signal out</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td rowspan="6">Idle</td>
<td rowspan="2">Command for EI</td>
<td>–&gt;</td>
<td>Busy/Empty</td>
<td>Busy/Empty</td>
</tr>
<tr class="row-odd"><td>(–&gt; [&amp;]_)</td>
<td>(Idle)</td>
<td>(Idle + completed)</td>
</tr>
<tr class="row-even"><td rowspan="2">Command for Q</td>
<td>–&gt;</td>
<td>Busy/Empty</td>
<td>Busy/Empty</td>
</tr>
<tr class="row-odd"><td>(–&gt; [&amp;]_)</td>
<td>(Idle)</td>
<td>(Idle + completed)</td>
</tr>
<tr class="row-even"><td>Done</td>
<td>–&gt;</td>
<td>N/A</td>
<td>N/A</td>
</tr>
<tr class="row-odd"><td>Interrupy</td>
<td>–&gt;</td>
<td>N/A</td>
<td>N/A</td>
</tr>
<tr class="row-even"><td rowspan="5">Busy/Empty</td>
<td rowspan="2">Command for EI</td>
<td>–&gt;</td>
<td>Busy/Empty</td>
<td>Busy/Empty + discarded</td>
</tr>
<tr class="row-odd"><td>(–&gt; [&amp;]_)</td>
<td>(Idle)</td>
<td>(Idle + discarded + completed)</td>
</tr>
<tr class="row-even"><td>Command for Q</td>
<td>–&gt;</td>
<td>Busy/Full</td>
<td>Busy/Full</td>
</tr>
<tr class="row-odd"><td>Done</td>
<td>–&gt;</td>
<td>Idle</td>
<td>Idle + comleted</td>
</tr>
<tr class="row-even"><td>Interrupy</td>
<td>–&gt;</td>
<td>Idle</td>
<td>Idle + discarded</td>
</tr>
<tr class="row-odd"><td rowspan="6">Busy/Full</td>
<td>Command for EI</td>
<td>–&gt;</td>
<td>Busy/Empty</td>
<td>Busy/Empty + discarded</td>
</tr>
<tr class="row-even"><td>&#160;</td>
<td>(–&gt; [&amp;]_)</td>
<td>(Idle)</td>
<td>(Idle + discarded + completed)</td>
</tr>
<tr class="row-odd"><td>Command for Q</td>
<td>&#160;</td>
<td>N/A</td>
<td>N/A [&amp;]_</td>
</tr>
<tr class="row-even"><td rowspan="2">Done</td>
<td>(–&gt; [&amp;]_)</td>
<td>Busy/Empty</td>
<td>Busy/Empty + completed</td>
</tr>
<tr class="row-odd"><td>–&gt;</td>
<td>(Idle)</td>
<td>(Idle + completed)</td>
</tr>
<tr class="row-even"><td>Interrupy</td>
<td>–&gt;</td>
<td>Idle</td>
<td>Idle + discarded</td>
</tr>
</tbody>
</table>
<p>The rows marked with parentheses is for if we decide to have “instantaneous” commands; there may be FW implementation reasons for doing this. TBD</p>
</div>
<div class="section" id="sdk-side-state-machine">
<h3>4.2. SDK-side state machine<a class="headerlink" href="#sdk-side-state-machine" title="Permalink to this headline">¶</a></h3>
<p>Given that the FW-side state machine behaves as described above (and that all output commands for a given port are sent with the “feedback desired” bit set), a corresponding SDK-side state machine can be constructed for tracking the buffer state and the fates of all sent commands:</p>
<table border="1" class="docutils">
<colgroup>
<col width="14%" />
<col width="26%" />
<col width="14%" />
<col width="13%" />
<col width="34%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Old state</th>
<th class="head">Feedback event</th>
<th class="head">–&gt;</th>
<th class="head">New state</th>
<th class="head">Conclusions</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td rowspan="2">Idle</td>
<td>Idle + completed</td>
<td>(–&gt;)</td>
<td>Idle</td>
<td>1 command completed</td>
</tr>
<tr class="row-odd"><td>Busy/Empty</td>
<td>–&gt;</td>
<td>Busy/Empty</td>
<td>(no change)</td>
</tr>
<tr class="row-even"><td rowspan="4">Busy/Empty</td>
<td>Idle + completed</td>
<td>–&gt;</td>
<td>Idle</td>
<td>1 command completed</td>
</tr>
<tr class="row-odd"><td>Idle + discarded</td>
<td>–&gt;</td>
<td>Idle</td>
<td>1 command discarded</td>
</tr>
<tr class="row-even"><td>Idle + discarded
+ completed</td>
<td>(–&gt;)</td>
<td>Idle</td>
<td>1 command discarded;
to-buffer command completed</td>
</tr>
<tr class="row-odd"><td>Busy/Empty + discarded</td>
<td>–&gt;</td>
<td>Busy/Empty</td>
<td>1 command discarded</td>
</tr>
<tr class="row-even"><td rowspan="5">Busy/Full</td>
<td>Idle + completed</td>
<td>(–&gt;)</td>
<td>Idle</td>
<td>2 commands completed</td>
</tr>
<tr class="row-odd"><td>Idle + discarded</td>
<td>–&gt;</td>
<td>Idle</td>
<td>2 commands discarded</td>
</tr>
<tr class="row-even"><td>Idle + discarded
+ completed</td>
<td>–&gt;</td>
<td>Idle</td>
<td>2 commands discarded;
to-buffer command completed</td>
</tr>
<tr class="row-odd"><td>Busy/Empty
+ completed</td>
<td>–&gt;</td>
<td>Busy/Empty</td>
<td>1 command discarded</td>
</tr>
<tr class="row-even"><td>Busy/Empty
+ discarded</td>
<td>–&gt;</td>
<td>Busy/Empty</td>
<td>2 commands discarded</td>
</tr>
</tbody>
</table>
</div>
</div>
<span id="document-5-Boot_loader"></span><div class="section" id="lego-bluetooth-hub-boot-loader-service">
<h2>5. LEGO Bluetooth Hub Boot Loader Service<a class="headerlink" href="#lego-bluetooth-hub-boot-loader-service" title="Permalink to this headline">¶</a></h2>
<div class="section" id="lego-hub-boot-loader-service">
<h3>5.1. LEGO Hub Boot Loader Service<a class="headerlink" href="#lego-hub-boot-loader-service" title="Permalink to this headline">¶</a></h3>
<p>The LEGO Bluetooth 3.X Hub Boot Loader Service contains the following service:</p>
<table border="1" class="docutils">
<colgroup>
<col width="40%" />
<col width="60%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Service</th>
<th class="head">UUID</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>LEGO Hub Boot Loader Service</td>
<td>0000<strong>1625</strong>-1212-EFDE-1623-785FEABCD123</td>
</tr>
</tbody>
</table>
<div class="section" id="lego-hub-boot-loader-characteristic">
<h4>5.1.1. LEGO Hub Boot Loader Characteristic<a class="headerlink" href="#lego-hub-boot-loader-characteristic" title="Permalink to this headline">¶</a></h4>
<p>Due to potential future limitations in future BLE chipsets, the LEGO Bluetooth 3.X Hub Boot Loader Service only contains one single characteristic:</p>
<table border="1" class="docutils">
<colgroup>
<col width="41%" />
<col width="59%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Characteristic</th>
<th class="head">UUID</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>LEGO Hub Boot Loader Characteristic</td>
<td>0000<strong>1626</strong>-1212-EFDE-1623-785FEABCD123</td>
</tr>
</tbody>
</table>
<table border="1" class="docutils">
<colgroup>
<col width="41%" />
<col width="59%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head" colspan="2">The &lt;1626&gt; LEGO Hub Boot Loader Characteristic Supported Properties</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><strong>Name</strong></td>
<td><strong>Description</strong></td>
</tr>
<tr class="row-odd"><td>Write with (without??) response</td>
<td>Allows the user app to update the functional F/W
of the HUB - NOT the Radio Stack F/W.</td>
</tr>
<tr class="row-even"><td>Notify</td>
<td>Allows the server to use the Handle Value
Notification ATT operation on this characteristic.</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="the-lego-hub-boot-loader-advertising-packet">
<h4>5.1.2. The LEGO Hub Boot Loader Advertising Packet<a class="headerlink" href="#the-lego-hub-boot-loader-advertising-packet" title="Permalink to this headline">¶</a></h4>
<table border="1" class="docutils">
<colgroup>
<col width="21%" />
<col width="51%" />
<col width="10%" />
<col width="8%" />
<col width="10%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head" colspan="5">Manufacturer Data in the Boot Loader Advertising packet</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><strong>Name</strong></td>
<td><strong>Description</strong></td>
<td><strong>Format</strong></td>
<td><strong>Min</strong></td>
<td><strong>Max</strong></td>
</tr>
<tr class="row-odd"><td>Length</td>
<td>Length of data</td>
<td>Unit8</td>
<td>0x09</td>
<td>0x09</td>
</tr>
<tr class="row-even"><td>Data Type</td>
<td>Manufacturer specific data to follow (0xFF)</td>
<td>Uint8</td>
<td>0xFF</td>
<td>0xFF</td>
</tr>
<tr class="row-odd"><td>Manufacturer ID</td>
<td>Manufacturer identifier (LEGO System A/S = 0x0397)</td>
<td>Uint16</td>
<td>0x0397</td>
<td>0x0397</td>
</tr>
<tr class="row-even"><td>Flash Loader Version</td>
<td>The Loader version is encoded as <a class="reference internal" href="index.html#ver-no"><span class="std std-ref">Version Number Encoding</span></a>.</td>
<td>Sint32</td>
<td>0</td>
<td>SINT32_MAX</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="index.html#sys-typ"><span class="std std-ref">System Type and Device Number</span></a></td>
<td>Identifies the system type of the Hub</td>
<td>Uint8</td>
<td>0x00</td>
<td>0xFF</td>
</tr>
<tr class="row-even"><td>Hub Kind</td>
<td>Identifies the kind of Hub - see <a class="reference internal" href="index.html#hub-knd"><span class="std std-ref">Device Capabilities (Hub Kind)</span></a> for
more information.</td>
<td>Uint8</td>
<td>0x01</td>
<td>0xFF</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="section" id="flash-loader-functions-0x01">
<h3>5.2. Flash Loader Functions [0x01]<a class="headerlink" href="#flash-loader-functions-0x01" title="Permalink to this headline">¶</a></h3>
<table border="1" class="docutils">
<colgroup>
<col width="27%" />
<col width="29%" />
<col width="15%" />
<col width="15%" />
<col width="15%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head" colspan="5">Message Type - Flash Loader Functions [0x01]</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><strong>Communication:</strong></td>
<td colspan="4">Downstream + Upstream.
Upstream uses notifications. Notifications on as DEFAULT.</td>
</tr>
<tr class="row-odd"><td rowspan="9"><strong>Size:</strong></td>
<td><strong>Sub Command</strong></td>
<td><strong>Cmd Token</strong></td>
<td><strong>Downstream</strong></td>
<td><strong>Upstream</strong></td>
</tr>
<tr class="row-even"><td>Erase Flash</td>
<td>0x11</td>
<td>1</td>
<td>2</td>
</tr>
<tr class="row-odd"><td>Program Flash</td>
<td>0x22</td>
<td>5 + bytes to
program</td>
<td>&#160;</td>
</tr>
<tr class="row-even"><td>Start APP</td>
<td>0x33</td>
<td>4</td>
<td>N/A</td>
</tr>
<tr class="row-odd"><td>Initiate Loader</td>
<td>0x44</td>
<td>8</td>
<td>5</td>
</tr>
<tr class="row-even"><td>Get Info</td>
<td>0x55</td>
<td>4</td>
<td>17</td>
</tr>
<tr class="row-odd"><td>Get Checksum</td>
<td>0x66</td>
<td>4</td>
<td>5</td>
</tr>
<tr class="row-even"><td>Get FLASH State</td>
<td>0x77</td>
<td>4</td>
<td>5</td>
</tr>
<tr class="row-odd"><td>Disconnect Device</td>
<td>0x88</td>
<td>4</td>
<td>&#160;</td>
</tr>
<tr class="row-even"><td rowspan="8"><strong>Description:</strong></td>
<td>Erase Flash</td>
<td colspan="3">The Flash Loader normally should start erase
the FLASH. This command needs NO further
parameters - the H/W size etc. are known by
the Flash Loader F/W.</td>
</tr>
<tr class="row-odd"><td>Program Flash</td>
<td colspan="3">Programs n-bytes [Uint8] at address
0xaaaa aaaa [Uint32].</td>
</tr>
<tr class="row-even"><td>Start APP</td>
<td colspan="3">As it says :-)</td>
</tr>
<tr class="row-odd"><td>Initiate Loader</td>
<td colspan="3">Telling the Flash Loader F/W, how many bytes
in image. Implicite the command also clears
the CheckSum.</td>
</tr>
<tr class="row-even"><td>Get Info</td>
<td colspan="3">By using Get Info, the user can decide Total
Length of Flash, Flash Loader F/W version
and the H/W Reference ID.</td>
</tr>
<tr class="row-odd"><td>Get Checksum</td>
<td colspan="3">Returns the CheckSum - also on the fly.</td>
</tr>
<tr class="row-even"><td>Get FLASH State</td>
<td colspan="3">Get the Protection Level of the FLASH.</td>
</tr>
<tr class="row-odd"><td>Disconnect Device</td>
<td colspan="3">Command used for disconnection the device.
When disconnected, the device starts
advertising. If NO (re-)connection done
before end of the advertising period, the
device will shut down.</td>
</tr>
</tbody>
</table>
<div class="section" id="flash-loader-functions-message-format">
<h4>5.2.1. Flash Loader Functions Message Format<a class="headerlink" href="#flash-loader-functions-message-format" title="Permalink to this headline">¶</a></h4>
<table border="1" class="docutils">
<colgroup>
<col width="17%" />
<col width="34%" />
<col width="20%" />
<col width="17%" />
<col width="13%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head" colspan="5">Flash Loader Functions Message Format</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><strong>Name</strong></td>
<td><strong>Description</strong></td>
<td><strong>Format</strong></td>
<td><strong>Min</strong></td>
<td><strong>Max</strong></td>
</tr>
<tr class="row-odd"><td>Sub Commands</td>
<td><table border="1" class="first last docutils">
<colgroup>
<col width="17%" />
<col width="83%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>0x11</td>
<td>Erase Flash</td>
</tr>
<tr class="row-even"><td>0x22</td>
<td>Program Flash</td>
</tr>
<tr class="row-odd"><td>0x33</td>
<td>Start APP</td>
</tr>
<tr class="row-even"><td>0x44</td>
<td>Initiate Loader</td>
</tr>
<tr class="row-odd"><td>0x55</td>
<td>Get Info</td>
</tr>
<tr class="row-even"><td>0x66</td>
<td>Get CheckSum</td>
</tr>
<tr class="row-odd"><td>0x77</td>
<td>Get FLASH State</td>
</tr>
<tr class="row-even"><td>0x88</td>
<td>Disconnect Device</td>
</tr>
</tbody>
</table>
</td>
<td>UInt8</td>
<td>0x11</td>
<td>0x88</td>
</tr>
<tr class="row-odd"><td colspan="5"><strong>Return type and size If Sub Command == 0x11 “Erase Flash”</strong></td>
</tr>
<tr class="row-even"><td>Return value</td>
<td><table border="1" class="first last docutils">
<colgroup>
<col width="86%" />
<col width="14%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>Cmd OK - FLASH erased:</td>
<td>0x00</td>
</tr>
<tr class="row-even"><td>Error:</td>
<td>0xFF</td>
</tr>
</tbody>
</table>
</td>
<td>UInt8</td>
<td>0x00</td>
<td>0xFF</td>
</tr>
<tr class="row-odd"><td colspan="5"><strong>Return type and size If Sub Command == 0x22 “Program Flash”</strong></td>
</tr>
<tr class="row-even"><td>Returned
values</td>
<td><p class="first">CheckSum:</p>
<p class="last">ByteCounts:</p>
</td>
<td><p class="first">Uint8</p>
<p class="last">Uint32</p>
</td>
<td><p class="first">N/A</p>
<p class="last">0x01</p>
</td>
<td><p class="first">N/A</p>
<p class="last">N/A</p>
</td>
</tr>
<tr class="row-odd"><td colspan="5"><strong>Return type and size If Sub Command == 0x33 “Start App”</strong></td>
</tr>
<tr class="row-even"><td>Return value</td>
<td>NO RETURN VALUE - booting</td>
<td><ul class="first last simple">
<li></li>
</ul>
</td>
<td><ul class="first last simple">
<li></li>
</ul>
</td>
<td><ul class="first last simple">
<li></li>
</ul>
</td>
</tr>
<tr class="row-odd"><td colspan="5"><strong>Return type and size If Sub Command == 0x44 “Initiate Loader”</strong></td>
</tr>
<tr class="row-even"><td>Return value</td>
<td><table border="1" class="first docutils">
<colgroup>
<col width="83%" />
<col width="17%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>Cmd OK - Init Success</td>
<td>0x00</td>
</tr>
<tr class="row-even"><td>Error - Byte count out
of range:</td>
<td>0xFF</td>
</tr>
</tbody>
</table>
<p class="last">Checksum implicit reset.</p>
</td>
<td>Uint8</td>
<td>0x00</td>
<td>0xFF</td>
</tr>
<tr class="row-odd"><td colspan="5"><strong>Return type and size If Sub Command == 0x55 “Get Info”</strong></td>
</tr>
<tr class="row-even"><td rowspan="4">Return value</td>
<td>Flash Loader Version: <a class="reference internal" href="index.html#ver-no"><span class="std std-ref">Version Number Encoding</span></a></td>
<td>SInt32</td>
<td>N/A</td>
<td>N/A</td>
</tr>
<tr class="row-odd"><td>Flash Start Address (LSB):</td>
<td>UInt32</td>
<td>N/A</td>
<td>N/A</td>
</tr>
<tr class="row-even"><td>Flash End Address (MSB):</td>
<td>UInt32</td>
<td>N/A</td>
<td>N/A</td>
</tr>
<tr class="row-odd"><td>The System Type ID for this H/W:</td>
<td>UInt8</td>
<td>N/A</td>
<td>N/A</td>
</tr>
<tr class="row-even"><td colspan="5"><strong>Return type and size If Sub Command == 0x66 “Get CheckSum”</strong></td>
</tr>
<tr class="row-odd"><td>Return value</td>
<td><p class="first">Checksum:</p>
<p class="last">See <a class="reference internal" href="index.html#chk-sum"><span class="std std-ref">Checksum Calculation</span></a></p>
</td>
<td>UInt8</td>
<td>N/A</td>
<td>N/A</td>
</tr>
<tr class="row-even"><td colspan="5"><strong>Return type and size If Sub Command == 0x77 “Get FLASH State”</strong></td>
</tr>
<tr class="row-odd"><td>Return value</td>
<td><p class="first">FLASH State
Protection Level:</p>
<table border="1" class="last docutils">
<colgroup>
<col width="14%" />
<col width="86%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>00</td>
<td>No Protection</td>
</tr>
<tr class="row-even"><td>01</td>
<td>Level 1 protection</td>
</tr>
<tr class="row-odd"><td>02</td>
<td>Level 2 protection</td>
</tr>
</tbody>
</table>
</td>
<td>Uint8</td>
<td>N/A</td>
<td>N/A</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="section" id="flash-loader-error-messages-0x05">
<h3>5.3. Flash Loader Error Messages [0x05]<a class="headerlink" href="#flash-loader-error-messages-0x05" title="Permalink to this headline">¶</a></h3>
<table border="1" class="docutils">
<colgroup>
<col width="26%" />
<col width="74%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head" colspan="2">Message Type - Flash Loader Error Messages [0x05]</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><strong>Communication:</strong></td>
<td>Upstream.</td>
</tr>
<tr class="row-odd"><td><strong>Size:</strong></td>
<td>5 Bytes</td>
</tr>
<tr class="row-even"><td><strong>Description:</strong></td>
<td>Generic Flash Loader Error message. Error type and number - see below.
Errors includes the command ID which introduces the error.</td>
</tr>
</tbody>
</table>
<div class="section" id="flash-loader-error-message-format">
<h4>5.3.1. Flash Loader Error Message Format<a class="headerlink" href="#flash-loader-error-message-format" title="Permalink to this headline">¶</a></h4>
<table border="1" class="docutils">
<colgroup>
<col width="14%" />
<col width="62%" />
<col width="10%" />
<col width="7%" />
<col width="7%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head" colspan="5">Flash Loader Error Message Format</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><strong>Name</strong></td>
<td><strong>Description</strong></td>
<td><strong>Format</strong></td>
<td><strong>Min</strong></td>
<td><strong>Max</strong></td>
</tr>
<tr class="row-odd"><td>Common Header</td>
<td>See <a class="reference internal" href="index.html#common-header-description"><span class="std std-ref">Common Message Header</span></a></td>
<td>N/A</td>
<td>N/A</td>
<td>N/A</td>
</tr>
<tr class="row-even"><td>Message Type</td>
<td>Command (Message Type) see the definitions in this document.</td>
<td>Uint8</td>
<td>0x01</td>
<td>0xFF</td>
</tr>
<tr class="row-odd"><td>Error Type</td>
<td>0x05 = Command NOT recognized (The ONLY
Error type implemented in FLASH Loader)</td>
<td>Uint8</td>
<td>0x05</td>
<td>0x05</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<span id="document-6-Appendix"></span><div class="section" id="appendix">
<h2>6. Appendix<a class="headerlink" href="#appendix" title="Permalink to this headline">¶</a></h2>
<div class="section" id="encoding-of-writedirectmodedata-0x81-0x51">
<span id="enc-wdm"></span><h3>6.1. Encoding of WriteDirectModeData [0x81, 0x51]<a class="headerlink" href="#encoding-of-writedirectmodedata-0x81-0x51" title="Permalink to this headline">¶</a></h3>
<p>Commands needed for a certain mode setup are encoded using the Output Command 0x81 Sub Command 0x51 “WriteDirectModeData”.</p>
<p>These commands are shown and encoded as shown in the example below:</p>
<table border="1" class="docutils">
<colgroup>
<col width="30%" />
<col width="6%" />
<col width="32%" />
<col width="32%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head" colspan="4">Output Command 0x81 - TILT Sub Command</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><strong>Sub Command</strong></td>
<td><strong>Value</strong></td>
<td><strong>Parameter Description</strong></td>
<td><strong>Description</strong></td>
</tr>
<tr class="row-odd"><td>TiltImpactPreset(PresetValue)</td>
<td>N/A</td>
<td>PresetValue: [Int32]
PresetValue [0..MAX_INT32]</td>
<td><p class="first">(P)Resets the Mode 3 ImpactCounts.</p>
<p class="last">Encoded through <a class="reference internal" href="index.html#wr-dmd"><span class="std std-ref">WriteDirectModeData</span></a></p>
</td>
</tr>
<tr class="row-even"><td>TiltConfigOrientation(Orientation)</td>
<td>N/A</td>
<td><p class="first">Orientation: [Int8]
Orientation [0-6]</p>
<table border="1" class="last docutils">
<colgroup>
<col width="5%" />
<col width="95%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>0</td>
<td>Bottom (Default/Normal)</td>
</tr>
<tr class="row-even"><td>1</td>
<td>Front</td>
</tr>
<tr class="row-odd"><td>2</td>
<td>Back</td>
</tr>
<tr class="row-even"><td>3</td>
<td>Left</td>
</tr>
<tr class="row-odd"><td>4</td>
<td>Right</td>
</tr>
<tr class="row-even"><td>5</td>
<td>Top</td>
</tr>
<tr class="row-odd"><td>6</td>
<td>Use actual as “Bottom reference”</td>
</tr>
</tbody>
</table>
</td>
<td><p class="first">Set the default bottom side
(orientation) - mode 5.</p>
<p class="last">Encoded through <a class="reference internal" href="index.html#wr-dmd"><span class="std std-ref">WriteDirectModeData</span></a></p>
</td>
</tr>
<tr class="row-even"><td>TiltConfigImpact(ImpactThreshold
, BumpHoldoff)</td>
<td>N/A</td>
<td><p class="first">ImpactThreshold: [Int8]
ImpactThreshold [0-127]</p>
<p class="last">BumpHoldoff: [Int8]
1..127] 10th of ms</p>
</td>
<td><p class="first">Sets the Impact size for a BUMP - mode 6.</p>
<p>Sets the minimum Holdoff time between
individual impacts (Bumps).</p>
<p>The HoldOff can be set between 10 ms.
and 1.27 Sec.</p>
<p class="last">Encoded through <a class="reference internal" href="index.html#wr-dmd"><span class="std std-ref">WriteDirectModeData</span></a></p>
</td>
</tr>
</tbody>
</table>
<p><strong>The prolog part of the command decoration is:</strong></p>
<ul class="simple">
<li>Common Header (See description at <a class="reference internal" href="index.html#common-header-description"><span class="std std-ref">Common Message Header</span></a>).</li>
<li>Startup and Completion information (See description at <a class="reference internal" href="index.html#st-comp"><span class="std std-ref">Startup and Completion Information</span></a>)</li>
<li>WriteDirectModeData (0x51)</li>
<li>Mode</li>
<li>The rest of the message is the Mode specific payload.</li>
</ul>
<p>E.g.</p>
<p>Set RGB LED into RGB mode (0x01) and set the R = 0x30, G = 0x47, B = 0x55:</p>
<p>Port ID, <a class="reference internal" href="index.html#st-comp"><span class="std std-ref">Startup and Completion Information</span></a> , 0x51, 0x01, 0x30, 0x47, 0x55</p>
<table border="1" class="docutils">
<colgroup>
<col width="34%" />
<col width="31%" />
<col width="35%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head" colspan="3">(P)RESET ENCODER Command encoded as WriteDirectModeData (Cmd 0x81, Sub Cmd 0x51)</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><strong>WriteModeData Commands</strong></td>
<td><strong>Encoding</strong></td>
<td><strong>Description</strong></td>
</tr>
<tr class="row-odd"><td><p class="first">PresetEncoder(Value)</p>
<p class="last">Mode 2</p>
</td>
<td><p class="first">Port ID, <a class="reference internal" href="index.html#st-comp"><span class="std std-ref">Startup and Completion Information</span></a>,
0x51, 0x02, val0, val1, val2, val3</p>
<p class="last"><strong>REMEMBER:</strong> val0-val3 parts of int 32</p>
</td>
<td>Write direct to Position property in sensor.
I.e. a value of 0 (zero) equals reset.</td>
</tr>
</tbody>
</table>
<div class="line-block">
<div class="line"><br /></div>
</div>
<table border="1" class="docutils">
<colgroup>
<col width="34%" />
<col width="31%" />
<col width="35%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head" colspan="3">MOTOR/OUTPUT Commands encoded as WriteDirectModeData (Cmd 0x81, Sub Cmd 0x51)</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><strong>WriteModeData Commands</strong></td>
<td><strong>Encoding</strong></td>
<td><strong>Description</strong></td>
</tr>
<tr class="row-odd"><td><p class="first">StartPower (Power)</p>
<p class="last">Mode 0</p>
</td>
<td>Port ID, <a class="reference internal" href="index.html#st-comp"><span class="std std-ref">Startup and Completion Information</span></a>,
0x51, 0x00, Power</td>
<td>Set port into adjustable PWM output using the param
Power. No Speed regulation applied.</td>
</tr>
</tbody>
</table>
<table border="1" class="docutils">
<colgroup>
<col width="34%" />
<col width="31%" />
<col width="35%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head" colspan="3">RGB Commands encoded as WriteDirectModeData (Cmd 0x81, Sub Cmd 0x51)</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><strong>WriteModeData Commands</strong></td>
<td><strong>Encoding</strong></td>
<td><strong>Description</strong></td>
</tr>
<tr class="row-odd"><td><p class="first">SetRgbColorNo(ColorNo)</p>
<p class="last">Mode 0</p>
</td>
<td>Port ID, <a class="reference internal" href="index.html#st-comp"><span class="std std-ref">Startup and Completion Information</span></a>,
0x51, 0x00, ColorNo</td>
<td>Set the RGB LED to ColorNo or presets the
ColorNo for later mode (0x00).</td>
</tr>
<tr class="row-even"><td><p class="first">SetRgbColors(RedColor,
GreenColor, BlueColor)</p>
<p class="last">Mode 0</p>
</td>
<td>Port ID, <a class="reference internal" href="index.html#st-comp"><span class="std std-ref">Startup and Completion Information</span></a>,
0x51, 0x00, 0x51, 0x01, R, G, B</td>
<td>Set the RGB LED to Colors for instant Colors
(if RGB already in mode 1) <sup>[M]</sup> .</td>
</tr>
</tbody>
</table>
<p><sup>[M]</sup>  Remark! Some sensors can be preset in a mode different from the actual used but this behavior depends of the sensors, the modes and
the internal properties. E.g. the RGB uses RGB settings in mode 1, but also uses the internal properties in making the numbered colors in mode 0.
If e.g. a RGB sensor is in mode 0 and color 5 show, and a WriteDirectModeData is used to set RGB values to 00,33,00 (direct to mode 1). Then a later
switching to mode 1 will NOT set the 00,33,00, but show a turned off RGB. Remember the internal properties is used in both modes. Some sensor can be
preset/reset in mode different from actual, but the user has to check the information and behavior for the specific sensor.</p>
<table border="1" class="docutils">
<colgroup>
<col width="34%" />
<col width="31%" />
<col width="35%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head" colspan="3">TILT Commands encoded as WriteDirectModeData (Cmd 0x81, Sub Cmd 0x51)</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><strong>WriteModeData Commands</strong></td>
<td><strong>Encoding</strong></td>
<td><strong>Description</strong></td>
</tr>
<tr class="row-odd"><td><p class="first">TiltImpactPreset(PresetValue)</p>
<p class="last">Mode 3</p>
</td>
<td>Port ID, <a class="reference internal" href="index.html#st-comp"><span class="std std-ref">Startup and Completion Information</span></a>,
0x51, 0x03, PresetValue</td>
<td>Set the Tilt into TiltImpactCount mode (0x03)
and change (preset) the value to PresetValue.</td>
</tr>
<tr class="row-even"><td><p class="first">SetRgbColors(RedColor,
GreenColor, BlueColor)</p>
<p class="last">Mode 5</p>
</td>
<td>Port ID, <a class="reference internal" href="index.html#st-comp"><span class="std std-ref">Startup and Completion Information</span></a>,
0x51, 0x05, Orientation</td>
<td>Set the Tilt into TiltOrientation mode (0x05)
and set the Orientation value to Orientation</td>
</tr>
<tr class="row-odd"><td><p class="first">TiltConfigImpact(ImpactThreshold, BumpHoldOff)</p>
<p class="last">Mode 6</p>
</td>
<td>Port ID, <a class="reference internal" href="index.html#st-comp"><span class="std std-ref">Startup and Completion Information</span></a>,
0x51, 0x06, ImpactThreshold, BumpHoldoff</td>
<td>Setup Tilt ImpactThreshold and BumpHoldoff by
entering mode 6 and use the payload
ImpactThreshold and BumpHoldoff.</td>
</tr>
<tr class="row-even"><td><p class="first">TiltFactoryCalibration(Orientation,
CalibrationPassCode)</p>
<p class="last">Mode 7</p>
</td>
<td>Port ID, <a class="reference internal" href="index.html#st-comp"><span class="std std-ref">Startup and Completion Information</span></a>,
0x51, 0x07, Orientation, ‘C’, ‘a’, ‘l’, ‘i’,
‘b’, ‘-‘, ‘S’, ‘e’, ‘n’, ‘s’, ‘o’, ‘r’,</td>
<td><p class="first">Sets the actual orientation in the montage automat.</p>
<table border="1" class="last docutils">
<colgroup>
<col width="23%" />
<col width="77%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>0</td>
<td>XY (laying flat)</td>
</tr>
<tr class="row-even"><td>1</td>
<td>Z Standing (long direction)</td>
</tr>
<tr class="row-odd"><td>PassCode</td>
<td>“Calib Sensor”</td>
</tr>
</tbody>
</table>
</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="encoding-of-writedirect-0x81-0x50">
<h3>6.2. Encoding of WriteDirect [0x81, 0x50]<a class="headerlink" href="#encoding-of-writedirect-0x81-0x50" title="Permalink to this headline">¶</a></h3>
<p>To gain direct access to H/W components the user can use the WriteDirect Command. The command is a sort of feed through.
So for sending communication out to a LPF2 wired device, the user has to add some decoration (CheckSum etc.) to the command packet.</p>
<p>These commands are shown and marked in the main document as shown in the example below:</p>
<table border="1" class="docutils">
<colgroup>
<col width="25%" />
<col width="16%" />
<col width="30%" />
<col width="29%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head" colspan="4">Output Command 0x81 - HARDWARE RESET Sub Command</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><strong>Sub Command</strong></td>
<td><strong>Value</strong></td>
<td><strong>Parameter Description</strong></td>
<td><strong>Description</strong></td>
</tr>
<tr class="row-odd"><td>GenericZeroSetHardware()</td>
<td>N/A</td>
<td>Resets or zerosets the H/W
component attached to the Port ID</td>
<td><p class="first">Transmits the universal 0x11
token to the addressed H/W.</p>
<p class="last"><code class="docutils literal"><span class="pre">Encoded</span> <span class="pre">through</span> <span class="pre">WriteDirect</span></code></p>
</td>
</tr>
</tbody>
</table>
<div class="section" id="encoding-of-the-prolog-part-of-the-command-decoration-is">
<h4>6.2.1. Encoding of the prolog part of the command decoration is:<a class="headerlink" href="#encoding-of-the-prolog-part-of-the-command-decoration-is" title="Permalink to this headline">¶</a></h4>
<ul class="simple">
<li>Common Header (See <a class="reference internal" href="index.html#common-header-description"><span class="std std-ref">Common Message Header</span></a>).</li>
<li>Startup and Completion information (See description at <a class="reference internal" href="index.html#st-comp"><span class="std std-ref">Startup and Completion Information</span></a>)</li>
<li>WriteDirect (0x50)</li>
<li>The rest of the message is the Command specific payload.</li>
<li>Checksum - See <a class="reference internal" href="index.html#chk-sum"><span class="std std-ref">Checksum Calculation</span></a></li>
</ul>
<table border="1" class="docutils">
<colgroup>
<col width="34%" />
<col width="31%" />
<col width="35%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head" colspan="3"><strong>GENERIC RESET/ZEROSET Command encoded as DirectWrite (Cmd 0x81, Sub Cmd 0x50)</strong></th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><strong>WriteDirect Commands</strong></td>
<td><strong>Encoding</strong></td>
<td><strong>Description</strong></td>
</tr>
<tr class="row-odd"><td><strong>GenericZeroSetHardware()</strong></td>
<td>Port ID, Startup and Completion information,
0x50, 0xD4, 0x11, 0x3A</td>
<td>Send a Reset/zeroset to the device connected to
the port specified by the Port ID</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="write-direct-example-zeroset-the-sensor-attached-to-port-id">
<h4>6.2.2. Write Direct Example - Zeroset the “sensor” attached to [Port ID]:<a class="headerlink" href="#write-direct-example-zeroset-the-sensor-attached-to-port-id" title="Permalink to this headline">¶</a></h4>
<p>Zeroset the “sensor” attached to [Port ID]</p>
<p>Port ID, Startup and Completion information, 0x50, 0xD4, RESET, 0x3A</p>
<table border="1" class="docutils">
<colgroup>
<col width="34%" />
<col width="31%" />
<col width="35%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head" colspan="3"><strong>TiltFactoryCalibration Encoded through DirectWrite (Cmd 0x81, Sub Cmd 0x50)</strong></th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><strong>WriteDirect Commands</strong></td>
<td><strong>Encoding</strong></td>
<td><strong>Description</strong></td>
</tr>
<tr class="row-odd"><td><strong>TiltFactoryCalibration(Orientation, PassCode)</strong></td>
<td>0x3A, Startup and Completion information,
0x50, 0xD4, Orientation, “PassCode”, CheckSum</td>
<td>Send calibration command to the Tilt Sensor device
connected at the port specified by the Port ID</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="write-direct-example-calibrate-sensor-attached-to-port-id">
<h4>6.2.3. Write Direct Example - Calibrate Sensor attached to [Port ID]:<a class="headerlink" href="#write-direct-example-calibrate-sensor-attached-to-port-id" title="Permalink to this headline">¶</a></h4>
<p>Calibrate sensor attached to [Port ID]</p>
<p>PassCode = “Calib-Sensor”
Orientation: = Z (2)</p>
<p>0x3A, Startup and Completion information, 0x50, 0xD4, 0x02,
0x43, 0x61, 0x6C, 0x69, 0x62, 0x2D, 0x53, 0x65, 0x6E, 0x73, 0x6F, 0x72, 0x77</p>
</div>
</div>
<div class="section" id="sequence-diagrams">
<h3>6.3. Sequence Diagrams<a class="headerlink" href="#sequence-diagrams" title="Permalink to this headline">¶</a></h3>
<div class="section" id="connection-info">
<h4>6.3.1. Connection Info<a class="headerlink" href="#connection-info" title="Permalink to this headline">¶</a></h4>
<img alt="_images/5.3.1.png" src="_images/5.3.1.png" />
</div>
<div class="section" id="combined-mode">
<h4>6.3.2. Combined Mode<a class="headerlink" href="#combined-mode" title="Permalink to this headline">¶</a></h4>
<img alt="_images/5.3.2.png" src="_images/5.3.2.png" />
</div>
<div class="section" id="port-synchronization">
<h4>6.3.3. Port Synchronization<a class="headerlink" href="#port-synchronization" title="Permalink to this headline">¶</a></h4>
<img alt="_images/5.4.png" src="_images/5.4.png" />
</div>
</div>
</div>
</div>
</div>


           </div>
           <div class="articleComments">
            
           </div>
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2018, LEGO Systems A/S.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'Doc v3.0.00 r17',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="_static/jquery.js"></script>
      <script type="text/javascript" src="_static/underscore.js"></script>
      <script type="text/javascript" src="_static/doctools.js"></script>

  

  
  
    <script type="text/javascript" src="_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>
